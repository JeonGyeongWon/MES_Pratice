<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="report">
    
    <parameterMap class="java.util.Map" id="procStockAmountParams">
        <parameter property="ORGID" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="COMPANYID" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="SEARCHMONTH" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="REGISTID" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="RETURNSTATUS" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
        <parameter property="MSGDATA" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>
    </parameterMap>
    
    <procedure id="report.prod.stock.amount.create.proc.call.Procedure" parameterClass="java.util.Map"  parameterMap="procStockAmountParams" resultClass="java.util.HashMap" >
    <![CDATA[
       {call CB_MFG_PKG.CB_STOCK_AMOUNT_CREATE ( ?, ?, ?, ?, ?, ? ) }
       ]]>
    </procedure>
    
    <select id="report.work.result.item.lot.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
        SELECT WV.ORG_ID AS ORGID
                  ,WV.ORG_NAME AS ORGNAME
						      ,WV.COMPANY_ID AS COMPANYID
						      ,WV.WORK_ORDER_ID AS WORKORDERID
						      ,WV.WORK_ORDER_SEQ AS WORKORDERSEQ
						      ,WV.SEQ_NO AS SEQNO
						      ,WV.LOT_NO AS LOTNO
						      ,WV.EQUIPMENT_CODE AS EQUIPMENTCODE
						      ,WV.EQUIPMENT_NAME AS EQUIPMENTNAME
						      ,WV.ITEM_CODE AS ITEMCODE
						      ,WV.ITEM_NAME AS ITEMNAME
						      ,WV.QTY AS QTY
						      ,WV.PRINT_DATE AS PRINTDATE
			  FROM CB_WO_LOT_REPORT_V WV
			 WHERE 1 = 1
			   AND WV.ORG_ID = $ORGID$
			   AND WV.COMPANY_ID = $COMPANYID$
			   AND WV.WORK_ORDER_ID = #WORKORDERID#
			   AND WV.WORK_ORDER_SEQ = $WORKORDERSEQ$
			   AND WV.SEQ_NO = $SEQNO$
      ORDER BY WV.SEQ_NO
    </select>

    <select id="report.dist.lot.mat.lot.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    <![CDATA[
        SELECT A.ITEMTYPE
	              ,DECODE(A.ITEMTYPE
	                     ,'01', '사출품'
	                     ,A.ITEMTYPENAME) AS ITEMTYPENAME
	              ,A.ITEMCODE
	              ,A.ITEMNAME
	              ,A.ORDERNAME
	              ,A.MODEL
	              ,A.MODELNAME
	              ,A.CUSTOMERGUBUN
	              ,A.CUSTOMERGUBUNNAME
	              ,B.CUSTOMERCODE AS CUSTOMERCODE
	              ,B.CUSTOMERNAME AS CUSTOMERNAME
	              ,B.TRANSNO AS TRANSNO
	              ,B.TRANSSEQ AS TRANSSEQ
	              ,B.TRANSNO || '-' || B.TRANSSEQ AS BOXNUMBER
	              ,B.TRANSNO || '-' || B.TRANSSEQ || '/' || #SEQ#
	               AS TRANSNUMBER
	              ,B.TRANSDATE AS TRANSDATE
	              ,A.LOTQTY AS LOTQTY
	              /* ,A.INPUTQTY AS INPUTQTY */
	              ,DECODE (A.LOTCNT
	                      ,#SEQ#
	                      ,(A.LOTQTY - (A.INPUTQTY * (A.LOTCNT - 1)))
	                      ,A.INPUTQTY) AS INPUTQTY
	              ,A.LOTNO AS LOTNO
	              ,B.CHECKYN AS CHECKYN
	              ,B.WAREHOUSING AS WAREHOUSING
	              ,B.WAREHOUSINGNAME AS WAREHOUSINGNAME
         FROM CB_TRANS_LOT_H_V A
                ,CB_TRANS_LOT_D_V B
        WHERE 1=1
	         AND A.ORGID = B.ORGID
	         AND A.COMPANYID = B.COMPANYID
	         AND A.LOTNO = B.LOTNO
	         AND A.LOTNO = #LOTNO#
    ]]>
    </select>

    <select id="report.order.ship.lot.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
        SELECT ORG_ID AS ORGID
                ,ORG_NAME AS ORGNAME
					      ,COMPANY_ID AS COMPANYID
					      ,SHIP_NO AS SHIPNO
					      ,SHIP_SEQ AS SHIPSEQ
					      ,SHIP_DATE AS SHIPDATE
					      ,ITEM_CODE AS ITEMCODE
					      ,MODEL_NAME AS MODELNAME
					      ,ORDER_NAME AS ORDERNAME
					      ,ITEM_NAME AS ITEMNAME
					      ,CUSTOMER_NAME AS CUSTOMERNAME
					      ,LOT_NO AS LOTNO
					      ,LOT_CNT AS LOTCNT
					      ,SHIP_QTY AS SHIPQTY
					      ,KR_NAME AS KRNAME
					      ,WORKER_NAME AS WORKERNAME
					      ,WORK_ORDER_DATE AS WORKORDERDATE
					      ,'출고일:' || SHIP_DATE || CHR(13) ||
					       '기종:' || MODEL_NAME || CHR(13) ||
					       '품명:' || ITEM_NAME || CHR(13) ||
					       '납품처:' || CUSTOMER_NAME || CHR(13) ||
					       'LOTNO:' || CUSTOMER_LOT || '(' || SHIP_NO || '-' || SHIP_SEQ || ')' || CHR(13) ||
					       '수량:' || SHIP_QTY || CHR(13) ||
					       '검사자:' || KR_NAME || CHR(13) ||
					       '작업자:' || WORKER_NAME || CHR(13) ||
					       '작업일:' || WORK_ORDER_DATE AS BARCODEINFO
			  FROM CB_SHIPPING_LOT_REPORT_V
			 WHERE 1=1
			   AND ORG_ID = #ORGID#
			   AND COMPANY_ID = #COMPANYID#
			   AND SHIP_NO = #SHIPNO#
			   AND SHIP_SEQ = $SHIPSEQ$
    </select>

    
    <select id="report.scm.outprocess.lot.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT LH.ITEMTYPE AS ITEMTYPE
            ,LH.ITEMTYPENAME AS ITEMTYPENAME
            ,LH.ITEMCODE AS ITEMCODE
            ,LH.ITEMNAME AS ITEMNAME
            ,LH.ORDERNAME AS ORDERNAME
            ,LH.CUSTOMERCODE AS CUSTOMERCODE
            ,(SELECT CC.CUSTOMER_NAME
                FROM CB_CUSTOMER CC
               WHERE 1=1
                 AND CC.ORG_ID = LH.ORGID
                 AND CC.COMPANY_ID = LH.COMPANYID
                 AND CC.CUSTOMER_CODE = LH.CUSTOMERCODE) AS CUSTOMERNAME
            ,TD.OUT_TRANS_NO AS OUTTRANSNO
            ,TD.OUT_TRANS_SEQ AS OUTTRANSSEQ
            ,TD.OUT_TRANS_NO || '-' || TD.OUT_TRANS_SEQ AS BOXNUMBER
            ,TD.OUT_TRANS_NO || '-' || TD.OUT_TRANS_SEQ || '/' || #SEQ# AS OUTTRANSNUMBER
            ,TO_CHAR(TH.OUT_TRANS_DATE, 'YYYY-MM-DD') AS OUTTRANSDATE
            ,LH.LOTQTY AS LOTQTY
            ,DECODE (LH.LOTCNT, #SEQ#, (LH.LOTQTY - (LH.INPUTQTY * (LH.LOTCNT - 1))),LH.INPUTQTY) AS INPUTQTY
            ,LD.LOT_NO AS LOTNO
            ,NVL((SELECT DECODE(IH.CHECK_YN
                               ,'OK', '합격'
                               ,'NG', '불합격'
                               ,'미등록')
                    FROM CB_SCM_INSPECTION_H IH
                   WHERE 1=1
                     AND IH.ORG_ID = LD.ORG_ID
                     AND IH.COMPANY_ID = LD.COMPANY_ID
                     AND IH.ORDER_NO = LD.ORDER_NO
                     AND IH.ORDER_SEQ = LD.ORDER_SEQ), '합격') AS CHECKYN
            ,(SELECT WV.ROUTINGNAME
                FROM CB_OUT_ORDER_D OD
                    ,CB_WORK_ORDER_LIST_V WV
               WHERE 1=1
                 AND OD.ORG_ID = TD.ORG_ID
                 AND OD.COMPANY_ID = TD.COMPANY_ID
                 AND OD.OUT_PO_NO = TD.OUT_PO_NO
                 AND OD.OUT_PO_SEQ = TD.OUT_PO_SEQ
                 AND WV.ORGID = OD.ORG_ID
                 AND WV.COMPANYID = OD.COMPANY_ID
                 AND WV.WORKORDERID = OD.WORK_ORDER_ID
                 AND WV.WORKORDERSEQ = OD.WORK_ORDER_SEQ) AS ROUTINGNAME
        FROM CB_TRANS_LOT_H_V LH
            ,CB_TRANS_LOT_D LD
            ,CB_OUT_TRANS_D TD
            ,CB_OUT_TRANS_H TH
            ,CB_OUT_ORDER_D OD
            ,CB_WORK_ORDER WO
            ,CB_ROUTING_CONTROL RC
       WHERE 1=1
         AND LH.ORGID = LD.ORG_ID
         AND LH.COMPANYID = LD.COMPANY_ID
         AND LH.LOTNO = LD.LOT_NO
         AND LD.ORG_ID = TD.ORG_ID
         AND LD.COMPANY_ID = TD.COMPANY_ID
         AND LD.OUT_TRANS_NO = TD.OUT_TRANS_NO
         AND LD.OUT_TRANS_SEQ = TD.OUT_TRANS_SEQ
         AND TD.ORG_ID = TH.ORG_ID
         AND TD.COMPANY_ID = TH.COMPANY_ID
         AND TD.OUT_TRANS_NO = TH.OUT_TRANS_NO         
         AND TD.ORG_ID = OD.ORG_ID
         AND TD.COMPANY_ID = OD.COMPANY_ID
         AND TD.OUT_PO_NO = OD.OUT_PO_NO
         AND TD.OUT_PO_SEQ = OD.OUT_PO_SEQ  
         AND OD.ORG_ID = WO.ORG_ID
         AND OD.COMPANY_ID = WO.COMPANY_ID
         AND OD.WORK_ORDER_ID = WO.WORK_ORDER_ID
         AND OD.WORK_ORDER_SEQ = WO.WORK_ORDER_SEQ
         AND WO.ORG_ID = RC.ORG_ID
         AND WO.COMPANY_ID = RC.COMPANY_ID
         AND WO.ROUTING_CODE = RC.ROUTING_ID         
         AND LH.ORGID = #ORGID#
         AND LH.COMPANYID = #COMPANYID#
         AND LH.LOTNO = #LOTNO#
         AND RC.ROUTING_NO = (SELECT MAX(CRC.ROUTING_NO)
                                FROM CB_TRANS_LOT_D CTLD
                                    ,CB_OUT_TRANS_D COTD
                                    ,CB_OUT_ORDER_D COOD
                                    ,CB_WORK_ORDER CWO
                                    ,CB_ROUTING_CONTROL CRC
                               WHERE 1=1
                                 AND CTLD.ORG_ID = COTD.ORG_ID
                                 AND CTLD.COMPANY_ID = COTD.COMPANY_ID
                                 AND CTLD.OUT_TRANS_NO = COTD.OUT_TRANS_NO
                                 AND CTLD.OUT_TRANS_SEQ = COTD.OUT_TRANS_SEQ
                                 AND COTD.ORG_ID = COOD.ORG_ID
                                 AND COTD.COMPANY_ID = COOD.COMPANY_ID
                                 AND COTD.OUT_PO_NO = COOD.OUT_PO_NO
                                 AND COTD.OUT_PO_SEQ = COOD.OUT_PO_SEQ
                                 AND COOD.ORG_ID = CWO.ORG_ID
                                 AND COOD.COMPANY_ID = CWO.COMPANY_ID
                                 AND COOD.WORK_ORDER_ID = CWO.WORK_ORDER_ID
                                 AND COOD.WORK_ORDER_SEQ = CWO.WORK_ORDER_SEQ
                                 AND CWO.ORG_ID = CRC.ORG_ID
                                 AND CWO.COMPANY_ID = CRC.COMPANY_ID
                                 AND CWO.ROUTING_CODE = CRC.ROUTING_ID
                                 AND CTLD.ORG_ID = LD.ORG_ID
                                 AND CTLD.COMPANY_ID = LD.COMPANY_ID
                                 AND CTLD.LOT_NO = LD.LOT_NO)
    </select>
    
    <select id="report.purchase.order.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT RANK() OVER(ORDER BY ORG_ID, COMPANY_ID, PO_NO, PO_SEQ) AS RN
				      ,ORG_ID AS ORGID
				      ,COMPANY_ID AS COMPANYID
				      ,PO_NO AS PONO
				      ,PO_DATE AS PODATE
				      ,PO_DATE1 AS PODATE1
				      ,CUSTOMER_CODE AS CUSTOMERCODE
				      ,CUSTOMER_NAME AS CUSTOMERNAME
				      ,LICENSE_NO AS LICENSENO
				      ,CUSTOMER_PERSON AS CUSTOMERPERSON
				      ,CUSTOMER_PERSON_NAME AS CUSTOMERPERSONNAME
				      ,CUSTOMER_PERSON_PHONE AS CUSTOMERPERSONPHONE
				      ,PHONE_NUMBER AS PHONENUMBER
				      ,FAX_NUMBER AS FAXNUMBER
				      ,REFER AS REFER
				      ,DELIVERY_LOCATION AS DELIVERYLOCATION
				      ,DELIVERY_LOCATION_NAME AS DELIVERYLOCATIONNAME
				      ,DUE_DATE AS DUEDATE
				      ,CUSTOMER_IMAGE AS CUSTOMERIMAGE
				      ,TO_CUSTOMER_CODE AS TOCUSTOMERCODE
				      ,TO_CUSTOMER_NAME AS TOCUSTOMERNAME
				      ,TO_LICENSE_NO AS TOLICENSENO
				      ,TO_OWNER AS TOOWNER
				      ,TO_ADDRESS AS TOADDRESS
				      ,TO_PHONE_NUMBER AS TOPHONENUMBER
				      ,TO_FAX_NUMBER AS TOFAXNUMBER
				      ,PO_PERSON AS POPERSON
				      ,PO_KR_NAME AS POKRNAME
				      ,PO_PHONE_NUMBER AS POPHONENUMBER
				      ,PO_DEPT_NAME AS PODEPTNAME
				      ,TOTAL_KOREAN AS TOTALKOREAN
				      ,TOTAL_NUMBER AS TOTALNUMBER
				      ,DISPLAY_TEXT AS DISPLAYTEXT
				      ,PO_SEQ AS POSEQ
				      ,ITEM_CODE AS ITEMCODE
				      ,ITEM_NAME AS ITEMNAME
				      ,ORDER_NAME AS ORDERNAME
				      ,ITEM_STANDARD AS ITEMSTANDARD
				      ,MATERIAL_TYPE AS MATERIALTYPE
				      ,ITEM_MATERIAL_TYPE AS ITEMMATERIALTYPE
				      ,UOM AS UOM
				      ,UOM_NAME AS UOMNAME
				      ,ORDER_QTY AS ORDERQTY
				      ,UNIT_PRICE AS UNITPRICE
				      ,SUPPLY_PRICE AS SUPPLYPRICE
				      ,ADDITIONAL_TAX AS ADDITIONALTAX
				      ,TOTAL AS TOTAL
				      ,DETAIL_REMARKS AS DETAILREMARKS
				      ,TOTAL_ORDER_QTY AS TOTALORDERQTY
				      ,TOTAL_SUPPLY_PRICE AS TOTALSUPPLYPRICE
				      ,TOTAL_ADDITIONAL_TAX AS TOTALADDITIONALTAX
				      ,REMARKS AS REMARKS
				      ,LOGO_IMAGE AS LOGOIMAGE
				      ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
				      ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
				      ,FOOTER_RIGHT_INFO AS FOOTERRIGHTINFO
		  FROM CB_ORDER_REPORT_V
		 WHERE 1=1
		   AND ORG_ID = $searchOrgId$
		   AND COMPANY_ID = $searchCompanyId$
		   AND PO_NO = #PoNo#
		 ORDER BY ORG_ID, COMPANY_ID, PO_NO, PO_SEQ
    </select>
    
    
    
    <select id="report.lottransslipreport.report.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT RANK() OVER(ORDER BY OLV.ORGID, OLV.COMPANYID, OLV.WORKORDERID, OLV.WORKORDERSEQ) AS RN
				      ,OLV.ORGID AS ORGID
				      ,(SELECT CO.ORG_NAME
				          FROM CB_ORG CO
				         WHERE 1=1
				           AND CO.ORG_ID = OLV.ORGID) AS ORGNAME
				      ,OLV.COMPANYID AS COMPANYID
				      ,OLV.WORKORDERID AS WORKORDERID
				      ,OLV.ITEMCODE AS ITEMCODE
				      ,OLV.ORDERNAME AS ORDERNAME
				      ,OLV.ITEMNAME AS ITEMNAME
				      ,OLV.MODEL AS MODEL
				      ,OLV.ROUTINGNO AS ROUTINGNO
				      ,OLV.ROUTINGNAME AS ROUTINGNAME
				      ,TO_CHAR(TO_DATE(OLV.WORKSTARTDATE, 'YYYY-MM-DD HH24:MI:SS'), 'YY-MM-DD') AS WORKSTARTDATE
				      ,TO_CHAR(TO_DATE(OLV.WORKENDDATE, 'YYYY-MM-DD HH24:MI:SS'), 'YY-MM-DD') AS WORKENDDATE
				      ,REPLACE(OLV.WORKEMP, ',', ', ') AS WORKER
              ,DECODE(OH.WORK_ORDER_QTY, 0, '', TO_CHAR(OH.WORK_ORDER_QTY, 'FM9,999,999,999')) AS WORKORDERQTY
				      ,DECODE(OLV.IMPORTQTY, 0, '', TO_CHAR(OLV.IMPORTQTY, 'FM9,999,999,999')) AS IMPORTQTY
				      ,DECODE(OLV.DEFECTEDQTY, 0, '', TO_CHAR(OLV.DEFECTEDQTY, 'FM9,999,999,999')) AS DEFECTEDQTY
				      ,(SELECT TO_CHAR(WO.WORK_PLAN_START_DATE, 'YYYY-MM-DD')
				          FROM CB_WORK_ORDER WO
				         WHERE 1=1
				           AND WO.ORG_ID = OLV.ORGID
				           AND WO.COMPANY_ID = OLV.COMPANYID
				           AND WO.WORK_ORDER_ID = OLV.WORKORDERID
				           AND WO.WORK_ORDER_SEQ = (SELECT MIN(CWO.WORK_ORDER_SEQ)
				                                      FROM CB_WORK_ORDER CWO
				                                     WHERE 1=1
				                                       AND WO.ORG_ID = OLV.ORGID
				                                       AND WO.COMPANY_ID = OLV.COMPANYID
				                                       AND WO.WORK_ORDER_ID = OLV.WORKORDERID)) AS WORKPLANSTARTDATE
				      ,PLV.DUE_DATE AS DUEDATE
				      ,MV.CUSTOMER_CODE AS CUSTOMERCODE
				      ,(SELECT CC.CUSTOMER_NAME
				          FROM CB_CUSTOMER CC
				         WHERE 1=1
				           AND CC.ORG_ID = MV.ORG_ID
				           AND CC.COMPANY_ID = MV.COMPANY_ID
				           AND CC.CUSTOMER_CODE = MV.CUSTOMER_CODE
				         ) AS CUSTOMERNAME
				      ,MV.ITEM_STANDARD AS ITEMSTANDARD
				      ,TO_CHAR(DECODE(OLV.IMPORTQTY, 0, NULL, OLV.IMPORTQTY), 'FM999,999,999') AS BOXQTY
				      ,TO_CHAR(NVL(DECODE((SELECT COUNT(WOD.QTY)
				                             FROM CB_WORK_ORDER_D WOD
				                            WHERE 1 = 1
				                              AND WOD.ORG_ID = OLV.ORGID
				                              AND WOD.COMPANY_ID = OLV.COMPANYID
				                              AND WOD.WORK_ORDER_ID = OLV.WORKORDERID
				                              AND WOD.WORK_ORDER_SEQ = OLV.WORKORDERSEQ), 0, NULL, (SELECT COUNT(WOD.QTY)
				                                                                                      FROM CB_WORK_ORDER_D WOD
				                                                                                     WHERE 1 = 1
				                                                                                       AND WOD.ORG_ID = OLV.ORGID
				                                                                                       AND WOD.COMPANY_ID = OLV.COMPANYID
				                                                                                       AND WOD.WORK_ORDER_ID = OLV.WORKORDERID
				                                                                                       AND WOD.WORK_ORDER_SEQ = OLV.WORKORDERSEQ)),
				                    NULL), 'FM999,999,999') AS BOXCNT
			      ,DECODE(OH.REMARKS
					             ,NULL, NULL
					             ,'※ ' || OH.REMARKS) AS REMARKS
			      ,(SELECT WOI.LOT_NO
			          FROM CB_WORK_ORDER_ITEM WOI
			         WHERE 1=1
			           AND WOI.ORG_ID = OLV.ORGID
			           AND WOI.COMPANY_ID = OLV.COMPANYID
			           AND WOI.WORK_ORDER_ID = OLV.WORKORDERID
			           AND (WOI.ORG_ID, WOI.COMPANY_ID, WOI.WORK_ORDER_ID, WOI.WORK_ORDER_SEQ, WOI.SEQ_NO) = (SELECT MIN(WOI1.ORG_ID), MIN(WOI1.COMPANY_ID), MIN(WOI1.WORK_ORDER_ID), MIN(WOI1.WORK_ORDER_SEQ), MIN(WOI1.SEQ_NO)
			                                                                                                    FROM CB_WORK_ORDER_ITEM WOI1
			                                                                                                   WHERE 1=1
			                                                                                                     AND WOI1.ORG_ID = OLV.ORGID
			                                                                                                     AND WOI1.COMPANY_ID = OLV.COMPANYID
			                                                                                                     AND WOI1.WORK_ORDER_ID = OLV.WORKORDERID
			                                                                                                     AND WOI1.LOT_NO LIKE 'M%')) AS MATLOTNO
			      ,(SELECT WOI.LOT_NO
			          FROM CB_WORK_ORDER_ITEM WOI
			         WHERE 1=1
			           AND WOI.ORG_ID = OLV.ORGID
			           AND WOI.COMPANY_ID = OLV.COMPANYID
			           AND WOI.WORK_ORDER_ID = OLV.WORKORDERID
			           AND (WOI.ORG_ID, WOI.COMPANY_ID, WOI.WORK_ORDER_ID, WOI.WORK_ORDER_SEQ, WOI.SEQ_NO) = (SELECT MIN(WOI1.ORG_ID), MIN(WOI1.COMPANY_ID), MIN(WOI1.WORK_ORDER_ID), MIN(WOI1.WORK_ORDER_SEQ), MIN(WOI1.SEQ_NO)
			                                                                                                    FROM CB_WORK_ORDER_ITEM WOI1
			                                                                                                   WHERE 1=1
			                                                                                                     AND WOI1.ORG_ID = OLV.ORGID
			                                                                                                     AND WOI1.COMPANY_ID = OLV.COMPANYID
			                                                                                                     AND WOI1.WORK_ORDER_ID = OLV.WORKORDERID
			                                                                                                     AND WOI1.LOT_NO LIKE 'W%')) AS WORKLOTNO
		 FROM CB_WORK_ORDER_LIST_V OLV
		     ,CB_WORK_ORDER_HEADER OH
		     ,CB_PROD_PLAN_MANAGE_V PLV
		     ,CB_ITEM_MASTER_V MV
		WHERE 1=1
		   AND OLV.ORGID = OH.ORG_ID
		   AND OLV.COMPANYID = OH.COMPANY_ID
		   AND OLV.WORKORDERID = OH.WORK_ORDER_ID
		   AND OH.ORG_ID = PLV.ORG_ID(+)
		   AND OH.COMPANY_ID = PLV.COMPANY_ID(+)
		   AND OH.WORK_PLAN_NO = PLV.WORK_PLAN_NO(+)
		   AND OLV.ORGID = MV.ORG_ID
		   AND OLV.COMPANYID = MV.COMPANY_ID
		   AND OLV.ITEMCODE = MV.ITEM_CODE
		   AND OLV.ORGID = #ORGID#
		   AND OLV.COMPANYID  = #COMPANYID#
		   AND OLV.WORKORDERID = #WORKORDERID#
    </select>
    
    <select id="report.lot.trans.slip.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT RANK() OVER(ORDER BY OLV.ORGID, OLV.COMPANYID, OLV.WORKORDERID, OLV.WORKORDERSEQ) AS RN
              ,OLV.ORGID AS ORGID
              ,(SELECT CO.ORG_NAME
                  FROM CB_ORG CO
                 WHERE CO.ORG_ID = OLV.ORGID) AS ORGNAME
              ,OLV.COMPANYID AS COMPANYID
              ,OLV.WORKORDERID AS WORKORDERID
              ,OLV.ITEMCODE AS ITEMCODE
              ,OLV.ORDERNAME AS ORDERNAME
              ,OLV.ITEMNAME AS ITEMNAME
              ,OLV.MODEL AS MODEL
              ,OLV.ROUTINGNO AS ROUTINGNO
              ,OLV.ROUTINGNAME AS ROUTINGNAME
              ,TO_CHAR(TO_DATE(OLV.WORKSTARTDATE, 'YYYY-MM-DD HH24:MI:SS'), 'YY-MM-DD') AS WORKSTARTDATE
              ,TO_CHAR(TO_DATE(OLV.WORKENDDATE, 'YYYY-MM-DD HH24:MI:SS'), 'YY-MM-DD') AS WORKENDDATE
              ,REPLACE(OLV.WORKEMP, ',', ', ') AS WORKER
              ,DECODE(OH.WORK_ORDER_QTY, 0, '', TO_CHAR(OH.WORK_ORDER_QTY, 'FM9,999,999,999')) AS WORKORDERQTY
              ,DECODE(OLV.IMPORTQTY, 0, '', TO_CHAR(OLV.IMPORTQTY, 'FM9,999,999,999')) AS IMPORTQTY
              ,DECODE(OLV.DEFECTEDQTY, 0, '', TO_CHAR(OLV.DEFECTEDQTY, 'FM9,999,999,999')) AS DEFECTEDQTY
              ,(SELECT TO_CHAR(WO.WORK_PLAN_START_DATE, 'YYYY-MM-DD')
                 FROM CB_WORK_ORDER WO
                WHERE WO.ORG_ID = OLV.ORGID
                   AND WO.COMPANY_ID = OLV.COMPANYID
                   AND WO.WORK_ORDER_ID = OLV.WORKORDERID
                   AND WO.WORK_ORDER_SEQ = (SELECT MIN(CWO.WORK_ORDER_SEQ)
                                               FROM CB_WORK_ORDER CWO
                                              WHERE WO.ORG_ID = OLV.ORGID
                                                 AND WO.COMPANY_ID = OLV.COMPANYID
                                                 AND WO.WORK_ORDER_ID = OLV.WORKORDERID)) AS WORKPLANSTARTDATE
               ,PLV.DUE_DATE AS DUEDATE
               ,MV.CUSTOMER_CODE AS CUSTOMERCODE
               ,(SELECT CC.CUSTOMER_NAME
                   FROM CB_CUSTOMER CC
                  WHERE CC.ORG_ID = MV.ORG_ID
                    AND CC.COMPANY_ID = MV.COMPANY_ID
                    AND CC.CUSTOMER_CODE = MV.CUSTOMER_CODE
                  ) AS CUSTOMERNAME
               ,MV.ITEM_STANDARD AS ITEMSTANDARD
				       ,DECODE(OLV.WORKORDERSEQ, #WORKORDERSEQ#, TO_CHAR(#BOXQTY#, 'FM999,999,999'), TO_CHAR(DECODE((SELECT SUM(WOD.QTY)
                                                                                                                                                         FROM CB_WORK_ORDER_D WOD
                                                                                                                                                        WHERE WOD.ORG_ID = OLV.ORGID
                                                                                                                                                           AND WOD.COMPANY_ID = OLV.COMPANYID
                                                                                                                                                           AND WOD.WORK_ORDER_ID = OLV.WORKORDERID
                                                                                                                                                           AND WOD.WORK_ORDER_SEQ = OLV.WORKORDERSEQ
                                                                                                                                                           AND WOD.WORK_CENTER_CODE = #EQUIPMENTCODE#), 0, NULL, (SELECT SUM(WOD.QTY)
                                                                                                                                                                                                                                             FROM CB_WORK_ORDER_D WOD
                                                                                                                                                                                                                                            WHERE 1=1
                                                                                                                                                                                                                                               AND WOD.ORG_ID = OLV.ORGID
                                                                                                                                                                                                                                               AND WOD.COMPANY_ID = OLV.COMPANYID
                                                                                                                                                                                                                                               AND WOD.WORK_ORDER_ID = OLV.WORKORDERID
                                                                                                                                                                                                                                               AND WOD.WORK_ORDER_SEQ = OLV.WORKORDERSEQ
                                                                                                                                                                                                                                               AND WOD.WORK_CENTER_CODE = #EQUIPMENTCODE#)), 'FM999,999,999')) AS BOXQTY
				       ,DECODE(OLV.WORKORDERSEQ, #WORKORDERSEQ#, TO_CHAR(#BOXCNT#, 'FM999,999,999'), TO_CHAR(DECODE((SELECT COUNT(WOD.QTY)
						                                                                                                                                             FROM CB_WORK_ORDER_D WOD
						                                                                                                                                            WHERE WOD.ORG_ID = OLV.ORGID
						                                                                                                                                               AND WOD.COMPANY_ID = OLV.COMPANYID
						                                                                                                                                               AND WOD.WORK_ORDER_ID = OLV.WORKORDERID
						                                                                                                                                               AND WOD.WORK_ORDER_SEQ = OLV.WORKORDERSEQ
						                                                                                                                                               AND WOD.WORK_CENTER_CODE = #EQUIPMENTCODE#), 0, NULL, (SELECT COUNT(WOD.QTY)
																																												                                                                                                                                                     FROM CB_WORK_ORDER_D WOD
																																												                                                                                                                                                    WHERE 1=1
																																												                                                                                                                                                       AND WOD.ORG_ID = OLV.ORGID
																																												                                                                                                                                                       AND WOD.COMPANY_ID = OLV.COMPANYID
																																												                                                                                                                                                       AND WOD.WORK_ORDER_ID = OLV.WORKORDERID
																																												                                                                                                                                                       AND WOD.WORK_ORDER_SEQ = OLV.WORKORDERSEQ
																																												                                                                                                                                                       AND WOD.WORK_CENTER_CODE = #EQUIPMENTCODE#)), 'FM999,999,999')) AS BOXCNT
              ,DECODE(OH.REMARKS
                         ,NULL, NULL
                         ,'※ ' || OH.REMARKS) AS REMARKS
				      ,(SELECT WOI.LOT_NO
				          FROM CB_WORK_ORDER_ITEM WOI
				         WHERE WOI.ORG_ID = OLV.ORGID
				           AND WOI.COMPANY_ID = OLV.COMPANYID
				           AND WOI.WORK_ORDER_ID = OLV.WORKORDERID
				           AND (WOI.ORG_ID, WOI.COMPANY_ID, WOI.WORK_ORDER_ID, WOI.WORK_ORDER_SEQ, WOI.SEQ_NO) = (SELECT MIN(WOI1.ORG_ID), MIN(WOI1.COMPANY_ID), MIN(WOI1.WORK_ORDER_ID), MIN(WOI1.WORK_ORDER_SEQ), MIN(WOI1.SEQ_NO)
				                                                                                                    FROM CB_WORK_ORDER_ITEM WOI1
				                                                                                                   WHERE WOI1.ORG_ID = OLV.ORGID
				                                                                                                     AND WOI1.COMPANY_ID = OLV.COMPANYID
				                                                                                                     AND WOI1.WORK_ORDER_ID = OLV.WORKORDERID
				                                                                                                     AND WOI1.LOT_NO LIKE 'M%')) AS MATLOTNO
				      ,(SELECT WOI.LOT_NO
				          FROM CB_WORK_ORDER_ITEM WOI
				         WHERE WOI.ORG_ID = OLV.ORGID
				           AND WOI.COMPANY_ID = OLV.COMPANYID
				           AND WOI.WORK_ORDER_ID = OLV.WORKORDERID
				           AND (WOI.ORG_ID, WOI.COMPANY_ID, WOI.WORK_ORDER_ID, WOI.WORK_ORDER_SEQ, WOI.SEQ_NO) = (SELECT MIN(WOI1.ORG_ID), MIN(WOI1.COMPANY_ID), MIN(WOI1.WORK_ORDER_ID), MIN(WOI1.WORK_ORDER_SEQ), MIN(WOI1.SEQ_NO)
				                                                                                                    FROM CB_WORK_ORDER_ITEM WOI1
				                                                                                                   WHERE WOI1.ORG_ID = OLV.ORGID
				                                                                                                     AND WOI1.COMPANY_ID = OLV.COMPANYID
				                                                                                                     AND WOI1.WORK_ORDER_ID = OLV.WORKORDERID
				                                                                                                     AND WOI1.LOT_NO LIKE 'W%')) AS WORKLOTNO
       FROM CB_WORK_ORDER_LIST_V OLV
               ,CB_WORK_ORDER_HEADER OH
               ,CB_PROD_PLAN_MANAGE_V PLV
               ,CB_ITEM_MASTER_V MV
      WHERE OLV.ORGID = OH.ORG_ID
         AND OLV.COMPANYID = OH.COMPANY_ID
         AND OLV.WORKORDERID = OH.WORK_ORDER_ID
         AND OH.ORG_ID = PLV.ORG_ID(+)
         AND OH.COMPANY_ID = PLV.COMPANY_ID(+)
         AND OH.WORK_PLAN_NO = PLV.WORK_PLAN_NO(+)
         AND OLV.ORGID = MV.ORG_ID
         AND OLV.COMPANYID = MV.COMPANY_ID
         AND OLV.ITEMCODE = MV.ITEM_CODE
         AND OLV.ORGID = #ORGID#
         AND OLV.COMPANYID  = #COMPANYID#
         AND OLV.WORKORDERID = #WORKORDERID#
    </select>
    
    <select id="report.transaction.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT *
      FROM (
								SELECT ROW_NUMBER() OVER(ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME) AS RN
									      ,ORG_ID AS ORGID
									      ,COMPANY_ID AS COMPANYID
							          ,#TYPEGUBUN# AS TYPEGUBUN
									      ,TRADE_NO AS TRADENO
									      ,TRADE_DATE AS TRADEDATE
									      ,DETAIL_TRADE_DATE AS DETAILTRADEDATE
									      ,LICENSE_NO AS LICENSENO
									      ,CUSTOMER_CODE AS CUSTOMERCODE
									      ,CUSTOMER_NAME AS CUSTOMERNAME
									      ,OWNER AS OWNER
									      ,ADDRESS AS ADDRESS
									      ,BIS_STATUS AS BISSTATUS
									      ,BIS_TYPE AS BISTYPE
									      ,PHONE_NUMBER AS PHONENUMBER
									      ,FAX_NUMBER AS FAXNUMBER
									      ,TO_LICENSE_NO AS TOLICENSENO
									      ,TO_CUSTOMER_CODE AS TOCUSTOMERCODE
									      ,TO_CUSTOMER_NAME AS TOCUSTOMERNAME
									      ,TO_OWNER AS TOOWNER
									      ,TO_ADDRESS AS TOADDRESS
									      ,TO_BIS_STATUS AS TOBISSTATUS
									      ,TO_BIS_TYPE AS TOBISTYPE
									      ,TO_PHONE_NUMBER AS TOPHONENUMBER
									      ,TO_FAX_NUMBER AS TOFAXNUMBER
									      ,STAMP_IMAGE AS STAMPIMAGE
									      ,END_DATE AS ENDDATE
									      ,ITEM_CODE AS ITEMCODE
									      ,ORDER_NAME AS ORDERNAME
									      ,DRAWING_NO AS DRAWINGNO
									      ,ITEM_NAME AS ITEMNAME
									      ,ITEM_STANDARD AS ITEMSTANDARD
									      ,TRANSACTION_QTY AS TRANSACTIONQTY
									      ,UNIT_PRICE AS UNITPRICE
									      ,SUPPLY_PRICE AS SUPPLYPRICE
									      ,ADDITIONAL_TAX AS ADDITIONALTAX
									      ,DETAIL_REMARKS AS DETAILREMARKS
									      ,TRANSACTION_PERSON AS TRANSACTIONPERSON
									      ,TRANSACTION_PERSON_NAME AS TRANSACTIONPERSONNAME
									      ,TOTAL_AMOUNT AS TOTALAMOUNT
									      ,LOGO_IMAGE AS LOGOIMAGE
									      ,LOGO_DISPLAY_YN AS LOGODISPLAYYN
									      ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
									      ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
							  FROM CB_TRADE_H_REPORT_V
							 WHERE ORG_ID = #ORGID#
							   AND COMPANY_ID = #COMPANYID#
							   AND TRADE_NO = #TRADENO#
							 ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME                )
     WHERE 1=1
         <isNotEmpty property="STARTNUM" prepend="AND">
            RN BETWEEN ((($STARTNUM$ - 1) * 9) + 1) AND ($STARTNUM$ * 9)
         </isNotEmpty>
    </select>
    
    <select id="report.transaction.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT *
		  FROM (
								SELECT ROW_NUMBER() OVER(ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME) AS RN
										      ,ORG_ID AS ORGID
										      ,COMPANY_ID AS COMPANYID
										      ,TRADE_NO AS TRADENO
										      ,TRADE_DATE AS TRADEDATE
										      ,DETAIL_TRADE_DATE AS DETAILTRADEDATE
										      ,LICENSE_NO AS LICENSENO
										      ,CUSTOMER_CODE AS CUSTOMERCODE
										      ,CUSTOMER_NAME AS CUSTOMERNAME
										      ,OWNER AS OWNER
										      ,ADDRESS AS ADDRESS
										      ,BIS_STATUS AS BISSTATUS
										      ,BIS_TYPE AS BISTYPE
										      ,PHONE_NUMBER AS PHONENUMBER
										      ,FAX_NUMBER AS FAXNUMBER
										      ,TO_LICENSE_NO AS TOLICENSENO
										      ,TO_CUSTOMER_CODE AS TOCUSTOMERCODE
										      ,TO_CUSTOMER_NAME AS TOCUSTOMERNAME
										      ,TO_OWNER AS TOOWNER
										      ,TO_ADDRESS AS TOADDRESS
										      ,TO_BIS_STATUS AS TOBISSTATUS
										      ,TO_BIS_TYPE AS TOBISTYPE
										      ,TO_PHONE_NUMBER AS TOPHONENUMBER
										      ,TO_FAX_NUMBER AS TOFAXNUMBER
										      ,END_DATE AS ENDDATE
										      ,ITEM_CODE AS ITEMCODE
										      ,ORDER_NAME AS ORDERNAME
										      ,DRAWING_NO AS DRAWINGNO
										      ,ITEM_NAME AS ITEMNAME
										      ,ITEM_STANDARD AS ITEMSTANDARD
										      ,TRANSACTION_QTY AS TRANSACTIONQTY
										      ,UNIT_PRICE AS UNITPRICE
										      ,SUPPLY_PRICE AS SUPPLYPRICE
										      ,ADDITIONAL_TAX AS ADDITIONALTAX
										      ,DETAIL_REMARKS AS DETAILREMARKS
										      ,TRANSACTION_PERSON AS TRANSACTIONPERSON
										      ,TRANSACTION_PERSON_NAME AS TRANSACTIONPERSONNAME
										      ,TOTAL_AMOUNT AS TOTALAMOUNT
								  FROM CB_TRADE_H_REPORT_V
								 WHERE ORG_ID = #ORGID#
						       AND COMPANY_ID = #COMPANYID#
						       AND TRADE_NO = #TRADENO#
								 ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME
								)
		 WHERE 1=1
         <isNotEmpty property="STARTNUM" prepend="AND">
            RN BETWEEN ((($STARTNUM$ - 1) * 9) + 1) AND ($STARTNUM$ * 9)
         </isNotEmpty>
    </select>
    
   <select id="report.scm.out.transaction.main.select" parameterClass="java.util.Map"
       resultClass="java.util.HashMap">
      SELECT *
      FROM (
                SELECT ROW_NUMBER() OVER(ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME, ROUTING_NAME) AS RN
                        ,ORG_ID AS ORGID
                        ,COMPANY_ID AS COMPANYID
                        ,#TYPEGUBUN# AS TYPEGUBUN
                        ,TRADE_NO AS TRADENO
                        ,TRADE_DATE AS TRADEDATE
                        ,DETAIL_TRADE_DATE AS DETAILTRADEDATE
                        ,LICENSE_NO AS LICENSENO
                        ,CUSTOMER_CODE AS CUSTOMERCODE
                        ,CUSTOMER_NAME AS CUSTOMERNAME
                        ,OWNER AS OWNER
                        ,ADDRESS AS ADDRESS
                        ,BIS_STATUS AS BISSTATUS
                        ,BIS_TYPE AS BISTYPE
                        ,PHONE_NUMBER AS PHONENUMBER
                        ,FAX_NUMBER AS FAXNUMBER
                        ,TO_LICENSE_NO AS TOLICENSENO
                        ,TO_CUSTOMER_CODE AS TOCUSTOMERCODE
                        ,TO_CUSTOMER_NAME AS TOCUSTOMERNAME
                        ,TO_OWNER AS TOOWNER
                        ,TO_ADDRESS AS TOADDRESS
                        ,TO_BIS_STATUS AS TOBISSTATUS
                        ,TO_BIS_TYPE AS TOBISTYPE
                        ,TO_PHONE_NUMBER AS TOPHONENUMBER
                        ,TO_FAX_NUMBER AS TOFAXNUMBER
                        ,END_DATE AS ENDDATE
                        ,ITEM_CODE AS ITEMCODE
                        ,ORDER_NAME AS ORDERNAME
                        ,DRAWING_NO AS DRAWINGNO
                        ,ITEM_NAME AS ITEMNAME
							          ,MODEL AS MODEL
							          ,MODEL_NAME AS MODELNAME
							          ,ITEM_STANDARD_DETAIL AS ITEMSTANDARDDETAIL
                        ,ROUTING_NAME AS ROUTINGNAME
                        ,MOD_QTY AS MODQTY
                        ,TRANSACTION_QTY AS TRANSACTIONQTY
                        ,UNIT_PRICE AS UNITPRICE
                        ,SUPPLY_PRICE AS SUPPLYPRICE
                        ,ADDITIONAL_TAX AS ADDITIONALTAX
                        ,DETAIL_REMARKS AS DETAILREMARKS
                        ,TRANSACTION_PERSON AS TRANSACTIONPERSON
                        ,TRANSACTION_PERSON_NAME AS TRANSACTIONPERSONNAME
                        ,TOTAL_AMOUNT AS TOTALAMOUNT
                        ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
                        ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
                FROM CB_SCM_TRADE_PROD_REPORT_V
               WHERE ORG_ID = #ORGID#
                 AND COMPANY_ID = #COMPANYID#
                 AND TRADE_NO = #TRADENO#
                 AND TRADE_DATE1 = TO_DATE(#TRADEDATE#,'YYYY-MM-DD')
               ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME, ROUTING_NAME                )
     WHERE 1=1
         <isNotEmpty property="STARTNUM" prepend="AND">
            RN BETWEEN ((($STARTNUM$ - 1) * 9) + 1) AND ($STARTNUM$ * 9)
         </isNotEmpty>
   </select>
   
    <select id="report.scm.out.transaction.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT *
      FROM (
                SELECT ROW_NUMBER() OVER(ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME, ROUTING_NAME) AS RN
                        ,ORG_ID AS ORGID
                        ,COMPANY_ID AS COMPANYID
                        ,TRADE_NO AS TRADENO
                        ,TRADE_DATE AS TRADEDATE
                        ,DETAIL_TRADE_DATE AS DETAILTRADEDATE
                        ,LICENSE_NO AS LICENSENO
                        ,CUSTOMER_CODE AS CUSTOMERCODE
                        ,CUSTOMER_NAME AS CUSTOMERNAME
                        ,OWNER AS OWNER
                        ,ADDRESS AS ADDRESS
                        ,BIS_STATUS AS BISSTATUS
                        ,BIS_TYPE AS BISTYPE
                        ,PHONE_NUMBER AS PHONENUMBER
                        ,FAX_NUMBER AS FAXNUMBER
                        ,TO_LICENSE_NO AS TOLICENSENO
                        ,TO_CUSTOMER_CODE AS TOCUSTOMERCODE
                        ,TO_CUSTOMER_NAME AS TOCUSTOMERNAME
                        ,TO_OWNER AS TOOWNER
                        ,TO_ADDRESS AS TOADDRESS
                        ,TO_BIS_STATUS AS TOBISSTATUS
                        ,TO_BIS_TYPE AS TOBISTYPE
                        ,TO_PHONE_NUMBER AS TOPHONENUMBER
                        ,TO_FAX_NUMBER AS TOFAXNUMBER
                        ,END_DATE AS ENDDATE
                        ,ITEM_CODE AS ITEMCODE
                        ,ORDER_NAME AS ORDERNAME
                        ,DRAWING_NO AS DRAWINGNO
                        ,ITEM_NAME AS ITEMNAME
                        ,ROUTING_NAME AS ROUTINGNAME
                        ,MOD_QTY AS MODQTY
                        ,TRANSACTION_QTY AS TRANSACTIONQTY
                        ,UNIT_PRICE AS UNITPRICE
                        ,SUPPLY_PRICE AS SUPPLYPRICE
                        ,ADDITIONAL_TAX AS ADDITIONALTAX
                        ,DETAIL_REMARKS AS DETAILREMARKS
                        ,TRANSACTION_PERSON AS TRANSACTIONPERSON
                        ,TRANSACTION_PERSON_NAME AS TRANSACTIONPERSONNAME
                        ,TOTAL_AMOUNT AS TOTALAMOUNT
                        ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
                        ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
                FROM CB_SCM_TRADE_PROD_REPORT_V
               WHERE ORG_ID = #ORGID#
                 AND COMPANY_ID = #COMPANYID#
                 AND TRADE_NO = #TRADENO#
                 AND TRADE_DATE1 = TO_DATE(#TRADEDATE#,'YYYY-MM-DD')
               ORDER BY ORG_ID, COMPANY_ID, TRADE_NO, TRADE_DATE, ITEM_NAME, ROUTING_NAME
                )
     WHERE 1=1
         <isNotEmpty property="STARTNUM" prepend="AND">
            RN BETWEEN ((($STARTNUM$ - 1) * 9) + 1) AND ($STARTNUM$ * 9)
         </isNotEmpty>
    </select>
    
    <select id="report.sales.purchase.result.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT TMP.ORG_ID AS ORGID
				      ,TMP.COMPANY_ID AS COMPANYID
				      ,(SELECT CO.ORG_NAME
				          FROM CB_ORG CO
				         WHERE 1=1
				           AND CO.ORG_ID = TMP.ORG_ID) || '    ' || TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월 매출 - 매입 계획 및 실적' AS TITLE
				      ,TO_CHAR(TMP.SEARCH_FROM, 'YYYY-MM-DD') AS SEARCHFROM
				      ,TO_CHAR(TMP.SEARCH_TO, 'YYYY-MM-DD') AS SEARCHTO
				      ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY-MM-DD') AS SEARCHNEXT
				      ,CB_COST_PKG.CB_TOTAL_SALES_PLAN_TOT_FNC(TMP.ORG_ID
				                                              ,TMP.COMPANY_ID
				                                              ,TMP.SEARCH_TO) AS SUB1VALUE1
				      ,CB_COST_PKG.CB_EXPECT_SALES_TOT_FNC(TMP.ORG_ID
				                                          ,TMP.COMPANY_ID
				                                          ,TMP.SEARCH_TO) AS SUB1VALUE2
				      ,CB_COST_PKG.CB_REAL_SALES_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO) AS SUB1VALUE3
				      ,CB_COST_PKG.CB_REAL_SALES_TOT_FNC(TMP.ORG_ID
				                                        ,TMP.COMPANY_ID
				                                        ,TMP.SEARCH_TO) AS SUB1VALUE4
				      ,CB_COST_PKG.CB_TOTAL_SALES_PLAN_TOT_FNC(TMP.ORG_ID
				                                              ,TMP.COMPANY_ID
				                                              ,TMP.SEARCH_NEXT) AS SUB1VALUE5
				      ,CB_COST_PKG.CB_EXPECT_SALES_TOT_FNC(TMP.ORG_ID
				                                          ,TMP.COMPANY_ID
				                                          ,TMP.SEARCH_NEXT) AS SUB1VALUE6
				      ,(CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'M')) AS SUB2VALUE1
				      ,(CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'M')) AS SUB2VALUE2
				      ,(CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'M')) AS SUB2VALUE3
				      ,(CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'M')) -
				       (CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'M')) AS SUB2VALUE4
				      ,(CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_NEXT
				                                               ,'M')) AS SUB2VALUE5
				      ,(CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'O')) AS SUB3VALUE1
				      ,(CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'O')) AS SUB3VALUE2
				      ,(CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'O')) AS SUB3VALUE3
				      ,(CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'O')) -
				       (CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'O')) AS SUB3VALUE4
				      ,(CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_NEXT
				                                               ,'O')) AS SUB3VALUE5
				      ,(CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'M') +
				        CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'O')) AS TOTVALUE1
				      ,(CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'M') +
				        CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'O')) AS TOTVALUE2
				      ,(CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'M') +
				        CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'O')) AS TOTVALUE3
				      ,(CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'M') +
				        CB_COST_PKG.CB_REAL_PURC_RESULT_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_TO
				                                               ,'O')) -
				       (CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'M') +
				        CB_COST_PKG.CB_REAL_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                             ,TMP.COMPANY_ID
				                                             ,TMP.SEARCH_TO
				                                             ,'O')) AS TOTVALUE4
				      ,(CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_NEXT
				                                               ,'M') +
				        CB_COST_PKG.CB_EXPECT_PURC_PLAN_TOT_FNC(TMP.ORG_ID
				                                               ,TMP.COMPANY_ID
				                                               ,TMP.SEARCH_NEXT
				                                               ,'O')) AS TOTVALUE5
		  FROM (SELECT #ORGID# AS ORG_ID
					              ,#COMPANYID# AS COMPANY_ID
					              ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
					              ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
					              ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			          FROM DUAL) TMP
    </select>
    
    <select id="report.sales.purchase.result.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT *
			  FROM (
			        SELECT CC.ORG_ID AS ORGID
				              ,CC.COMPANY_ID AS COMPANYID
				              ,TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월' AS SUBTITLE
				              ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_NEXT, 'MM') || '월' AS SUBTITLENEXT
				              ,CC.CUSTOMER_CODE AS CUSTOMERCODE
				              ,CC.CUSTOMER_NAME AS CUSTOMERNAME
				              ,CB_COST_PKG.CB_TOTAL_SALES_PLAN_FNC(CC.ORG_ID
				                                                  ,CC.COMPANY_ID
				                                                  ,CC.CUSTOMER_CODE
				                                                  ,TMP.SEARCH_TO) AS VALUE1
				              ,CB_COST_PKG.CB_EXPECT_SALES_FNC(CC.ORG_ID
				                                              ,CC.COMPANY_ID
				                                              ,CC.CUSTOMER_CODE
				                                              ,TMP.SEARCH_TO) AS VALUE2
				              ,CB_COST_PKG.CB_REAL_SALES_RESULT_FNC(CC.ORG_ID
				                                                   ,CC.COMPANY_ID
				                                                   ,CC.CUSTOMER_CODE
				                                                   ,TMP.SEARCH_TO) AS VALUE3
				              ,CB_COST_PKG.CB_REAL_SALES_FNC(CC.ORG_ID
				                                            ,CC.COMPANY_ID
				                                            ,CC.CUSTOMER_CODE
				                                            ,TMP.SEARCH_TO) AS VALUE4
				              ,CB_COST_PKG.CB_TOTAL_SALES_PLAN_FNC(CC.ORG_ID
				                                                  ,CC.COMPANY_ID
				                                                  ,CC.CUSTOMER_CODE
				                                                  ,TMP.SEARCH_NEXT) AS VALUE5
				              ,CB_COST_PKG.CB_EXPECT_SALES_FNC(CC.ORG_ID
				                                              ,CC.COMPANY_ID
				                                              ,CC.CUSTOMER_CODE
				                                              ,TMP.SEARCH_NEXT) AS VALUE6
			          FROM CB_CUSTOMER CC
			              ,(SELECT #ORGID# AS ORG_ID
				                      ,#COMPANYID# AS COMPANY_ID
				                      ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
				                      ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
				                      ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			                  FROM DUAL) TMP
			         WHERE 1=1
			           AND CC.ORG_ID = TMP.ORG_ID
			           AND CC.COMPANY_ID = TMP.COMPANY_ID
			           AND CC.CUSTOMER_TYPE IN ( 'A' , 'S' )
			           AND (CC.CUSTOMER_CODE IN (SELECT TH.CUSTOMER_CODE
			                                       FROM CB_TRADE_H TH
			                                           ,CB_TRADE_D TD
			                                      WHERE 1=1
			                                        AND TH.ORG_ID = TD.ORG_ID
			                                        AND TH.COMPANY_ID = TD.COMPANY_ID
			                                        AND TH.TRADE_NO = TD.TRADE_NO
			                                        AND TD.ORG_ID = TMP.ORG_ID
			                                        AND TD.COMPANY_ID = TMP.COMPANY_ID
			                                        AND TH.TRADE_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_NEXT
			                                     )
			            OR CC.CUSTOMER_CODE IN (SELECT OH.CUSTOMER_CODE
			                                      FROM CB_SALES_ORDER_H OH
			                                          ,CB_SALES_ORDER_D OD
			                                     WHERE 1=1
			                                       AND OH.ORG_ID = OD.ORG_ID
			                                       AND OH.COMPANY_ID = OD.COMPANY_ID
			                                       AND OH.SO_NO = OD.SO_NO
			                                       AND OD.ORG_ID = TMP.ORG_ID
			                                       AND OD.COMPANY_ID = TMP.COMPANY_ID
			                                       AND OH.SO_STATUS <> 'CANCEL'
			                                       AND OH.DUE_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_NEXT
			                                    )
			           )
			         ) A
			 WHERE 1=1
			 ORDER BY ORGID, COMPANYID, VALUE4 DESC, CUSTOMERNAME
      ]]>
    </select>
    
    <select id="report.sales.purchase.result.sub2.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT *
			  FROM (SELECT RANK() OVER(ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                                     ,CC.COMPANY_ID
			                                                                                                     ,CC.CUSTOMER_CODE
			                                                                                                     ,TMP.SEARCH_TO
			                                                                                                     ,'M') DESC, CC.CUSTOMER_NAME) AS RN
			              ,CC.ORG_ID AS ORGID
			              ,CC.COMPANY_ID AS COMPANYID
			              ,TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월' AS SUBTITLE
			              ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_NEXT, 'MM') || '월' AS SUBTITLENEXT
			              ,CC.CUSTOMER_CODE AS CUSTOMERCODE
			              ,CC.CUSTOMER_NAME AS CUSTOMERNAME
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') AS VALUE1
			              ,CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'M') AS VALUE2
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') AS VALUE3
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') -
			               CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'M') AS VALUE4
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_NEXT
			                                                      ,'M') AS VALUE5
			          FROM CB_CUSTOMER CC
			              ,(SELECT 1 AS ORG_ID
			                      ,1 AS COMPANY_ID
			                      ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
			                      ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
			                      ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			                  FROM DUAL) TMP
			         WHERE 1=1
			           AND CC.ORG_ID = TMP.ORG_ID
			           AND CC.COMPANY_ID = TMP.COMPANY_ID
			           AND CC.CUSTOMER_TYPE IN ( 'A', 'P' )
			           AND (CC.CUSTOMER_CODE IN (SELECT TH.CUSTOMER_CODE
			                                       FROM CB_TRANS_H TH
			                                           ,CB_TRANS_D TD
			                                      WHERE 1=1
			                                        AND TH.ORG_ID = TD.ORG_ID
			                                        AND TH.COMPANY_ID = TD.COMPANY_ID
			                                        AND TH.TRANS_NO = TD.TRANS_NO
			                                        AND TD.ORG_ID = TMP.ORG_ID
			                                        AND TD.COMPANY_ID = TMP.COMPANY_ID
			                                        AND TD.CONFIRM_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_TO
			                                     )
			             OR CC.CUSTOMER_CODE IN (SELECT IM.CUSTOMER_CODE
			                                       FROM CB_TRADE_H TH
			                                           ,CB_TRADE_D TD
			                                           ,CB_BOM CB
			                                           ,CB_ITEM_MASTER IM
			                                      WHERE 1=1
			                                        AND TH.ORG_ID = TD.ORG_ID
			                                        AND TH.COMPANY_ID = TD.COMPANY_ID
			                                        AND TH.TRADE_NO = TD.TRADE_NO
			                                        AND TD.ORG_ID = CB.ORG_ID
			                                        AND TD.COMPANY_ID = CB.COMPANY_ID
			                                        AND TD.ITEM_CODE = CB.UPPER_ITEM_CODE
			                                        AND CB.ORG_ID = IM.ORG_ID
			                                        AND CB.COMPANY_ID = IM.COMPANY_ID
			                                        AND CB.ITEM_CODE = IM.ITEM_CODE
			                                        AND IM.GROUP_CODE = 'M'
			                                        AND IM.ORG_ID = TMP.ORG_ID
			                                        AND IM.COMPANY_ID = TMP.COMPANY_ID
			                                        AND TD.END_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_TO
			                                     )
			             OR CC.CUSTOMER_CODE IN (SELECT IM.CUSTOMER_CODE
			                                       FROM CB_SALES_ORDER_H OH
			                                           ,CB_SALES_ORDER_D OD
			                                           ,CB_BOM CB
			                                           ,CB_ITEM_MASTER IM
			                                      WHERE 1=1
			                                        AND OH.ORG_ID = OD.ORG_ID
			                                        AND OH.COMPANY_ID = OD.COMPANY_ID
			                                        AND OH.SO_NO = OD.SO_NO
			                                        AND OD.ORG_ID = CB.ORG_ID
			                                        AND OD.COMPANY_ID = CB.COMPANY_ID
			                                        AND OD.ITEM_CODE = CB.UPPER_ITEM_CODE
			                                        AND CB.ORG_ID = IM.ORG_ID
			                                        AND CB.COMPANY_ID = IM.COMPANY_ID
			                                        AND CB.ITEM_CODE = IM.ITEM_CODE
			                                        AND OH.SO_STATUS <> 'CANCEL'
			                                        AND IM.GROUP_CODE = 'M'
			                                        AND IM.ORG_ID = TMP.ORG_ID
			                                        AND IM.COMPANY_ID = TMP.COMPANY_ID
			                                        AND OD.DUE_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_TO
			                                     )
			           )
			           AND CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') > (SELECT SC.SMALL_NAME
			                                                                           FROM CB_SMALL_CODE SC
			                                                                          WHERE 1=1
			                                                                            AND SC.ORG_ID = CC.ORG_ID
			                                                                            AND SC.COMPANY_ID = CC.COMPANY_ID
			                                                                            AND SC.BIG_CODE = 'CMM'
			                                                                            AND SC.MIDDLE_CODE = 'STANDARD_AMOUNT'
			                                                                            AND SC.SMALL_CODE = 'M')
			         ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                   ,CC.COMPANY_ID
			                                                                                   ,CC.CUSTOMER_CODE
			                                                                                   ,TMP.SEARCH_TO
			                                                                                   ,'M') DESC, CC.CUSTOMER_NAME
			         )
			 WHERE 1=1
			   AND RN BETWEEN 1 AND 14
			 UNION ALL
			SELECT 999 AS RN
			      ,MAX(ORGID) AS ORGID
			      ,MAX(COMPANYID) AS COMPANYID
			      ,TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월' AS SUBTITLE
			      ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_NEXT, 'MM') || '월' AS SUBTITLENEXT
			      ,NULL AS CUSTOMERCODE
			      ,'소재기타' AS CUSTOMERNAME
			      ,NVL(SUM(VALUE1), 0) AS VALUE1
			      ,NVL(SUM(VALUE2), 0) AS VALUE2
			      ,NVL(SUM(VALUE3), 0) AS VALUE3
			      ,NVL(SUM(VALUE4), 0) AS VALUE4
			      ,NVL(SUM(VALUE5), 0) AS VALUE5
			  FROM (SELECT RANK() OVER(ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                                     ,CC.COMPANY_ID
			                                                                                                     ,CC.CUSTOMER_CODE
			                                                                                                     ,TMP.SEARCH_TO
			                                                                                                     ,'M') DESC, CC.CUSTOMER_NAME) AS RN
			              ,CC.ORG_ID AS ORGID
			              ,CC.COMPANY_ID AS COMPANYID
			              ,TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월' AS SUBTITLE
			              ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_NEXT, 'MM') || '월' AS SUBTITLENEXT
			              ,CC.CUSTOMER_CODE AS CUSTOMERCODE
			              ,CC.CUSTOMER_NAME AS CUSTOMERNAME
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') AS VALUE1
			              ,CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'M') AS VALUE2
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') AS VALUE3
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') -
			               CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'M') AS VALUE4
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_NEXT
			                                                      ,'M') AS VALUE5
			          FROM CB_CUSTOMER CC
			              ,(SELECT #ORGID# AS ORG_ID
			                      ,#COMPANYID# AS COMPANY_ID
			                      ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
			                      ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
			                      ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			                  FROM DUAL) TMP
			         WHERE 1=1
			           AND CC.ORG_ID = TMP.ORG_ID
			           AND CC.COMPANY_ID = TMP.COMPANY_ID
			           AND CC.CUSTOMER_TYPE IN ( 'A', 'P' )
			           AND (CC.CUSTOMER_CODE IN (SELECT TH.CUSTOMER_CODE
			                                       FROM CB_TRANS_H TH
			                                           ,CB_TRANS_D TD
			                                      WHERE 1=1
			                                        AND TH.ORG_ID = TD.ORG_ID
			                                        AND TH.COMPANY_ID = TD.COMPANY_ID
			                                        AND TH.TRANS_NO = TD.TRANS_NO
			                                        AND TD.ORG_ID = TMP.ORG_ID
			                                        AND TD.COMPANY_ID = TMP.COMPANY_ID
			                                        AND TD.CONFIRM_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_TO
			                                     )
			             OR CC.CUSTOMER_CODE IN (SELECT IM.CUSTOMER_CODE
			                                       FROM CB_TRADE_H TH
			                                           ,CB_TRADE_D TD
			                                           ,CB_BOM CB
			                                           ,CB_ITEM_MASTER IM
			                                      WHERE 1=1
			                                        AND TH.ORG_ID = TD.ORG_ID
			                                        AND TH.COMPANY_ID = TD.COMPANY_ID
			                                        AND TH.TRADE_NO = TD.TRADE_NO
			                                        AND TD.ORG_ID = CB.ORG_ID
			                                        AND TD.COMPANY_ID = CB.COMPANY_ID
			                                        AND TD.ITEM_CODE = CB.UPPER_ITEM_CODE
			                                        AND CB.ORG_ID = IM.ORG_ID
			                                        AND CB.COMPANY_ID = IM.COMPANY_ID
			                                        AND CB.ITEM_CODE = IM.ITEM_CODE
			                                        AND IM.GROUP_CODE = 'M'
			                                        AND IM.ORG_ID = TMP.ORG_ID
			                                        AND IM.COMPANY_ID = TMP.COMPANY_ID
			                                        AND TD.END_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_TO
			                                     )
			             OR CC.CUSTOMER_CODE IN (SELECT IM.CUSTOMER_CODE
			                                       FROM CB_SALES_ORDER_H OH
			                                           ,CB_SALES_ORDER_D OD
			                                           ,CB_BOM CB
			                                           ,CB_ITEM_MASTER IM
			                                      WHERE 1=1
			                                        AND OH.ORG_ID = OD.ORG_ID
			                                        AND OH.COMPANY_ID = OD.COMPANY_ID
			                                        AND OH.SO_NO = OD.SO_NO
			                                        AND OD.ORG_ID = CB.ORG_ID
			                                        AND OD.COMPANY_ID = CB.COMPANY_ID
			                                        AND OD.ITEM_CODE = CB.UPPER_ITEM_CODE
			                                        AND CB.ORG_ID = IM.ORG_ID
			                                        AND CB.COMPANY_ID = IM.COMPANY_ID
			                                        AND CB.ITEM_CODE = IM.ITEM_CODE
			                                        AND OH.SO_STATUS <> 'CANCEL'
			                                        AND IM.GROUP_CODE = 'M'
			                                        AND IM.ORG_ID = TMP.ORG_ID
			                                        AND IM.COMPANY_ID = TMP.COMPANY_ID
			                                        AND OD.DUE_DATE BETWEEN TMP.SEARCH_FROM AND TMP.SEARCH_TO
			                                     )
			           )
			           AND CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'M') < (SELECT SC.SMALL_NAME
			                                                                           FROM CB_SMALL_CODE SC
			                                                                          WHERE 1=1
			                                                                            AND SC.ORG_ID = CC.ORG_ID
			                                                                            AND SC.COMPANY_ID = CC.COMPANY_ID
			                                                                            AND SC.BIG_CODE = 'CMM'
			                                                                            AND SC.MIDDLE_CODE = 'STANDARD_AMOUNT'
			                                                                            AND SC.SMALL_CODE = 'M')
			         ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                   ,CC.COMPANY_ID
			                                                                                   ,CC.CUSTOMER_CODE
			                                                                                   ,TMP.SEARCH_TO
			                                                                                   ,'M') DESC, CC.CUSTOMER_NAME
			         )
			      ,(SELECT #ORGID# AS ORG_ID
			              ,#COMPANYID# AS COMPANY_ID
			              ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
			              ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
			              ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			          FROM DUAL) TMP
			 WHERE 1=1
      ]]>
    </select>
    
    <select id="report.sales.purchase.result.sub3.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT *
			  FROM (SELECT RANK() OVER(ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                                     ,CC.COMPANY_ID
			                                                                                                     ,CC.CUSTOMER_CODE
			                                                                                                     ,TMP.SEARCH_TO
			                                                                                                     ,'O') DESC, CC.CUSTOMER_NAME) AS RN
			              ,CC.ORG_ID AS ORGID
			              ,CC.COMPANY_ID AS COMPANYID
			              ,TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월' AS SUBTITLE
			              ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_NEXT, 'MM') || '월' AS SUBTITLENEXT
			              ,CC.CUSTOMER_CODE AS CUSTOMERCODE
			              ,CC.CUSTOMER_NAME AS CUSTOMERNAME
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') AS VALUE1
			              ,CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'O') AS VALUE2
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') AS VALUE3
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') -
			               CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'O') AS VALUE4
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_NEXT
			                                                      ,'O') AS VALUE5
			          FROM CB_CUSTOMER CC
			              ,(SELECT #ORGID# AS ORG_ID
			                      ,#COMPANYID# AS COMPANY_ID
			                      ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
			                      ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
			                      ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			                  FROM DUAL) TMP
			         WHERE 1=1
			           AND CC.ORG_ID = TMP.ORG_ID
			           AND CC.COMPANY_ID = TMP.COMPANY_ID
			           AND CC.CUSTOMER_TYPE = 'O'
			           AND CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') > (SELECT SC.SMALL_NAME
			                                                                           FROM CB_SMALL_CODE SC
			                                                                          WHERE 1=1
			                                                                            AND SC.ORG_ID = CC.ORG_ID
			                                                                            AND SC.COMPANY_ID = CC.COMPANY_ID
			                                                                            AND SC.BIG_CODE = 'CMM'
			                                                                            AND SC.MIDDLE_CODE = 'STANDARD_AMOUNT'
			                                                                            AND SC.SMALL_CODE = 'O')
			         ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                   ,CC.COMPANY_ID
			                                                                                   ,CC.CUSTOMER_CODE
			                                                                                   ,TMP.SEARCH_TO
			                                                                                   ,'O') DESC, CC.CUSTOMER_NAME
			         )
			 WHERE 1=1
			   AND RN BETWEEN 1 AND 8
			 UNION ALL
			SELECT 999 AS RN
			      ,MAX(ORGID) AS ORGID
			      ,MAX(COMPANYID) AS COMPANYID
			      ,TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월' AS SUBTITLE
			      ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_NEXT, 'MM') || '월' AS SUBTITLENEXT
			      ,NULL AS CUSTOMERCODE
			      ,'외주기타' AS CUSTOMERNAME
			      ,NVL(SUM(VALUE1), 0) AS VALUE1
			      ,NVL(SUM(VALUE2), 0) AS VALUE2
			      ,NVL(SUM(VALUE3), 0) AS VALUE3
			      ,NVL(SUM(VALUE4), 0) AS VALUE4
			      ,NVL(SUM(VALUE5), 0) AS VALUE5
			  FROM (SELECT RANK() OVER(ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                                     ,CC.COMPANY_ID
			                                                                                                     ,CC.CUSTOMER_CODE
			                                                                                                     ,TMP.SEARCH_TO
			                                                                                                     ,'O') DESC, CC.CUSTOMER_NAME) AS RN
			              ,CC.ORG_ID AS ORGID
			              ,CC.COMPANY_ID AS COMPANYID
			              ,TO_CHAR(TMP.SEARCH_TO, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_TO, 'MM') || '월' AS SUBTITLE
			              ,TO_CHAR(TMP.SEARCH_NEXT, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_NEXT, 'MM') || '월' AS SUBTITLENEXT
			              ,CC.CUSTOMER_CODE AS CUSTOMERCODE
			              ,CC.CUSTOMER_NAME AS CUSTOMERNAME
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') AS VALUE1
			              ,CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'O') AS VALUE2
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') AS VALUE3
			              ,CB_COST_PKG.CB_REAL_PURCHASE_RESULT_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') -
			               CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                    ,CC.COMPANY_ID
			                                                    ,CC.CUSTOMER_CODE
			                                                    ,TMP.SEARCH_TO
			                                                    ,'O') AS VALUE4
			              ,CB_COST_PKG.CB_EXPECT_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_NEXT
			                                                      ,'O') AS VALUE5
			          FROM CB_CUSTOMER CC
			              ,(SELECT #ORGID# AS ORG_ID
			                      ,#COMPANYID# AS COMPANY_ID
			                      ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
			                      ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
			                      ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			                  FROM DUAL) TMP
			         WHERE 1=1
			           AND CC.ORG_ID = TMP.ORG_ID
			           AND CC.COMPANY_ID = TMP.COMPANY_ID
			           AND CC.CUSTOMER_TYPE = 'O'
			           AND CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                      ,CC.COMPANY_ID
			                                                      ,CC.CUSTOMER_CODE
			                                                      ,TMP.SEARCH_TO
			                                                      ,'O') < (SELECT SC.SMALL_NAME
			                                                                           FROM CB_SMALL_CODE SC
			                                                                          WHERE 1=1
			                                                                            AND SC.ORG_ID = CC.ORG_ID
			                                                                            AND SC.COMPANY_ID = CC.COMPANY_ID
			                                                                            AND SC.BIG_CODE = 'CMM'
			                                                                            AND SC.MIDDLE_CODE = 'STANDARD_AMOUNT'
			                                                                            AND SC.SMALL_CODE = 'O')
			         ORDER BY CC.ORG_ID, CC.COMPANY_ID, CB_COST_PKG.CB_REAL_PURCHASE_PLAN_FNC(CC.ORG_ID
			                                                                                   ,CC.COMPANY_ID
			                                                                                   ,CC.CUSTOMER_CODE
			                                                                                   ,TMP.SEARCH_TO
			                                                                                   ,'O') DESC, CC.CUSTOMER_NAME
			         )
			      ,(SELECT #ORGID# AS ORG_ID
			              ,#COMPANYID# AS COMPANY_ID
			              ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'MM') AS SEARCH_FROM
			              ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_TO
			              ,LAST_DAY(ADD_MONTHS(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 1)) AS SEARCH_NEXT
			          FROM DUAL) TMP
			 WHERE 1=1
      ]]>
    </select>
    
    <select id="report.work.workhistorylist.checksheet.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
			SELECT DECODE(TMP.RN
			             ,1, DENSE_RANK() OVER(ORDER BY FD.ORG_ID, FD.COMPANY_ID, FM.CHECK_BIG, FM.FML_ID
			                                           ,(SELECT RC.ROUTING_OP
			                                              FROM CB_ROUTING_CONTROL RC
			                                             WHERE RC.ORG_ID = CM.ORG_ID
			                                               AND RC.COMPANY_ID = CM.COMPANY_ID
			                                               AND RC.ROUTING_ID = CM.ROUTING_ID)
			                                           ,CM.ORDER_NO)
			             ,NULL) AS RN
			      ,(CASE
			          WHEN CM.STANDARD_VALUE IS NULL THEN
			            'Y'
			          ELSE
			            (CASE
			               WHEN TMP.RN = (DECODE(CM.INTERVAL_CNT, NULL, 10, 0, 10, CM.INTERVAL_CNT) + 2) THEN
			                 'Y'
			               WHEN FM.CHECK_BIG = 'H' THEN
			                 'Y'
			               ELSE
			                 'N'
			               END)
			          END) AS LASTYN
			      ,FD.ORG_ID AS ORGID
			      ,FD.COMPANY_ID AS COMPANYID
			      ,(SELECT CONCAT('D:' || CF.FILEPATHREAL, CF.FILENMREAL)
			          FROM CB_FILE CF
			              ,CB_ITEM_FILE CIF
			         WHERE 1=1
			           AND CF.FILEID = CIF.FILEID
			           AND CIF.ITEM_CODE = WO.ITEMCODE
			           AND CIF.FILETYPE = 'check'
			           AND CIF.GUBUN = 'Image3'
			           AND CIF.ROUTING_ID = WO.ROUTINGCODE) AS IMAGEPATH
			      ,FD.FML_ID AS FMLID
			      ,FD.ORDER_NO AS ORDERNO
			      ,FD.CHECK_LIST_ID AS CHECKLISTID
			      ,FD.WORK_ORDER_ID AS WORKORDERID
			      ,FD.WORK_ORDER_SEQ AS WORKORDERSEQ
			      ,IM.CAR_TYPE AS MODEL
			      ,IM.CAR_TYPE_NAME AS MODELNAME
			      ,(SELECT WOH.WORK_STATUS
			          FROM CB_WORK_ORDER_HEADER WOH
			              ,CB_WORK_ORDER WO
			         WHERE 1 = 1
			           AND WOH.ORG_ID = WO.ORG_ID
			           AND WOH.COMPANY_ID = WO.COMPANY_ID
			           AND WOH.WORK_ORDER_ID = WO.WORK_ORDER_ID
			           AND WO.ORG_ID = FD.ORG_ID
			           AND WO.COMPANY_ID = FD.COMPANY_ID
			           AND WO.WORK_ORDER_ID = FD.WORK_ORDER_ID
			           AND WO.WORK_ORDER_SEQ = FD.WORK_ORDER_SEQ) AS WORKSTATUS
			      ,FD.ITEM_CODE AS ITEMCODE
			      ,IM.ITEM_NAME AS ITEMNAME
			      ,IM.ORDER_NAME AS ORDERNAME
			      ,WO.ROUTINGCODE AS ROUTINGCODE
			      ,WO.ROUTINGNO AS ROUTINGNO
			      ,WO.ROUTINGNAME AS ROUTINGNAME
			      ,WO.ROUTINGOP AS ROUTINGOP
			      ,(SELECT (SELECT WC.WORK_CENTER_NAME
			                  FROM CB_WORK_CENTER WC
			                 WHERE 1 = 1
			                   AND WC.ORG_ID = WOD.ORG_ID
			                   AND WC.COMPANY_ID = WOD.COMPANY_ID
			                   AND WC.WORK_CENTER_CODE = WOD.WORK_CENTER_CODE)
			          FROM CB_WORK_ORDER_D WOD
			         WHERE 1 = 1
			           AND WOD.ORG_ID = FM.ORG_ID
			           AND WOD.COMPANY_ID = FM.COMPANY_ID
			           AND WOD.WORK_ORDER_ID = FM.WORK_ORDER_ID
			           AND WOD.WORK_ORDER_SEQ = FM.WORK_ORDER_SEQ
			              /*AND WOD.WORK_CENTER_CODE = EM.WORK_CENTER_CODE*/
			           AND WOD.SEQ_NO = FM.EMPLOYEE_SEQ) AS WORKCENTERNAME
			      ,NVL((SELECT WOD.QTY
			             FROM CB_WORK_ORDER_D WOD
			            WHERE 1 = 1
			              AND WOD.ORG_ID = FM.ORG_ID
			              AND WOD.COMPANY_ID = FM.COMPANY_ID
			              AND WOD.WORK_ORDER_ID = FM.WORK_ORDER_ID
			              AND WOD.WORK_ORDER_SEQ = FM.WORK_ORDER_SEQ
			                 /*AND WOD.WORK_CENTER_CODE = EM.WORK_CENTER_CODE*/
			              AND WOD.SEQ_NO = FM.EMPLOYEE_SEQ), 0) || 'EA' AS WORKORDERQTY
			      ,NVL((SELECT DECODE(WOD.WORK_DIV
			                        ,'01', TO_CHAR(WOD.START_TIME, 'YY.MM.DD')
			                        ,(CASE
			                            WHEN TO_DATE(TO_CHAR(WOD.START_TIME, 'HH24:MI'), 'HH24:MI') BETWEEN TO_DATE('17:00', 'HH24:MI') AND TO_DATE('23:59', 'HH24:MI') THEN
			                              TO_CHAR(FM.CHECK_DATE, 'YY.MM.DD')
			                            ELSE
			                              TO_CHAR(FM.CHECK_DATE - 1, 'YY.MM.DD')
			                            END)
			                          )
			              FROM CB_WORK_ORDER_D WOD
			             WHERE 1 = 1
			               AND WOD.ORG_ID = FM.ORG_ID
			               AND WOD.COMPANY_ID = FM.COMPANY_ID
			               AND WOD.WORK_ORDER_ID = FM.WORK_ORDER_ID
			               AND WOD.WORK_ORDER_SEQ = FM.WORK_ORDER_SEQ
			               AND WOD.SEQ_NO = FM.EMPLOYEE_SEQ), CHECK_DATE) AS CHECKDATE
			      ,FM.CHECK_BIG AS CHECKBIG
			      ,FM.FML_TYPE AS FMLTYPE
			      ,(SELECT SC.SMALL_NAME
			          FROM CB_SMALL_CODE SC
			         WHERE 1 = 1
			           AND SC.ORG_ID = FD.ORG_ID
			           AND SC.COMPANY_ID = FD.COMPANY_ID
			           AND SC.BIG_CODE = 'QM'
			           AND SC.MIDDLE_CODE = 'FML_DIVISION'
			           AND SC.SMALL_CODE = FM.FML_TYPE) AS FMLTYPENAME
			      ,CM.CHECK_MIDDLE AS CHECKMIDDLE
			      ,CM.CHECK_SMALL AS CHECKSMALL
			      ,DECODE(TMP.RN
			             ,1, (SELECT CS.SMALL_NAME
			                    FROM CB_CHECK_SMALL_CODE CS
			                   WHERE CS.ORG_ID = CM.ORG_ID
			                     AND CS.COMPANY_ID = CM.COMPANY_ID
			                     AND CS.BIG_CODE = CM.CHECK_BIG
			                     AND CS.MIDDLE_CODE = CM.CHECK_MIDDLE
			                     AND CS.SMALL_CODE = CM.CHECK_SMALL)
			             ,NULL) AS CHECKSMALLNAME
			      ,CM.SPECIAL_CHECK AS SPECIALCHECK
			      ,(SELECT SC.SMALL_NAME
			          FROM CB_SMALL_CODE SC
			         WHERE SC.ORG_ID = CM.ORG_ID
			           AND SC.COMPANY_ID = CM.COMPANY_ID
			           AND SC.BIG_CODE = 'QM'
			           AND SC.MIDDLE_CODE = 'SPECIAL_CHECK'
			           AND SC.SMALL_CODE = CM.SPECIAL_CHECK) AS SPECIALCHECKNAME
			      ,DECODE(TMP.RN, 1, CM.CHECK_STANDARD, NULL) AS CHECKSTANDARD
			      ,DECODE(TMP.RN, 1, CM.STANDARD_VALUE, NULL) AS STANDARDVALUE
			      ,CM.MAX_VALUE AS MAXVALUE
			      ,CM.MIN_VALUE AS MINVALUE
			      ,CM.CHECK_CYCLE AS CHECKCYCLE
			      ,DECODE(TMP.RN
			             ,1, (SELECT SC.SMALL_NAME
			                    FROM CB_SMALL_CODE SC
			                   WHERE SC.ORG_ID = CM.ORG_ID
			                     AND SC.COMPANY_ID = CM.COMPANY_ID
			                     AND SC.BIG_CODE = 'QM'
			                     AND SC.MIDDLE_CODE = 'CHECK_CYCLE'
			                     AND SC.SMALL_CODE = CM.CHECK_CYCLE)
			             ,NULL) AS CHECKCYCLENAME
			      ,DECODE(CM.CHECK_INTERVAL
			             ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			             ,CM.CHECK_INTERVAL) AS CHECKINTERVAL
			      ,DECODE(CM.INTERVAL_CNT, NULL, 10, 0, 10, CM.INTERVAL_CNT) AS INTERVALCNT
			      ,DECODE(FD.CHECK_QTY
			             ,NULL, CM.CHECK_QTY
			             ,0, CM.CHECK_QTY
			             ,FD.CHECK_QTY) AS CHECKQTY
			      ,CM.CHECK_METHOD_TYPE AS CHECKMETHODTYPE
			      ,DECODE(TMP.RN
			             ,1, (SELECT CC.SMALL_NAME
			                    FROM CB_SMALL_CODE CC
			                   WHERE CC.ORG_ID = CM.ORG_ID
			                     AND CC.COMPANY_ID = CM.COMPANY_ID
			                     AND CC.BIG_CODE = 'QM'
			                     AND CC.MIDDLE_CODE = 'CHECK_METHOD_TYPE'
			                     AND CC.SMALL_CODE = CM.CHECK_METHOD_TYPE)
			             ,NULL) AS CHECKMETHODTYPENAME
			      ,DECODE(FM.CHECK_BIG
			             ,'F', (CM.MAX_VALUE + DECODE(CM.CHECK_INTERVAL
			                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                         ,CM.CHECK_INTERVAL)
			                    ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                              ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                              ,CM.CHECK_INTERVAL)
			                         ), NULL) AS MANAGEAREA
			      ,DECODE(FM.CHECK_BIG
			             ,'F', (CASE
			                      WHEN TMP.RN = 1 THEN
			                        CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                                          ,FD.COMPANY_ID
			                                                          ,FD.WORK_ORDER_ID
			                                                          ,FD.WORK_ORDER_SEQ
			                                                          ,FM.EMPLOYEE_SEQ
			                                                          ,FM.CHECK_BIG
			                                                          ,FD.FML_ID
			                                                          ,FD.CHECK_LIST_ID
			                                                          ,1
			                                                          ,((CM.MAX_VALUE + DECODE(CM.CHECK_INTERVAL
			                                                                                  ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                                  ,CM.CHECK_INTERVAL)) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                                                                               ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                                                                               ,CM.CHECK_INTERVAL)
			                                                                                                          )
			                                                            )
			                                                          ,'MANAGER'
			                                                          ,'NUMBER')
			                      ELSE
			                        NULL
			                      END)
			             ,NULL) AS FIRSTCHECK
			      ,FD.CHECK_RESULT1 AS CHECKRESULT1
			      ,FD.CHECK_RESULT2 AS CHECKRESULT2
			      ,FD.CHECK_RESULT3 AS CHECKRESULT3
			      ,FD.CHECK_RESULT4 AS CHECKRESULT4
			      ,FD.CHECK_RESULT5 AS CHECKRESULT5
			      ,FD.CHECK_RESULT6 AS CHECKRESULT6
			      ,FD.CHECK_RESULT7 AS CHECKRESULT7
			      ,FD.CHECK_RESULT8 AS CHECKRESULT8
			      ,FD.CHECK_RESULT9 AS CHECKRESULT9
			      ,FD.CHECK_RESULT10 AS CHECKRESULT10
			      ,FD.CHECK_RESULT11 AS CHECKRESULT11
			      ,FD.CHECK_RESULT12 AS CHECKRESULT12
			      ,FD.CHECK_RESULT13 AS CHECKRESULT13
			      ,FD.CHECK_RESULT14 AS CHECKRESULT14
			      ,FD.CHECK_RESULT15 AS CHECKRESULT15
			      ,FD.CHECK_RESULT16 AS CHECKRESULT16
			      ,FD.CHECK_RESULT17 AS CHECKRESULT17
			      ,FD.CHECK_RESULT18 AS CHECKRESULT18
			      ,FD.CHECK_RESULT19 AS CHECKRESULT19
			      ,FD.CHECK_RESULT20 AS CHECKRESULT20
			      ,FD.CHECK_RESULT21 AS CHECKRESULT21
			      ,FD.CHECK_RESULT22 AS CHECKRESULT22
			      ,FD.CHECK_RESULT23 AS CHECKRESULT23
			      ,FD.CHECK_RESULT24 AS CHECKRESULT24
			      ,FD.CHECK_RESULT25 AS CHECKRESULT25
			      ,FD.CHECK_RESULT26 AS CHECKRESULT26
			      ,FD.CHECK_RESULT27 AS CHECKRESULT27
			      ,FD.CHECK_RESULT28 AS CHECKRESULT28
			      ,FD.CHECK_RESULT29 AS CHECKRESULT29
			      ,FD.CHECK_RESULT30 AS CHECKRESULT30
			      ,FD.CHECK_RESULT31 AS CHECKRESULT31
			      ,FD.CHECK_RESULT32 AS CHECKRESULT32
			      ,FD.CHECK_RESULT33 AS CHECKRESULT33
			      ,FD.CHECK_RESULT34 AS CHECKRESULT34
			      ,FD.CHECK_RESULT35 AS CHECKRESULT35
			      ,FD.CHECK_RESULT36 AS CHECKRESULT36
			      ,FD.CHECK_RESULT37 AS CHECKRESULT37
			      ,FD.CHECK_RESULT38 AS CHECKRESULT38
			      ,FD.CHECK_RESULT39 AS CHECKRESULT39
			      ,FD.CHECK_RESULT40 AS CHECKRESULT40
			      ,FD.CHECK_RESULT41 AS CHECKRESULT41
			      ,FD.CHECK_RESULT42 AS CHECKRESULT42
			      ,FD.CHECK_RESULT43 AS CHECKRESULT43
			      ,FD.CHECK_RESULT44 AS CHECKRESULT44
			      ,FD.CHECK_RESULT45 AS CHECKRESULT45
			      ,FD.CHECK_RESULT46 AS CHECKRESULT46
			      ,FD.CHECK_RESULT47 AS CHECKRESULT47
			      ,FD.CHECK_RESULT48 AS CHECKRESULT48
			      ,FD.CHECK_RESULT49 AS CHECKRESULT49
			      ,FD.CHECK_RESULT50 AS CHECKRESULT50
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,1
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK1
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,2
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK2
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,3
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK3
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,4
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK4
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,5
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK5
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,6
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK6
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,7
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK7
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,8
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK8
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,9
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK9
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,10
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK10
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,11
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK11
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,12
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK12
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,13
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK13
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,14
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK14
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,15
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK15
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,16
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK16
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,17
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK17
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,18
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK18
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,19
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK19
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,20
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK20
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,21
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK21
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,22
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK22
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,23
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK23
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,24
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK24
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,25
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK25
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,26
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK26
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,27
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK27
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,28
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK28
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,29
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK29
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,30
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK30
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,31
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK31
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,32
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK32
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,33
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK33
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,34
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK34
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,35
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK35
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,36
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK36
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,37
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK37
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,38
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK38
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,39
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK39
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,40
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK40
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,41
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK41
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,42
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK42
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,43
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK43
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,44
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK44
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,45
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK45
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,46
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK46
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,47
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK47
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,48
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK48
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,49
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK49
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,50
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'WORKER'
			                                         ,'CHECK') AS CHK50
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,1
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK1
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,2
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK2
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,3
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK3
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,4
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK4
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,5
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK5
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,6
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK6
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,7
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK7
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,8
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK8
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,9
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK9
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,10
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK10
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,11
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK11
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,12
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK12
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,13
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK13
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,14
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK14
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,15
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK15
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,16
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK16
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,17
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK17
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,18
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK18
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,19
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK19
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,20
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK20
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,21
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK21
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,22
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK22
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,23
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK23
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,24
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK24
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,25
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK25
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,26
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK26
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,27
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK27
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,28
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK28
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,29
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK29
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,30
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK30
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,31
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK31
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,32
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK32
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,33
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK33
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,34
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK34
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,35
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK35
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,36
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK36
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,37
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK37
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,38
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK38
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,39
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK39
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,40
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK40
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,41
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK41
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,42
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK42
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,43
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK43
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,44
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK44
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,45
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK45
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,46
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK46
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,47
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK47
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,48
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK48
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,49
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK49
			      ,CB_REPORT_PKG.CB_FML_CHECK_YN_FIND(FD.ORG_ID
			                                         ,FD.COMPANY_ID
			                                         ,FD.WORK_ORDER_ID
			                                         ,FD.WORK_ORDER_SEQ
			                                         ,FM.EMPLOYEE_SEQ
			                                         ,FM.CHECK_BIG
			                                         ,FD.FML_ID
			                                         ,FD.CHECK_LIST_ID
			                                         ,50
			                                         ,((NVL(CM.MAX_VALUE, 0) + DECODE(CM.CHECK_INTERVAL
			                                                                         ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                         ,CM.CHECK_INTERVAL)
			                                            ) - ((TMP.RN - 1) * DECODE(CM.CHECK_INTERVAL
			                                                                      ,NULL, ((NVL(CM.MAX_VALUE, 0) - NVL(CM.MIN_VALUE, 0)) / 10)
			                                                                      ,CM.CHECK_INTERVAL)
			                                                 )
			                                           )
			                                         ,'MANAGER'
			                                         ,'CHECK') AS MCHK50
			      ,FD.CHECK_YN AS CHECKYN
			      ,(SELECT SC.SMALL_NAME
			          FROM CB_SMALL_CODE SC
			         WHERE 1 = 1
			           AND SC.ORG_ID = IM.ORG_ID
			           AND SC.COMPANY_ID = IM.COMPANY_ID
			           AND SC.BIG_CODE = 'QM'
			           AND SC.MIDDLE_CODE = 'CHECK_YN'
			           AND SC.SMALL_CODE = FD.CHECK_YN) AS CHECKYNNAME
			      ,FM.PERSON_ID AS PERSONID
			      ,NVL((SELECT (SELECT SUBSTR(SC.SMALL_NAME, 1, 1)
			                      FROM CB_SMALL_CODE SC
			                     WHERE 1 = 1
			                       AND SC.ORG_ID = WOD.ORG_ID
			                       AND SC.COMPANY_ID = WOD.COMPANY_ID
			                       AND SC.BIG_CODE = 'MFG'
			                       AND SC.MIDDLE_CODE = 'WORK_DIV'
			                       AND SC.SMALL_CODE = WOD.WORK_DIV) || ' : '
			              FROM CB_WORK_ORDER_D WOD
			             WHERE 1 = 1
			               AND WOD.ORG_ID = FM.ORG_ID
			               AND WOD.COMPANY_ID = FM.COMPANY_ID
			               AND WOD.WORK_ORDER_ID = FM.WORK_ORDER_ID
			               AND WOD.WORK_ORDER_SEQ = FM.WORK_ORDER_SEQ
			               AND WOD.SEQ_NO = FM.EMPLOYEE_SEQ)
			          ,NULL) || (SELECT HM.KR_NAME
			                       FROM CB_HUMANRESOURCE_MANAGER_V HM
			                      WHERE 1 = 1
			                        AND HM.ORG_ID = FM.ORG_ID
			                        AND HM.COMPANY_ID = FM.COMPANY_ID
			                        AND HM.EMPLOYEE_NUMBER = FM.PERSON_ID) AS KRNAME
			      ,FD.CHECK_RESULT_M AS CHECKRESULTM
			      ,FD.MANAGE_EMPLOYEE AS MANAGEEMPLOYEE
			      ,(SELECT HM.KR_NAME
			          FROM CB_HUMANRESOURCE_MANAGER_V HM
			         WHERE 1 = 1
			           AND HM.ORG_ID = FD.ORG_ID
			           AND HM.COMPANY_ID = FD.COMPANY_ID
			           AND HM.EMPLOYEE_NUMBER = FD.MANAGE_EMPLOYEE) AS MANAGEKRNAME
			      ,FM.CHECK_START_TIME AS STARTTIME
			      ,FM.BP_YN AS BPYN
			      ,DECODE(#CHECKCOUNT#, '0', '1', #CHECKCOUNT#) AS CHECKCOUNT
			      ,FM.EMPLOYEE_SEQ AS EMPLOYEESEQ
			      ,#ORGIMAGE# AS ORGIMAGE
			  FROM CB_FML_CHECK_MASTER FM
			      ,CB_FML_CHECK_RESULT FD
			      ,CB_ITEM_MASTER_V IM
			      ,CB_CHECK_MASTER CM
			      ,CB_EQUIPMENT_MASTER EM
			      ,CB_WORK_ORDER_LIST_V WO
			      ,(SELECT LEVEL AS RN FROM DUAL CONNECT BY LEVEL <= 30) TMP
			 WHERE 1 = 1
			   AND FM.ORG_ID = FD.ORG_ID
			   AND FM.COMPANY_ID = FD.COMPANY_ID
			   AND FM.FML_ID = FD.FML_ID
			   AND FM.WORK_ORDER_ID = FD.WORK_ORDER_ID
			   AND FM.WORK_ORDER_SEQ = FD.WORK_ORDER_SEQ
			   AND FD.ORG_ID = IM.ORG_ID
			   AND FD.COMPANY_ID = IM.COMPANY_ID
			   AND FD.ITEM_CODE = IM.ITEM_CODE
			   AND FD.ORG_ID = CM.ORG_ID
			   AND FD.COMPANY_ID = CM.COMPANY_ID
			   AND FD.ITEM_CODE = CM.ITEM_CODE
			   AND FD.CHECK_LIST_ID = CM.CHECK_SEQ
			   AND FM.ORG_ID = WO.ORGID
			   AND FM.COMPANY_ID = WO.COMPANYID
			   AND FM.WORK_ORDER_ID = WO.WORKORDERID
			   AND FM.WORK_ORDER_SEQ = WO.WORKORDERSEQ
			   AND FM.EQUIPMENT_CODE = WO.EQUIPMENTCODE
			   AND FM.ORG_ID = EM.ORG_ID
			   AND FM.COMPANY_ID = EM.COMPANY_ID
			   AND FM.EQUIPMENT_CODE = EM.EQUIPMENT_CODE
			   AND TMP.RN <= DECODE(CM.STANDARD_VALUE
			                       ,NULL, 1
			                       ,DECODE(FM.CHECK_BIG
			                              ,'F', (DECODE(CM.INTERVAL_CNT, NULL, 10, 0, 10, CM.INTERVAL_CNT) + 2)
			                              ,(DECODE(CM.INTERVAL_CNT, NULL, 10, 0, 10, CM.INTERVAL_CNT) + 0))
			                        )
			   AND FD.ORG_ID = #ORGID#
			   AND FD.COMPANY_ID = #COMPANYID#
			   AND FD.WORK_ORDER_ID = #WORKORDERID#
			   AND FD.WORK_ORDER_SEQ = #WORKORDERSEQ#
			   AND FM.EMPLOYEE_SEQ = #EMPLOYEESEQ#
			   AND DECODE(FM.CHECK_BIG, 'F', 'Y', DECODE(CM.CHECK_BIG, 'F', 'N', 'Y')) = 'Y'
			 ORDER BY FD.ORG_ID, FD.COMPANY_ID, FM.CHECK_BIG, FM.FML_ID
			         ,(SELECT RC.ROUTING_OP
			             FROM CB_ROUTING_CONTROL RC
			            WHERE RC.ORG_ID = CM.ORG_ID
			              AND RC.COMPANY_ID = CM.COMPANY_ID
			              AND RC.ROUTING_ID = CM.ROUTING_ID)
			         ,CM.ORDER_NO, TMP.RN
      ]]>
    </select>
    
    <select id="report.prod.stock.amount.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT #ORGID# AS ORGID
					    ,#COMPANYID# AS COMPANYID
					    ,TO_CHAR(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY') AS SEARCHYEAR
		   FROM DUAL
    </select>
    
    <select id="report.prod.stock.amount.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT NVL(RN, 999) AS RN
			      ,NVL(SUBTITLE, '합계') AS SUBTITLE
			      ,SUBSTR(YYYYMM, -2) AS YYYYMM
			      ,ORGID
			      ,COMPANYID
			      ,SUM(AMOUNT) AS AMOUNT
			  FROM (
			        SELECT RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE, CONCAT(TMP.SEARCH_YEAR, '-' || TMP.SEARCH_MONTH) ) AS RN
			              ,SC.SMALL_NAME AS SUBTITLE
			              ,CONCAT(TMP.SEARCH_YEAR, '-' || TMP.SEARCH_MONTH) AS YYYYMM
			              ,TMP.ORG_ID AS ORGID
			              ,TMP.COMPANY_ID AS COMPANYID
			              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
			                                             ,TMP.COMPANY_ID
			                                             ,CONCAT(TMP.SEARCH_YEAR, '-' || TMP.SEARCH_MONTH)
			                                             ,SC.SMALL_CODE
			                                              ) AS AMOUNT
			          FROM CB_SMALL_CODE SC
			              ,(SELECT #ORGID# AS ORG_ID
			                      ,#COMPANYID# AS COMPANY_ID
			                      ,TO_CHAR(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY') AS SEARCH_YEAR
			                      ,LPAD(LEVEL, 2, '0') AS SEARCH_MONTH
			                  FROM DUAL
			                CONNECT BY LEVEL <= 12) TMP
			         WHERE 1=1
			           AND SC.ORG_ID = TMP.ORG_ID
			           AND SC.COMPANY_ID = TMP.COMPANY_ID
			           AND SC.BIG_CODE = 'MFG'
			           AND SC.MIDDLE_CODE = 'INVENTORY_DIV'
			           AND SC.USE_YN = 'Y'
			        ) GA
			 WHERE 1=1
			 GROUP BY ORGID, COMPANYID, ROLLUP(YYYYMM, RN, SUBTITLE)
			 HAVING ((GROUPING_ID(RN, SUBTITLE) = 3 AND GROUPING(YYYYMM) = 0) OR (GROUPING(RN) = 0 AND SUBTITLE IS NOT NULL))
			 ORDER BY ORGID, COMPANYID, RN, SUBTITLE, YYYYMM
      ]]>
    </select>
    
    <select id="report.prod.stock.amount.sub2.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT NVL(RN, 999) AS RN
      ,NVL(SUBTITLE, '합계') AS SUBTITLE
      ,ORGID
      ,COMPANYID
      ,SUM(AMOUNT01) AS AMOUNT01
      ,SUM(AMOUNT02) AS AMOUNT02
      ,SUM(AMOUNT03) AS AMOUNT03
      ,SUM(AMOUNT04) AS AMOUNT04
      ,SUM(AMOUNT05) AS AMOUNT05
      ,SUM(AMOUNT06) AS AMOUNT06
      ,SUM(AMOUNT07) AS AMOUNT07
      ,SUM(AMOUNT08) AS AMOUNT08
      ,SUM(AMOUNT09) AS AMOUNT09
      ,SUM(AMOUNT10) AS AMOUNT10
      ,SUM(AMOUNT11) AS AMOUNT11
      ,SUM(AMOUNT12) AS AMOUNT12
  FROM (
        SELECT RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE) AS RN
	              ,SC.SMALL_NAME AS SUBTITLE
	              ,TMP.ORG_ID AS ORGID
	              ,TMP.COMPANY_ID AS COMPANYID
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                 ,TMP.COMPANY_ID
	                                                 ,CONCAT(TMP.SEARCH_YEAR, '-' || '01')
	                                                 ,SC.SMALL_CODE
	                                                  ) AS AMOUNT01
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '02')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT02
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '03')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT03
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '04')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT04
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '05')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT05
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '06')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT06
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '07')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT07
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '08')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT08
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '09')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT09
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '10')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT10
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '11')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT11
	              ,CB_REPORT_PKG.CB_STOCK_AMOUNT_FIND(TMP.ORG_ID
	                                                  ,TMP.COMPANY_ID
	                                                  ,CONCAT(TMP.SEARCH_YEAR, '-' || '12')
	                                                  ,SC.SMALL_CODE
	                                                   ) AS AMOUNT12
	          FROM CB_SMALL_CODE SC
	              ,(SELECT #ORGID# AS ORG_ID
	                      ,#COMPANYID# AS COMPANY_ID
	                      ,TO_CHAR(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY') AS SEARCH_YEAR
	                  FROM DUAL) TMP
	         WHERE 1=1
	           AND SC.ORG_ID = TMP.ORG_ID
	           AND SC.COMPANY_ID = TMP.COMPANY_ID
	           AND SC.BIG_CODE = 'MFG'
	           AND SC.MIDDLE_CODE = 'INVENTORY_DIV'
	           AND SC.USE_YN = 'Y'
	        ) GA
	 WHERE 1=1
	 GROUP BY ORGID, COMPANYID, ROLLUP(RN, SUBTITLE)
	 HAVING (GROUPING_ID(RN, SUBTITLE) = 3 OR (GROUPING(RN) = 0 AND SUBTITLE IS NOT NULL))
      ]]>
    </select>
    
    <!-- 일자 -> 년월 변환 시작 -->
    <sql id="report.prod.stock.amount.month.find.sql-select">
        SELECT TO_CHAR(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY-MM') AS SEARCHMONTH
          FROM DUAL
    </sql>

    <sql id="report.prod.stock.amount.month.find.sql-where">
         WHERE 1 = 1
    </sql>

    <select id="report.prod.stock.amount.month.find.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
        <include refid="report.prod.stock.amount.month.find.sql-select" />
        <include refid="report.prod.stock.amount.month.find.sql-where" />
    </select>
    <!-- 일자 -> 년월 변환  종료 -->
    
    <select id="report.prod.insp.fault.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
     SELECT TMP.ORG_ID AS ORGID
           ,(SELECT CO.ORG_NAME
               FROM CB_ORG CO
              WHERE 1=1
                AND CO.ORG_ID = TMP.ORG_ID) AS ORGNAME
           ,TMP.COMPANY_ID AS COMPANYID
           ,CONCAT(TO_CHAR(TMP.SEARCH_DATE1, 'YYYY'), '년 ') || CONCAT(TO_CHAR(TMP.SEARCH_DATE1, 'MM'), '월 불량 유형 현황') AS TITLE
           ,CONCAT(TO_CHAR(SYSDATE, 'YYYY'), '년 ') || CONCAT(TO_CHAR(SYSDATE, 'MM'), '월 ') || CONCAT(TO_CHAR(SYSDATE, 'DD'), '일') AS SEARCHDATE
           ,'불량수량' AS FAULTTYPENAME
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,1) AS FAULT01
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,2) AS FAULT02
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,3) AS FAULT03
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,4) AS FAULT04
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,5) AS FAULT05
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,6) AS FAULT06
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,7) AS FAULT07
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,8) AS FAULT08
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,9) AS FAULT09
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,10) AS FAULT10
           ,DECODE(CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                                                         ,TMP.COMPANY_ID
                                                                                         ,'MFG'
                                                                                         ,'FAULT_TYPE'
                                                                                         ,11
                                                                                         ), NULL, '', CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                                                                                                                                    ,TMP.COMPANY_ID
                                                                                                                                                    ,TMP.SEARCH_DATE
                                                                                                                                                    ,11)) AS FAULT11
           ,DECODE(CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                                                         ,TMP.COMPANY_ID
                                                                                         ,'MFG'
                                                                                         ,'FAULT_TYPE'
                                                                                         ,12
                                                                                         ), NULL, '', CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                                                                                                                                    ,TMP.COMPANY_ID
                                                                                                                                                    ,TMP.SEARCH_DATE
                                                                                                                                                    ,12)) AS FAULT12
           ,DECODE(CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                                                         ,TMP.COMPANY_ID
                                                                                         ,'MFG'
                                                                                         ,'FAULT_TYPE'
                                                                                         ,13
                                                                                         ), NULL, '', CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                                                                                                                                    ,TMP.COMPANY_ID
                                                                                                                                                    ,TMP.SEARCH_DATE
                                                                                                                                                    ,13)) AS FAULT13
           ,DECODE(CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                                                         ,TMP.COMPANY_ID
                                                                                         ,'MFG'
                                                                                         ,'FAULT_TYPE'
                                                                                         ,14
                                                                                         ), NULL, '', CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                                                                                                                                    ,TMP.COMPANY_ID
                                                                                                                                                    ,TMP.SEARCH_DATE
                                                                                                                                                    ,14)) AS FAULT14
           ,DECODE(CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                                                         ,TMP.COMPANY_ID
                                                                                         ,'MFG'
                                                                                         ,'FAULT_TYPE'
                                                                                         ,15
                                                                                         ), NULL, '', CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                                                                                                                                    ,TMP.COMPANY_ID
                                                                                                                                                    ,TMP.SEARCH_DATE
                                                                                                                                                    ,15)) AS FAULT15
           ,DECODE(CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                                                         ,TMP.COMPANY_ID
                                                                                         ,'MFG'
                                                                                         ,'FAULT_TYPE'
                                                                                         ,16
                                                                                         ), NULL, '', CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                                                                                                                                    ,TMP.COMPANY_ID
                                                                                                                                                    ,TMP.SEARCH_DATE
                                                                                                                                                    ,16)) AS FAULT16
           ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(TMP.ORG_ID
                                            ,TMP.COMPANY_ID
                                            ,TMP.SEARCH_DATE
                                            ,NULL) AS FAULTTOTAL
                                            
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,1
                                                     ) AS FAULTNAME01
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,2
                                                     ) AS FAULTNAME02
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,3
                                                     ) AS FAULTNAME03
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,4
                                                     ) AS FAULTNAME04
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,5
                                                     ) AS FAULTNAME05
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,6
                                                     ) AS FAULTNAME06
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,7
                                                     ) AS FAULTNAME07
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,8
                                                     ) AS FAULTNAME08
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,9
                                                     ) AS FAULTNAME09
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,10
                                                     ) AS FAULTNAME10
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,11
                                                     ) AS FAULTNAME11
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,12
                                                     ) AS FAULTNAME12
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,13
                                                     ) AS FAULTNAME13
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,14
                                                     ) AS FAULTNAME14
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,15
                                                     ) AS FAULTNAME15
           ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
                                                     ,TMP.COMPANY_ID
                                                     ,'MFG'
                                                     ,'FAULT_TYPE'
                                                     ,16
                                                     ) AS FAULTNAME16
     FROM (SELECT #ORGID# AS ORG_ID
                 ,#COMPANYID# AS COMPANY_ID
                 ,TO_DATE(#SEARCHDATE#, 'YYYY-MM') AS SEARCH_DATE1
                 ,#SEARCHDATE# AS SEARCH_DATE
             FROM DUAL) TMP
    </select>
    
    <select id="report.prod.insp.fault.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE) AS RN
				      ,SC.ORG_ID AS ORGID
				      ,SC.COMPANY_ID AS COMPANYID
				      ,TMP.SEARCH_DATE AS SEARCHDATE
				      ,SC.SMALL_CODE AS FAULTTYPE
				      ,SC.SMALL_NAME AS FAULTTYPENAME
				      ,CB_REPORT_PKG.CB_FAULT_TYPE_FIND(SC.ORG_ID
				                                       ,SC.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE)) AS FAULTQTY
		  FROM CB_SMALL_CODE SC
		      ,(SELECT #ORGID# AS ORG_ID
                  ,#COMPANYID# AS COMPANY_ID
                  ,#SEARCHDATE# AS SEARCH_DATE
		          FROM DUAL) TMP
		 WHERE 1=1
		   AND SC.ORG_ID = TMP.ORG_ID
		   AND SC.COMPANY_ID = TMP.COMPANY_ID
		   AND SC.BIG_CODE = 'MFG'
		   AND SC.MIDDLE_CODE = 'FAULT_TYPE'
		   AND SC.USE_YN = 'Y'
		 ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE
      ]]>
    </select>
    
    <select id="report.prod.insp.routing.group.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT TMP.ORG_ID AS ORGID
				      ,(SELECT CO.ORG_NAME
				          FROM CB_ORG CO
				         WHERE 1=1
				           AND CO.ORG_ID = TMP.ORG_ID) AS ORGNAME
				      ,TMP.COMPANY_ID AS COMPANYID
				      ,CONCAT(TO_CHAR(TMP.SEARCH_DATE1, 'YYYY'), '년 ') || CONCAT(TO_CHAR(TMP.SEARCH_DATE1, 'MM'), '월 공정 유형 현황') AS TITLE
				      ,CONCAT(TO_CHAR(SYSDATE, 'YYYY'), '년 ') || CONCAT(TO_CHAR(SYSDATE, 'MM'), '월 ') || CONCAT(TO_CHAR(SYSDATE, 'DD'), '일') AS SEARCHDATE
				      ,'불량수량' AS FAULTTYPENAME
				      ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(TMP.ORG_ID
				                                       ,TMP.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,1) AS FAULT01
				      ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(TMP.ORG_ID
				                                       ,TMP.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,2) AS FAULT02
				      ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(TMP.ORG_ID
				                                       ,TMP.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,3) AS FAULT03
				      ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(TMP.ORG_ID
				                                       ,TMP.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,4) AS FAULT04
				      ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(TMP.ORG_ID
				                                       ,TMP.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,5) AS FAULT05
				      ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(TMP.ORG_ID
				                                       ,TMP.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,6) AS FAULT06
				      ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(TMP.ORG_ID
				                                       ,TMP.COMPANY_ID
				                                       ,TMP.SEARCH_DATE
				                                       ,NULL) AS FAULTTOTAL
				      ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
				                                                ,TMP.COMPANY_ID
				                                                ,'MFG'
				                                                ,'ROUTING_GROUP'
				                                                ,1
				                                                ) AS FAULTNAME01
				      ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
				                                                ,TMP.COMPANY_ID
				                                                ,'MFG'
				                                                ,'ROUTING_GROUP'
				                                                ,2
				                                                ) AS FAULTNAME02
				      ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
				                                                ,TMP.COMPANY_ID
				                                                ,'MFG'
				                                                ,'ROUTING_GROUP'
				                                                ,3
				                                                ) AS FAULTNAME03
				      ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
				                                                ,TMP.COMPANY_ID
				                                                ,'MFG'
				                                                ,'ROUTING_GROUP'
				                                                ,4
				                                                ) AS FAULTNAME04
				      ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
				                                                ,TMP.COMPANY_ID
				                                                ,'MFG'
				                                                ,'ROUTING_GROUP'
				                                                ,5
				                                                ) AS FAULTNAME05
				      ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME(TMP.ORG_ID
				                                                ,TMP.COMPANY_ID
				                                                ,'MFG'
				                                                ,'ROUTING_GROUP'
				                                                ,6
				                                                ) AS FAULTNAME06
      FROM (SELECT #ORGID# AS ORG_ID
                  ,#COMPANYID# AS COMPANY_ID
                  ,TO_DATE(#SEARCHDATE#, 'YYYY-MM') AS SEARCH_DATE1
                  ,#SEARCHDATE# AS SEARCH_DATE
              FROM DUAL) TMP
    </select>
    
    <select id="report.prod.insp.routing.group.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE) AS RN
              ,SC.ORG_ID AS ORGID
              ,SC.COMPANY_ID AS COMPANYID
              ,TMP.SEARCH_DATE AS SEARCHDATE
              ,SC.SMALL_CODE AS ROUTINGGROUP
              ,SC.SMALL_NAME AS ROUTINGGROUPNAME
              ,CB_REPORT_PKG.CB_ROUTING_GROUP_FIND(SC.ORG_ID
                                                  ,SC.COMPANY_ID
                                                  ,TMP.SEARCH_DATE
                                                  ,RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE)) AS QTY
      FROM CB_SMALL_CODE SC
          ,(SELECT #ORGID# AS ORG_ID
                  ,#COMPANYID# AS COMPANY_ID
                  ,#SEARCHDATE# AS SEARCH_DATE
              FROM DUAL) TMP
     WHERE 1=1
       AND SC.ORG_ID = TMP.ORG_ID
       AND SC.COMPANY_ID = TMP.COMPANY_ID
       AND SC.BIG_CODE = 'MFG'
       AND SC.MIDDLE_CODE = 'ROUTING_GROUP'
       AND SC.USE_YN = 'Y'
     ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE
      ]]>
    </select>
    
    
    <select id="report.prod.sheet.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT TMP.ORG_ID AS ORGID
					      ,TMP.COMPANY_ID AS COMPANYID
					      ,TMP.SEARCH_YEAR || '년도 생산 집계표 (합산)' AS TITLE
					      ,'(공급가액 기준, 단위: 천원)' AS SUBTITLE
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 0) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 0))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 0) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES01
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 1) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 1))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 1) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES02
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 2) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 2))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 2) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES03
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 3) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 3))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 3) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES04
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 4) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 4))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 4) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES05
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 5) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 5))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 5) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES06
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 6) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 6))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 6) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES07
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 7) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 7))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 7) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES08
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 8) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 8))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 8) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES09
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 9) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 9))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 9) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES10
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 10) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 10))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 10) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES11
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 11) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 11))
					                                                WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 11) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                  TMP.SEARCH_DATE
					                                                ELSE
					                                                  NULL
					                                                END)
					                                         ,NULL
					                                         ,'MONTH_TOTAL'
					                                          ) AS SALES12
					      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                         ,TMP.COMPANY_ID
					                                         ,TMP.SEARCH_DATE
					                                         ,NULL
					                                         ,'TOTAL'
					                                          ) AS SALESTOTAL
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 0) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 0))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 0) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE01
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 1) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 1))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 1) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE02
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 2) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 2))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 2) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE03
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 3) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 3))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 3) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE04
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 4) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 4))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 4) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE05
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 5) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 5))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 5) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE06
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 6) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 6))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 6) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE07
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 7) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 7))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 7) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE08
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 8) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 8))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 8) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE09
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 9) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 9))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 9) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE10
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 10) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 10))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 10) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE11
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,(CASE WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 11) < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     LAST_DAY(ADD_MONTHS(SEARCH_YEAR_DATE, 11))
					                                                   WHEN ADD_MONTHS(SEARCH_YEAR_DATE, 11) = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                     TMP.SEARCH_DATE
					                                                   ELSE
					                                                     NULL
					                                                   END)
					                                            ,NULL
					                                            ,'MONTH_TOTAL'
					                                             ) AS PURCHASE12
					      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                            ,TMP.COMPANY_ID
					                                            ,TMP.SEARCH_DATE
					                                            ,NULL
					                                            ,'TOTAL'
					                                             ) AS PURCHASETOTAL
			  FROM (SELECT #ORGID# AS ORG_ID
						              ,#COMPANYID# AS COMPANY_ID
						              ,TO_CHAR(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY') AS SEARCH_YEAR
						              ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY') AS SEARCH_YEAR_DATE
						              ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_DATE
			            FROM DUAL) TMP
			 WHERE 1=1
      ]]>
    </select>
    
    <select id="report.prod.sheet.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT SC.ORG_ID AS ORGID
				      ,SC.COMPANY_ID AS COMPANYID
				      ,SC.SMALL_CODE AS ITEMTYPE
				      ,SC.SMALL_NAME AS ITEMTYPPENAME
				      ,TO_CHAR(TMP.SEARCH_MONTH, 'MM') || '월' AS SEARCHMONTH
				      ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
				                                         ,TMP.COMPANY_ID
				                                         ,(CASE WHEN TMP.SEARCH_MONTH < TRUNC(TMP.SEARCH_NOW, 'MM') THEN
				                                                  TMP.SEARCH_MONTH_LAST
				                                                WHEN TMP.SEARCH_MONTH = TRUNC(TMP.SEARCH_NOW, 'MM') THEN
				                                                  TMP.SEARCH_NOW
				                                                ELSE
				                                                  NULL
				                                                END)
				                                         ,SC.SMALL_CODE
				                                         ,NULL
				                                          ) AS AMOUNT
			  FROM CB_SMALL_CODE SC
					      ,(SELECT #ORGID# AS ORG_ID
						              ,#COMPANYID# AS COMPANY_ID
						              ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY') AS SEARCH_FIRST
						              ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_NOW
						              ,ADD_MONTHS(TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY'), LEVEL - 1) AS SEARCH_MONTH
						              ,LAST_DAY(ADD_MONTHS(TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY'), LEVEL - 1)) AS SEARCH_MONTH_LAST
					          FROM DUAL
					       CONNECT BY LEVEL <= 12) TMP
			 WHERE 1=1
			   AND SC.ORG_ID = TMP.ORG_ID
			   AND SC.COMPANY_ID = TMP.COMPANY_ID
			   AND SC.BIG_CODE = 'CMM'
			   AND SC.MIDDLE_CODE = 'ITEM_TYPE'
			   AND SC.USE_YN = 'Y'
			   AND SC.REMARKS IN ('A', 'Z')
			 ORDER BY SC.ORG_ID, SC.COMPANY_ID, TMP.SEARCH_MONTH, (CASE WHEN SC.SMALL_NAME = '기타' THEN
																	                                                              'ZZZ'
																	                                                            ELSE
																	                                                              SC.SMALL_CODE
																	                                                            END)
      ]]>
    </select>
    
    <select id="report.prod.sheet.sub2.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT SC.ORG_ID AS ORGID
				      ,SC.COMPANY_ID AS COMPANYID
				      ,SC.SMALL_CODE AS ITEMTYPE
				      ,SC.SMALL_NAME AS ITEMTYPPENAME
				      ,TO_CHAR(TMP.SEARCH_MONTH, 'MM') || '월' AS SEARCHMONTH
				      ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
				                                            ,TMP.COMPANY_ID
				                                            ,(CASE WHEN TMP.SEARCH_MONTH < TRUNC(TMP.SEARCH_NOW, 'MM') THEN
				                                                     TMP.SEARCH_MONTH_LAST
				                                                   WHEN TMP.SEARCH_MONTH = TRUNC(TMP.SEARCH_NOW, 'MM') THEN
				                                                     TMP.SEARCH_NOW
				                                                   ELSE
				                                                     NULL
				                                                   END)
				                                            ,SC.SMALL_CODE
				                                            ,NULL
				                                             ) AS AMOUNT
			  FROM CB_SMALL_CODE SC
					      ,(SELECT #ORGID# AS ORG_ID
						              ,#COMPANYID# AS COMPANY_ID
						              ,TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY') AS SEARCH_FIRST
						              ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_NOW
						              ,ADD_MONTHS(TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY'), LEVEL - 1) AS SEARCH_MONTH
						              ,LAST_DAY(ADD_MONTHS(TRUNC(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY'), LEVEL - 1)) AS SEARCH_MONTH_LAST
					          FROM DUAL
					       CONNECT BY LEVEL <= 12) TMP
			 WHERE 1=1
			   AND SC.ORG_ID = TMP.ORG_ID
			   AND SC.COMPANY_ID = TMP.COMPANY_ID
			   AND SC.BIG_CODE = 'CMM'
			   AND SC.MIDDLE_CODE = 'ITEM_TYPE'
			   AND SC.USE_YN = 'Y'
			   AND SC.REMARKS IN ('M', 'Z', 'T')
			 ORDER BY SC.ORG_ID, SC.COMPANY_ID, TMP.SEARCH_MONTH, (CASE WHEN SC.SMALL_NAME = '기타' THEN
																                                                              'ZZZ'
																                                                            ELSE
																                                                              SC.SMALL_CODE
																                                                            END)
      ]]>
    </select>
    
    <select id="report.prod.sheet.sub3.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT RANK() OVER(ORDER BY A.ORGID, A.COMPANYID, (CASE WHEN A.ITEMTYPENAME = '기타' THEN
															                                                          'ZZZ'
															                                                        ELSE
															                                                          A.ITEMTYPE
															                                                        END)) AS RN
					      ,A.ORGID
					      ,A.COMPANYID
					      ,A.ITEMTYPE
					      ,A.ITEMTYPENAME
					      ,A.MONTH01
					      ,A.MONTH02
					      ,A.MONTH03
					      ,A.MONTH04
					      ,A.MONTH05
					      ,A.MONTH06
					      ,A.MONTH07
					      ,A.MONTH08
					      ,A.MONTH09
					      ,A.MONTH10
					      ,A.MONTH11
					      ,A.MONTH12
					      ,A.MONTHTOTAL
			  FROM (
			        SELECT RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE) AS RN
					              ,SC.ORG_ID AS ORGID
					              ,SC.COMPANY_ID AS COMPANYID
					              ,SC.SMALL_CODE AS ITEMTYPE
					              ,SC.SMALL_NAME AS ITEMTYPENAME
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '01'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '01'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '01'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH01
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '02'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '02'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '02'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH02
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '03'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '03'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '03'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH03
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '04'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '04'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '04'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH04
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '05'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '05'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '05'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH05
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '06'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '06'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '06'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH06
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '07'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '07'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '07'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH07
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '08'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '08'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '08'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH08
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '09'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '09'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '09'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH09
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '10'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '10'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '10'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH10
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '11'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '11'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '11'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH11
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '12'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '12'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '12'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH12
					              ,CB_REPORT_PKG.CB_SALES_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,TMP.SEARCH_DATE
					                                                 ,SC.SMALL_CODE
					                                                 ,'TYPE_TOTAL'
					                                                  ) AS MONTHTOTAL
			          FROM CB_SMALL_CODE SC
					              ,(SELECT #ORGID# AS ORG_ID
					                      ,#COMPANYID# AS COMPANY_ID
					                      ,CONCAT(TO_CHAR(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY'), '-') AS SEARCH_YEAR
					                      ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_DATE
					                  FROM DUAL) TMP
			         WHERE 1=1
			           AND SC.ORG_ID = TMP.ORG_ID
			           AND SC.COMPANY_ID = TMP.COMPANY_ID
			           AND SC.BIG_CODE = 'CMM'
			           AND SC.MIDDLE_CODE = 'ITEM_TYPE'
			           AND SC.USE_YN = 'Y'
			           AND SC.REMARKS IN ('A', 'Z')
			          ) A
			 WHERE 1=1
			   AND RN BETWEEN 1 AND 4
      ]]>
    </select>
    
    <select id="report.prod.sheet.sub4.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT RANK() OVER(ORDER BY A.ORGID, A.COMPANYID, (CASE WHEN A.ITEMTYPENAME = '기타' THEN
															                                                          'ZZZ'
															                                                        ELSE
															                                                          A.ITEMTYPE
															                                                        END)) AS RN
					      ,A.ORGID
					      ,A.COMPANYID
					      ,A.ITEMTYPE
					      ,A.ITEMTYPENAME
					      ,A.MONTH01
					      ,A.MONTH02
					      ,A.MONTH03
					      ,A.MONTH04
					      ,A.MONTH05
					      ,A.MONTH06
					      ,A.MONTH07
					      ,A.MONTH08
					      ,A.MONTH09
					      ,A.MONTH10
					      ,A.MONTH11
					      ,A.MONTH12
					      ,A.MONTHTOTAL
			  FROM (
			        SELECT RANK() OVER(ORDER BY SC.ORG_ID, SC.COMPANY_ID, SC.SMALL_CODE) AS RN
					              ,SC.ORG_ID AS ORGID
					              ,SC.COMPANY_ID AS COMPANYID
					              ,SC.SMALL_CODE AS ITEMTYPE
					              ,SC.SMALL_NAME AS ITEMTYPENAME
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                 ,TMP.COMPANY_ID
					                                                 ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '01'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '01'), 'YYYY-MM'))
					                                                        WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '01'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                          TMP.SEARCH_DATE
					                                                        ELSE
					                                                          NULL
					                                                        END)
					                                                 ,SC.SMALL_CODE
					                                                 ,NULL
					                                                  ) AS MONTH01
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '02'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '02'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '02'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH02
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '03'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '03'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '03'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH03
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '04'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '04'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '04'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH04
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '05'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '05'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '05'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH05
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '06'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '06'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '06'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH06
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '07'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '07'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '07'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH07
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '08'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '08'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '08'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH08
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '09'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '09'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '09'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH09
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '10'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '10'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '10'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH10
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '11'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '11'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '11'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH11
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,(CASE WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '12'), 'YYYY-MM') < TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             LAST_DAY(TO_DATE(CONCAT(TMP.SEARCH_YEAR, '12'), 'YYYY-MM'))
					                                                           WHEN TO_DATE(CONCAT(TMP.SEARCH_YEAR, '12'), 'YYYY-MM') = TRUNC(TMP.SEARCH_DATE, 'MM') THEN
					                                                             TMP.SEARCH_DATE
					                                                           ELSE
					                                                             NULL
					                                                           END)
					                                                    ,SC.SMALL_CODE
					                                                    ,NULL
					                                                     ) AS MONTH12
					              ,CB_REPORT_PKG.CB_PURCHASE_AMOUNT_FIND(TMP.ORG_ID
					                                                    ,TMP.COMPANY_ID
					                                                    ,TMP.SEARCH_DATE
					                                                    ,SC.SMALL_CODE
					                                                    ,'TYPE_TOTAL'
					                                                     ) AS MONTHTOTAL
			          FROM CB_SMALL_CODE SC
					              ,(SELECT #ORGID# AS ORG_ID
					                      ,#COMPANYID# AS COMPANY_ID
					                      ,CONCAT(TO_CHAR(TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD'), 'YYYY'), '-') AS SEARCH_YEAR
					                      ,TO_DATE(#SEARCHDATE#, 'YYYY-MM-DD') AS SEARCH_DATE
					                  FROM DUAL) TMP
			         WHERE 1=1
			           AND SC.ORG_ID = TMP.ORG_ID
			           AND SC.COMPANY_ID = TMP.COMPANY_ID
			           AND SC.BIG_CODE = 'CMM'
			           AND SC.MIDDLE_CODE = 'ITEM_TYPE'
			           AND SC.USE_YN = 'Y'
			           AND SC.REMARKS IN ('M', 'Z', 'T')
			          ) A
			 WHERE 1=1
			   AND RN BETWEEN 1 AND 6
      ]]>
    </select>
    
    <select id="report.day.work.order.status.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
        SELECT RANK() OVER(ORDER BY WC.ORG_ID, WC.COMPANY_ID, WC.WORK_DEPT, WC.SEQ, WC.WORK_CENTER_CODE) AS RN
					      ,WC.ORG_ID AS ORGID
					      ,(SELECT CO.ORG_NAME
					          FROM CB_ORG CO
					         WHERE 1=1
					           AND CO.ORG_ID = WC.ORG_ID) AS ORGNAME
					      ,WC.COMPANY_ID AS COMPANYID
					      ,WC.WORK_CENTER_CODE AS WORKCENTERCODE
					      ,WC.WORK_CENTER_NAME AS WORKCENTERNAME
					      ,TO_CHAR(TMP.SEARCH_DATE, 'YYYY') || '년 ' || TO_CHAR(TMP.SEARCH_DATE, 'MM') || '월 ' || TO_CHAR(TMP.SEARCH_DATE, 'DD') || '일' AS WRITEDATE
					      ,TMP.EMPLOYEE_NUMBER AS EMPLOYEENUMBER
					      ,(SELECT HM.KR_NAME
					          FROM CB_HUMANRESOURCE_MANAGER_V HM
					         WHERE 1=1
					           AND HM.ORG_ID = WC.ORG_ID
					           AND HM.COMPANY_ID = WC.COMPANY_ID
					           AND HM.EMPLOYEE_NUMBER = TMP.EMPLOYEE_NUMBER) AS KRNAME
					      ,CB_REPORT_PKG.CB_DAY_WORK_ORDER_FIND(WC.ORG_ID
					                                           ,WC.COMPANY_ID
					                                           ,WC.WORK_CENTER_CODE
					                                           ,SEARCH_DATE1
					                                           ,'WORKER') AS WORKER
					      ,CB_REPORT_PKG.CB_DAY_WORK_ORDER_FIND(WC.ORG_ID
					                                           ,WC.COMPANY_ID
					                                           ,WC.WORK_CENTER_CODE
					                                           ,SEARCH_DATE1
					                                           ,'ITEM_NAME') AS ITEMNAME
					      ,CB_REPORT_PKG.CB_DAY_WORK_ORDER_FIND(WC.ORG_ID
					                                           ,WC.COMPANY_ID
					                                           ,WC.WORK_CENTER_CODE
					                                           ,SEARCH_DATE1
					                                           ,'ROUTING_NAME') AS ROUTINGNAME
					      ,CB_REPORT_PKG.CB_DAY_WORK_ORDER_FIND(WC.ORG_ID
					                                           ,WC.COMPANY_ID
					                                           ,WC.WORK_CENTER_CODE
					                                           ,SEARCH_DATE1
					                                           ,'WORK_ORDER_QTY') AS WORKORDERQTY
					      ,CB_REPORT_PKG.CB_DAY_WORK_ORDER_FIND(WC.ORG_ID
					                                           ,WC.COMPANY_ID
					                                           ,WC.WORK_CENTER_CODE
					                                           ,SEARCH_DATE1
					                                           ,'IMPORT_QTY') AS IMPORT_QTY
					      ,CB_REPORT_PKG.CB_DAY_WORK_ORDER_FIND(WC.ORG_ID
					                                           ,WC.COMPANY_ID
					                                           ,WC.WORK_CENTER_CODE
					                                           ,SEARCH_DATE1
					                                           ,'REMAIN_QTY') AS REMAIN_QTY
					      ,CB_REPORT_PKG.CB_DAY_WORK_ORDER_FIND(WC.ORG_ID
					                                           ,WC.COMPANY_ID
					                                           ,WC.WORK_CENTER_CODE
					                                           ,SEARCH_DATE1
					                                           ,'WORK_ORDER_ID') AS CHKCK1
					      ,NULL AS CHECK2
					      ,NULL AS CHECK3
					      ,NULL AS CHECK4
					      ,NULL AS CHECK5
					      ,NULL AS REMARKS
			  FROM CB_WORK_CENTER WC
					      ,(SELECT #ORGID# AS ORG_ID
					              ,#COMPANYID# AS COMPANY_ID
					              ,TO_DATE(#PRINTDATE#, 'YYYY-MM-DD') AS SEARCH_DATE
					              ,#PRINTDATE# AS SEARCH_DATE1
					              ,#LOGINID# AS EMPLOYEE_NUMBER
					          FROM DUAL) TMP
			 WHERE 1=1
			   AND WC.ORG_ID = TMP.ORG_ID
			   AND WC.COMPANY_ID = TMP.COMPANY_ID
			   AND WC.WORK_DEPT NOT IN ('D')
			   AND TMP.SEARCH_DATE BETWEEN WC.EFFECTIVE_START_DATE AND WC.EFFECTIVE_END_DATE
			 ORDER BY WC.ORG_ID, WC.COMPANY_ID, WC.WORK_DEPT, WC.SEQ, WC.WORK_CENTER_CODE
    </select>
    
    <select id="report.ship.insp.doosan.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    SELECT ORG_ID AS ORGID
			      ,COMPANY_ID AS COMPANYID
			      ,LOGO_IMAGE AS LOGOIMAGE
			      ,SHIP_INS_NO AS SHIPINSNO
			      ,ITEM_CODE AS ITEMCODE
			      ,MODEL AS MODEL
			      ,MODEL_NAME AS MODELNAME
			      ,ORDER_NAME AS ORDERNAME
			      ,ITEM_NAME AS ITEMNAME
			      ,CUSTOMER_CODE AS CUSTOMERCODE
			      ,CUSTOMER_NAME AS CUSTOMERNAME
			      ,TITLE_NAME AS TITLENAME
			      ,PPAP_LEVEL AS PPAPLEVEL
			      ,MANAGE_NUMBER AS MANAGENUMBER
			      ,WRITE_DATE AS WRITEDATE
			      ,FILE_IMAGE AS FILEIMAGE
			      ,TEMP1 AS TEMP1
			      ,TEMP2 AS TEMP2
			      ,MATERIAL_TYPE AS MATERIALTYPE
			      ,HEAT_GUBUN AS HEATGUBUN
			      ,EXIST_FILE_YN AS EXISTFILEYN
			      ,EXIST_FILE_NAME AS EXISTFILENAME
			      ,MFG_DATE AS MFGDATE
			      ,LOT_NO AS LOTNO
			      ,DETAIL_QTY AS DETAILQTY
			      ,CHECK_YN AS CHECKYN
			      ,CHECK_YN_NAME AS CHECKYNNAME
			      ,PERSON_ID AS PERSONID
			      ,KR_NAME AS KRNAME
			      ,MANAGE_EMPLOYEE AS MANAGEEMPLOYEE
			      ,MANAGE_NAME AS MANAGENAME
			      ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
			      ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
			      ,FOOTER_RIGHT_INFO AS FOOTERRIGHTINFO
			      ,SHIP_INSPECTION_NO AS SHIPINSPECTIONNO
			      ,CHECK_LIST_ID AS CHECKLISTID
			      ,ORDER_NO AS ORDERNO
			      ,CHECK_MIDDLE AS CHECKMIDDLE
			      ,CHECK_MIDDLE_NAME AS CHECKMIDDLENAME
			      ,CHECK_SMALL AS CHECKSMALL
			      ,CHECK_SMALL_NAME AS CHECKSMALLNAME
			      ,STANDARD_VALUE AS STANDARDVALUE
			      ,MAX_VALUE AS MAXVALUE
			      ,MIN_VALUE AS MINVALUE
			      ,EXT_STANDARD AS EXTSTANDARD
			      ,CHECK_METHOD_TYPE AS CHECKMETHODTYPE
			      ,CHECK_METHOD_TYPE_NAME AS CHECKMETHODTYPENAME
			      ,CHECK_STANDARD AS CHECKSTANDARD
			      ,CHECK_CYCLE AS CHECKCYCLE
			      ,CHECK_CYCLE_NAME AS CHECKCYCLENAME
			      ,REMARKS1 AS REMARKS1
			      ,CHECK_RESULT1 AS CHECKRESULT1
			      ,CHECK_RESULT2 AS CHECKRESULT2
			      ,CHECK_RESULT3 AS CHECKRESULT3
			      ,CHECK_RESULT4 AS CHECKRESULT4
			      ,CHECK_RESULT5 AS CHECKRESULT5
			      ,CHECK_RESULT6 AS CHECKRESULT6
			      ,CHECK_RESULT7 AS CHECKRESULT7
			      ,CHECK_RESULT8 AS CHECKRESULT8
			      ,CHECK_RESULT9 AS CHECKRESULT9
			      ,CHECK_RESULT10 AS CHECKRESULT10
			      ,REMARKS2 AS REMARKS2
		  FROM CB_SHIP_IN_DS_D_REPORT_V SV
		 WHERE 1=1
		   AND ORG_ID = #ORGID#
		   AND COMPANY_ID = #COMPANYID#
		   AND SHIP_INS_NO = #SHIPINSNO#
    </select>
    
    <select id="report.ship.insp.doosan.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
	    SELECT TMP.RN
				      ,CM.CHECK_METHOD_TYPE
				      ,CM.CHECK_METHOD_TYPE_NAME
				      ,(SELECT SC.ATTRIBUTE1
				          FROM CB_SMALL_CODE SC
				         WHERE 1=1
				           AND SC.ORG_ID = CM.ORG_ID
				           AND SC.COMPANY_ID = CM.COMPANY_ID
				           AND SC.BIG_CODE = 'QM'
				           AND SC.MIDDLE_CODE = 'CHECK_METHOD_TYPE'
				           AND SC.SMALL_CODE = CM.CHECK_METHOD_TYPE) AS ATTRIBUTE1
				      ,(SELECT SC.ATTRIBUTE2
				          FROM CB_SMALL_CODE SC
				         WHERE 1=1
				           AND SC.ORG_ID = CM.ORG_ID
				           AND SC.COMPANY_ID = CM.COMPANY_ID
				           AND SC.BIG_CODE = 'QM'
				           AND SC.MIDDLE_CODE = 'CHECK_METHOD_TYPE'
				           AND SC.SMALL_CODE = CM.CHECK_METHOD_TYPE) AS ATTRIBUTE2
			  FROM (
			        SELECT RANK() OVER(ORDER BY SV.ORG_ID, SV.COMPANY_ID, SV.SHIP_INS_NO, SV.CHECK_METHOD_TYPE_NAME) AS RN
				              ,SV.ORG_ID AS ORG_ID
				              ,SV.COMPANY_ID AS COMPANY_ID
				              ,SV.CHECK_METHOD_TYPE AS CHECK_METHOD_TYPE
				              ,SV.CHECK_METHOD_TYPE_NAME AS CHECK_METHOD_TYPE_NAME
			          FROM CB_SHIPMENT_INSPECTION_D_V SV
			         WHERE 1=1
			           AND SV.ORG_ID = #ORGID#
			           AND SV.COMPANY_ID = #COMPANYID#
			           AND SV.SHIP_INS_NO = #SHIPINSNO#
			         GROUP BY SV.ORG_ID, SV.COMPANY_ID, SV.SHIP_INS_NO, SV.CHECK_METHOD_TYPE, SV.CHECK_METHOD_TYPE_NAME
			           ) CM
			      ,(SELECT LEVEL AS RN
			          FROM DUAL
			        CONNECT BY LEVEL <= 11) TMP
			 WHERE 1=1
			   AND TMP.RN = CM.RN (+)
			 ORDER BY TMP.RN
      ]]>
    </select>
    
    <select id="report.ship.insp.doosan.sub2.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
	    SELECT CB_REPORT_PKG.CB_CHECK_HISTORY_NO_FIND(CH.ORG_ID
													                                             ,CH.COMPANY_ID
													                                             ,CH.ITEM_CODE
													                                             ,CH.CHECK_BIG
													                                             ,CH.HISTORY_ID
													                                             ,4
													                                              ) AS RN
				      ,CH.ORG_ID AS ORGID
				      ,CH.COMPANY_ID AS COMPANYID
				      ,CH.ITEM_CODE AS ITEMCODE
				      ,CH.CHECK_BIG AS CHECKBIG
				      ,CH.MARK AS MARKNUMBER
				      ,TO_CHAR(CH.EFFECTIVE_START_DATE, 'YYYY/MM/DD') AS CHANGEDATE
				      ,CH.CHANGE_DESCRIPTION AS CHANGECONTENT
				      ,CH.CHANGE_PERSON AS CHARGENAME
				      ,CH.APPROVAL_PERSON AS APPROVOLNAME
		  FROM CB_CHECK_HISTORY CH
		 WHERE 1 = 1
		   AND CH.ORG_ID = #ORGID#
		   AND CH.COMPANY_ID = #COMPANYID#
		   AND CH.ITEM_CODE = (SELECT SIV.ITEM_CODE
						                         FROM CB_SHIPMENT_INSPECTION_H_V SIV
						                        WHERE 1=1
						                          AND SIV.SHIP_INS_NO = #SHIPINSNO#
						                       )
		   AND CH.CHECK_BIG = 'O'
		   AND SYSDATE BETWEEN CH.EFFECTIVE_START_DATE AND CH.EFFECTIVE_END_DATE
		   AND CB_REPORT_PKG.CB_CHECK_HISTORY_NO_FIND(CH.ORG_ID
													                                             ,CH.COMPANY_ID
													                                             ,CH.ITEM_CODE
													                                             ,CH.CHECK_BIG
													                                             ,CH.HISTORY_ID
													                                             ,4
													                                              ) BETWEEN 1 AND 4
      ]]>
    </select>
    
    <select id="report.ship.insp.eaton.report.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      SELECT DECODE(LAG(AA.RN) OVER(ORDER BY AA.RN), AA.RN, '', AA.RN) AS RN
            ,DECODE(DECODE(LAG(AA.RN) OVER(ORDER BY AA.RN), AA.RN, '', AA.RN), '', 'N', 'Y') AS LINECHK
            ,DECODE(AA.COUNT, ROWNUM, 'Y', 'N') AS LASTCHK
            ,CEIL(AA.COUNT / 25)      AS PAGEMAXCOUNT
            ,AA.TITLENAME             AS TITLENAME
            ,AA.BOTTOMIMAGE           AS BOTTOMIMAGE
            ,AA.ORGID                 AS ORGID
            ,AA.COMPANYID             AS COMPANYID
            ,AA.SHIPINSNO             AS SHIPINSNO
            ,AA.ITEMCODE              AS ITEMCODE
            ,AA.ORDERNAME             AS ORDERNAME
            ,AA.ITEMNAME              AS ITEMNAME
            ,AA.MODEL                 AS MODEL
            ,AA.MODELNAME             AS MODELNAME
            ,AA.CUSTOMERCODE          AS CUSTOMERCODE
            ,AA.CUSTOMERNAME          AS CUSTOMERNAME
            ,AA.MFGDATE1              AS MFGDATE1
            ,AA.SHIPDATE              AS SHIPDATE
            ,AA.LOTNO                 AS LOTNO
            ,AA.WORKLOTQTY            AS WORKLOTQTY
            ,AA.CHECKMIDDLE           AS CHECKMIDDLE
            ,DECODE(LAG(AA.RN) OVER(ORDER BY AA.RN), AA.RN, '', AA.CHECKMIDDLENAME) AS CHECKMIDDLENAME
            ,AA.CHECKSMALL            AS CHECKSMALL
            ,AA.CHECKSMALLNAME        AS CHECKSMALLNAME
            ,SUBSTR(AA.CHECKSMALL, -1)||'. '||AA.CHECKSMALLNAME AS SUBMIDDLENAME
            ,AA.CHECKSTANDARD         AS CHECKSTANDARD
            ,AA.EXTSTANDARD           AS EXTSTANDARD
            ,AA.SPECIALCHECK          AS SPECIALCHECK
            ,AA.SPECIALCHECKNAME      AS SPECIALCHECKNAME
            ,AA.CHECKMETHODTYPE       AS CHECKMETHOTYPE
            ,AA.CHECKMETHODTYPENAME   AS CHECKMETHODTYPNAME
            ,AA.CHECKRESULT1          AS CHECKRESULT1
            ,AA.CHECKRESULT2          AS CHECKRESULT2
            ,AA.CHECKRESULT3          AS CHECKRESULT3
            ,AA.CHECKRESULT4          AS CHECKRESULT4
            ,AA.CHECKRESULT5          AS CHECKRESULT5
            ,AA.CHECKRESULT6          AS CHECKRESULT6
            ,AA.CHECKRESULT7          AS CHECKRESULT7
            ,AA.CHECKRESULT8          AS CHECKRESULT8
            ,AA.CHECKRESULT9          AS CHECKRESULT9
            ,AA.CHECKRESULT10         AS CHECKRESULT10
            ,AA.CHECKYN               AS CHECKYN
            ,AA.CHECKYNNAME           AS CHECKYNNAME
            ,AA.REMARKS               AS REMARKS
        FROM (SELECT DENSE_RANK() OVER(ORDER BY ORG_ID, COMPANY_ID, CHECK_MIDDLE) AS RN
                    ,(SELECT COUNT(*)
                        FROM CB_SHIP_IN_ET_D_REPORT_V DRV
                       WHERE 1=1
                         AND DRV.ORG_ID = SV.ORG_ID
                         AND DRV.COMPANY_ID = SV.COMPANY_ID
                         AND DRV.SHIP_INS_NO = SV.SHIP_INS_NO) AS COUNT
                    ,'검사 성적서 (갑지-일상)'      AS TITLENAME
                    ,BOTTOM_IMAGE           AS BOTTOMIMAGE
                    ,ORG_ID                 AS ORGID
                    ,COMPANY_ID             AS COMPANYID
                    ,SHIP_INS_NO            AS SHIPINSNO
                    ,ITEM_CODE              AS ITEMCODE
                    ,ORDER_NAME             AS ORDERNAME
                    ,ITEM_NAME              AS ITEMNAME
                    ,MODEL                  AS MODEL
                    ,MODEL_NAME             AS MODELNAME
                    ,CUSTOMER_CODE          AS CUSTOMERCODE
                    ,CUSTOMER_NAME          AS CUSTOMERNAME
                    ,MFG_DATE1              AS MFGDATE1
                    ,TO_CHAR(TO_DATE(SHIP_DATE, 'YY.MM.DD'), 'YY.MM.DD') AS SHIPDATE
                    ,LOT_NO                 AS LOTNO
                    ,REGEXP_REPLACE(REVERSE(REGEXP_REPLACE( REVERSE(TO_CHAR(WORKLOTQTY)), '([0-9]{3})','\1,')), '^,','') || WORK_LOT_UOMNAME AS WORKLOTQTY
                    ,CHECK_MIDDLE           AS CHECKMIDDLE
                    ,CHECK_MIDDLE_NAME      AS CHECKMIDDLENAME
                    ,CHECK_SMALL            AS CHECKSMALL
                    ,CHECK_SMALL_NAME       AS CHECKSMALLNAME
                    ,ORDER_NO               AS ORDERNO
                    ,EXT_STANDARD           AS EXTSTANDARD
                    ,CHECK_STANDARD         AS CHECKSTANDARD
                    ,SPECIAL_CHECK          AS SPECIALCHECK
                    ,SPECIAL_CHECK_NAME     AS SPECIALCHECKNAME
                    ,CHECK_METHOD_TYPE      AS CHECKMETHODTYPE
                    ,CHECK_METHOD_TYPE_NAME AS CHECKMETHODTYPENAME
                    ,CHECK_RESULT1          AS CHECKRESULT1
                    ,CHECK_RESULT2          AS CHECKRESULT2
                    ,CHECK_RESULT3          AS CHECKRESULT3
                    ,CHECK_RESULT4          AS CHECKRESULT4
                    ,CHECK_RESULT5          AS CHECKRESULT5
                    ,CHECK_RESULT6          AS CHECKRESULT6
                    ,CHECK_RESULT7          AS CHECKRESULT7
                    ,CHECK_RESULT8          AS CHECKRESULT8
                    ,CHECK_RESULT9          AS CHECKRESULT9
                    ,CHECK_RESULT10         AS CHECKRESULT10
                    ,CHECK_YN               AS CHECKYN
                    ,CHECK_YN_NAME          AS CHECKYNNAME
                    ,(SELECT LISTAGG((HV.SHIP_DATE || ' : ' || REGEXP_REPLACE(REVERSE(REGEXP_REPLACE( REVERSE(TO_CHAR(HV.SHIP_QTY)), '([0-9]{3})','\1,')), '^,','') || SC.SMALL_NAME), ', ')
                             WITHIN GROUP(ORDER BY HV.ORG_ID, HV.COMPANY_ID, HV.SHIP_DATE, HV.MFG_DATE1, HV.SHIP_INS_NO)
                        FROM CB_SHIPMENT_INSPECTION_H_V HV
                            ,CB_ITEM_MASTER IM
                            ,CB_SMALL_CODE SC
                       WHERE 1=1
                         AND HV.ORG_ID = IM.ORG_ID
                         AND HV.COMPANY_ID = IM.COMPANY_ID
                         AND HV.ITEM_CODE = IM.ITEM_CODE
                         AND IM.ORG_ID = SC.ORG_ID
                         AND IM.COMPANY_ID = SC.COMPANY_ID
                         AND SC.BIG_CODE = 'CMM'
                         AND SC.MIDDLE_CODE = 'UOM'
                         AND SC.SMALL_CODE = IM.UOM
                         AND HV.ORG_ID = SV.ORG_ID
                         AND HV.COMPANY_ID = SV.COMPANY_ID
                         AND HV.CUSTOMER_CODE = SV.CUSTOMER_CODE
                         AND HV.ITEM_CODE = SV.ITEM_CODE
                         AND HV.MFG_NO = SV.LOT_NO) AS REMARKS
                FROM CB_SHIP_IN_ET_D_REPORT_V SV
               WHERE 1 = 1
                 AND ORG_ID = $ORGID$
                 AND COMPANY_ID = $COMPANYID$
                 AND SHIP_INS_NO = #SHIPINSNO#
               ORDER BY ORG_ID, COMPANY_ID, CHECK_MIDDLE, CHECK_SMALL)AA
       WHERE 1=1
       ORDER BY AA.ORGID, AA.COMPANYID, AA.CHECKMIDDLE, AA.CHECKSMALL
    </select>
    
    <select id="report.ship.insp.hydrotek.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
			SELECT ORG_ID AS ORGID
			      ,COMPANY_ID AS COMPANYID
			      ,LOGO_IMAGE AS LOGOIMAGE
			      ,SHIP_INS_NO AS SHIPINSNO
			      ,ITEM_CODE AS ITEMCODE
			      ,MODEL AS MODEL
			      ,MODEL_NAME AS MODELNAME
			      ,ORDER_NAME AS ORDERNAME
			      ,ITEM_NAME AS ITEMNAME
			      ,CUSTOMER_CODE AS CUSTOMERCODE
			      ,CUSTOMER_NAME AS CUSTOMERNAME
			      ,TITLE_NAME AS TITLENAME
			      ,PPAP_LEVEL AS PPAPLEVEL
			      ,MANAGE_NUMBER AS MANAGENUMBER
			      ,WRITE_DATE AS WRITEDATE
			      ,FILE_IMAGE AS FILEIMAGE
			      ,TEMP1 AS TEMP1
			      ,TEMP2 AS TEMP2
			      ,MATERIAL_TYPE AS MATERIALTYPE
			      ,HEAT_GUBUN AS HEATGUBUN
			      ,EXIST_FILE_YN AS EXISTFILEYN
			      ,EXIST_FILE_NAME AS EXISTFILENAME
			      ,MFG_DATE AS MFGDATE
			      ,LOT_NO AS LOTNO
			      ,DETAIL_QTY AS DETAILQTY
			      ,CHECK_YN AS CHECKYN
			      ,CHECK_YN_NAME AS CHECKYNNAME
			      ,PERSON_ID AS PERSONID
			      ,KR_NAME AS KRNAME
			      ,MANAGE_EMPLOYEE AS MANAGEEMPLOYEE
			      ,MANAGE_NAME AS MANAGENAME
			      ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
			      ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
			      ,FOOTER_RIGHT_INFO AS FOOTERRIGHTINFO
			      ,SHIP_INSPECTION_NO AS SHIPINSPECTIONNO
			      ,CHECK_LIST_ID AS CHECKLISTID
			      ,ORDER_NO AS ORDERNO
			      ,CHECK_MIDDLE AS CHECKMIDDLE
			      ,CHECK_MIDDLE_NAME AS CHECKMIDDLENAME
			      ,CHECK_SMALL AS CHECKSMALL
			      ,CHECK_SMALL_NAME AS CHECKSMALLNAME
			      ,IMPORTANT_CODE AS IMPORTANTCODE
			      ,IMPORTANT_NAME AS IMPORTANTNAME
			      ,STANDARD_VALUE AS STANDARDVALUE
			      ,MAX_VALUE AS MAXVALUE
			      ,MIN_VALUE AS MINVALUE
			      ,EXT_STANDARD AS EXTSTANDARD
			      ,CHECK_METHOD_TYPE AS CHECKMETHODTYPE
			      ,CHECK_METHOD_TYPE_NAME AS CHECKMETHODTYPENAME
			      ,CHECK_STANDARD AS CHECKSTANDARD
			      ,CHECK_CYCLE AS CHECKCYCLE
			      ,CHECK_CYCLE_NAME AS CHECKCYCLENAME
			      ,CHECK_RESULT1 AS CHECKRESULT1
			      ,CHECK_RESULT2 AS CHECKRESULT2
			      ,CHECK_RESULT3 AS CHECKRESULT3
			      ,CHECK_RESULT4 AS CHECKRESULT4
			      ,CHECK_RESULT5 AS CHECKRESULT5
			      ,CHECK_RESULT6 AS CHECKRESULT6
			      ,CHECK_RESULT7 AS CHECKRESULT7
			      ,CHECK_RESULT8 AS CHECKRESULT8
			      ,CHECK_RESULT9 AS CHECKRESULT9
			      ,CHECK_RESULT10 AS CHECKRESULT10
			      ,REMARKS AS REMARKS
			  FROM CB_SHIP_IN_HD_D_REPORT_V SV
			 WHERE 1=1
			   AND ORG_ID = #ORGID#
			   AND COMPANY_ID = #COMPANYID#
			   AND SHIP_INS_NO = #SHIPINSNO#
    </select>
    
    <select id="report.ship.insp.hydrotek.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
			SELECT TMP.RN AS RN
			      ,CM.CHECK_METHOD_TYPE AS CHECKMETHODTYPE
			      ,CM.CHECK_METHOD_TYPE_NAME AS CHECKMETHODTYPENAME
			      ,(SELECT SC.ATTRIBUTE1
			          FROM CB_SMALL_CODE SC
			         WHERE 1=1
			           AND SC.ORG_ID = CM.ORG_ID
			           AND SC.COMPANY_ID = CM.COMPANY_ID
			           AND SC.BIG_CODE = 'QM'
			           AND SC.MIDDLE_CODE = 'CHECK_METHOD_TYPE'
			           AND SC.SMALL_CODE = CM.CHECK_METHOD_TYPE) AS ATTRIBUTE1
			      ,(SELECT SC.ATTRIBUTE2
			          FROM CB_SMALL_CODE SC
			         WHERE 1=1
			           AND SC.ORG_ID = CM.ORG_ID
			           AND SC.COMPANY_ID = CM.COMPANY_ID
			           AND SC.BIG_CODE = 'QM'
			           AND SC.MIDDLE_CODE = 'CHECK_METHOD_TYPE'
			           AND SC.SMALL_CODE = CM.CHECK_METHOD_TYPE) AS ATTRIBUTE2
			  FROM (
			        SELECT RANK() OVER(ORDER BY SV.ORG_ID, SV.COMPANY_ID, SV.SHIP_INS_NO, SV.CHECK_METHOD_TYPE_NAME) AS RN
			              ,SV.ORG_ID AS ORG_ID
			              ,SV.COMPANY_ID AS COMPANY_ID
			              ,SV.CHECK_METHOD_TYPE AS CHECK_METHOD_TYPE
			              ,SV.CHECK_METHOD_TYPE_NAME AS CHECK_METHOD_TYPE_NAME
			          FROM CB_SHIPMENT_INSPECTION_D_V SV
			         WHERE 1=1
			           AND SV.ORG_ID = #ORGID#
			           AND SV.COMPANY_ID = #COMPANYID#
			           AND SV.SHIP_INS_NO = #SHIPINSNO#
			         GROUP BY SV.ORG_ID, SV.COMPANY_ID, SV.SHIP_INS_NO, SV.CHECK_METHOD_TYPE, SV.CHECK_METHOD_TYPE_NAME
			           ) CM
			      ,(SELECT LEVEL AS RN
			          FROM DUAL
			        CONNECT BY LEVEL <= 7) TMP
			 WHERE 1=1
			   AND TMP.RN = CM.RN (+)
			 ORDER BY TMP.RN
      ]]>
    </select>
    
    <select id="report.ship.insp.hydrotek.sub2.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
			SELECT CB_REPORT_PKG.CB_CHECK_HISTORY_NO_FIND(CH.ORG_ID
			                                             ,CH.COMPANY_ID
			                                             ,CH.ITEM_CODE
			                                             ,CH.CHECK_BIG
			                                             ,CH.HISTORY_ID
			                                             ,7
			                                              ) AS RN
			      ,CH.ORG_ID AS ORGID
			      ,CH.COMPANY_ID AS COMPANYID
			      ,CH.ITEM_CODE AS ITEMCODE
			      ,CH.CHECK_BIG AS CHECKBIG
			      ,CH.MARK AS MARKNUMBER
			      ,TO_CHAR(CH.EFFECTIVE_START_DATE, 'YYYY/MM/DD') AS CHANGEDATE
			      ,CH.CHANGE_DESCRIPTION AS CHANGECONTENT
			      ,CH.CHANGE_PERSON AS CHARGENAME
			      ,CH.APPROVAL_PERSON AS APPROVOLNAME
			  FROM CB_CHECK_HISTORY CH
			 WHERE 1 = 1
			   AND CH.ORG_ID = #ORGID#
			   AND CH.COMPANY_ID = #COMPANYID#
			   AND CH.ITEM_CODE = (SELECT SIV.ITEM_CODE
			                         FROM CB_SHIPMENT_INSPECTION_H_V SIV
			                        WHERE 1=1
			                          AND SIV.SHIP_INS_NO = #SHIPINSNO#
			                       )
			   AND CH.CHECK_BIG = 'O'
			   AND SYSDATE BETWEEN CH.EFFECTIVE_START_DATE AND CH.EFFECTIVE_END_DATE
			   AND CB_REPORT_PKG.CB_CHECK_HISTORY_NO_FIND(CH.ORG_ID
			                                             ,CH.COMPANY_ID
			                                             ,CH.ITEM_CODE
			                                             ,CH.CHECK_BIG
			                                             ,CH.HISTORY_ID
			                                             ,7
			                                              ) BETWEEN 1 AND 7
      ]]>
    </select>
    
    <select id="report.ship.insp.flutek.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
			SELECT ORG_ID AS ORGID
			      ,COMPANY_ID AS COMPANYID
			      ,LOGO_IMAGE AS LOGOIMAGE
			      ,SHIP_INS_NO AS SHIPINSNO
			      ,ITEM_CODE AS ITEMCODE
			      ,MODEL AS MODEL
			      ,MODEL_NAME AS MODELNAME
			      ,ORDER_NAME AS ORDERNAME
			      ,ITEM_NAME AS ITEMNAME
			      ,CUSTOMER_CODE AS CUSTOMERCODE
			      ,CUSTOMER_NAME AS CUSTOMERNAME
			      ,TITLE_NAME AS TITLENAME
			      ,PPAP_LEVEL AS PPAPLEVEL
			      ,MANAGE_NUMBER AS MANAGENUMBER
			      ,WRITE_DATE AS WRITEDATE
			      ,FILE_IMAGE AS FILEIMAGE
			      ,TEMP1 AS TEMP1
			      ,TEMP2 AS TEMP2
			      ,MATERIAL_TYPE AS MATERIALTYPE
			      ,HEAT_GUBUN AS HEATGUBUN
			      ,EXIST_FILE_YN AS EXISTFILEYN
			      ,EXIST_FILE_NAME AS EXISTFILENAME
			      ,MFG_DATE AS MFGDATE
			      ,LOT_NO AS LOTNO
			      ,DETAIL_QTY AS DETAILQTY
			      ,CHECK_YN AS CHECKYN
			      ,CHECK_YN_NAME AS CHECKYNNAME
			      ,PERSON_ID AS PERSONID
			      ,KR_NAME AS KRNAME
			      ,MANAGE_EMPLOYEE AS MANAGEEMPLOYEE
			      ,MANAGE_NAME AS MANAGENAME
			      ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
			      ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
			      ,FOOTER_RIGHT_INFO AS FOOTERRIGHTINFO
			      ,SHIP_INSPECTION_NO AS SHIPINSPECTIONNO
			      ,CHECK_LIST_ID AS CHECKLISTID
			      ,ORDER_NO AS ORDERNO
			      ,CHECK_MIDDLE AS CHECKMIDDLE
			      ,CHECK_MIDDLE_NAME AS CHECKMIDDLENAME
			      ,CHECK_SMALL AS CHECKSMALL
			      ,CHECK_SMALL_NAME AS CHECKSMALLNAME
			      ,STANDARD_VALUE AS STANDARDVALUE
			      ,MAX_VALUE AS MAXVALUE
			      ,MIN_VALUE AS MINVALUE
			      ,EXT_STANDARD AS EXTSTANDARD
			      ,CHECK_METHOD_TYPE AS CHECKMETHODTYPE
			      ,CHECK_METHOD_TYPE_NAME AS CHECKMETHODTYPENAME
			      ,CHECK_STANDARD AS CHECKSTANDARD
			      ,CHECK_CYCLE AS CHECKCYCLE
			      ,CHECK_CYCLE_NAME AS CHECKCYCLENAME
			      ,REMARKS1 AS REMARKS1
			      ,CHECK_RESULT1 AS CHECKRESULT1
			      ,CHECK_RESULT2 AS CHECKRESULT2
			      ,CHECK_RESULT3 AS CHECKRESULT3
			      ,CHECK_RESULT4 AS CHECKRESULT4
			      ,CHECK_RESULT5 AS CHECKRESULT5
			      ,CHECK_RESULT6 AS CHECKRESULT6
			      ,CHECK_RESULT7 AS CHECKRESULT7
			      ,CHECK_RESULT8 AS CHECKRESULT8
			      ,CHECK_RESULT9 AS CHECKRESULT9
			      ,CHECK_RESULT10 AS CHECKRESULT10
			      ,REMARKS2 AS REMARKS2
			  FROM CB_SHIP_IN_FL_D_REPORT_V SV
			 WHERE 1=1
			   AND ORG_ID = #ORGID#
			   AND COMPANY_ID = #COMPANYID#
			   AND SHIP_INS_NO = #SHIPINSNO#
    </select>
    
    <select id="report.ship.insp.flutek.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
			SELECT TMP.RN
			      ,CM.CHECK_METHOD_TYPE
			      ,CM.CHECK_METHOD_TYPE_NAME
			      ,(SELECT SC.ATTRIBUTE1
			          FROM CB_SMALL_CODE SC
			         WHERE 1=1
			           AND SC.ORG_ID = CM.ORG_ID
			           AND SC.COMPANY_ID = CM.COMPANY_ID
			           AND SC.BIG_CODE = 'QM'
			           AND SC.MIDDLE_CODE = 'CHECK_METHOD_TYPE'
			           AND SC.SMALL_CODE = CM.CHECK_METHOD_TYPE) AS ATTRIBUTE1
			      ,(SELECT SC.ATTRIBUTE2
			          FROM CB_SMALL_CODE SC
			         WHERE 1=1
			           AND SC.ORG_ID = CM.ORG_ID
			           AND SC.COMPANY_ID = CM.COMPANY_ID
			           AND SC.BIG_CODE = 'QM'
			           AND SC.MIDDLE_CODE = 'CHECK_METHOD_TYPE'
			           AND SC.SMALL_CODE = CM.CHECK_METHOD_TYPE) AS ATTRIBUTE2
			  FROM (
			        SELECT RANK() OVER(ORDER BY SV.ORG_ID, SV.COMPANY_ID, SV.SHIP_INS_NO, SV.CHECK_METHOD_TYPE_NAME) AS RN
			              ,SV.ORG_ID AS ORG_ID
			              ,SV.COMPANY_ID AS COMPANY_ID
			              ,SV.CHECK_METHOD_TYPE AS CHECK_METHOD_TYPE
			              ,SV.CHECK_METHOD_TYPE_NAME AS CHECK_METHOD_TYPE_NAME
			          FROM CB_SHIPMENT_INSPECTION_D_V SV
			         WHERE 1=1
			           AND SV.ORG_ID = #ORGID#
			           AND SV.COMPANY_ID = #COMPANYID#
			           AND SV.SHIP_INS_NO = #SHIPINSNO#
			         GROUP BY SV.ORG_ID, SV.COMPANY_ID, SV.SHIP_INS_NO, SV.CHECK_METHOD_TYPE, SV.CHECK_METHOD_TYPE_NAME
			           ) CM
			      ,(SELECT LEVEL AS RN
			          FROM DUAL
			        CONNECT BY LEVEL <= 7) TMP
			 WHERE 1=1
			   AND TMP.RN = CM.RN (+)
			 ORDER BY TMP.RN
      ]]>
    </select>
    
    <select id="report.ship.insp.flutek.sub2.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
			SELECT CB_REPORT_PKG.CB_CHECK_HISTORY_NO_FIND(CH.ORG_ID
			                                             ,CH.COMPANY_ID
			                                             ,CH.ITEM_CODE
			                                             ,CH.CHECK_BIG
			                                             ,CH.HISTORY_ID
			                                             ,5
			                                              ) AS RN
			      ,CH.ORG_ID AS ORGID
			      ,CH.COMPANY_ID AS COMPANYID
			      ,CH.ITEM_CODE AS ITEMCODE
			      ,CH.CHECK_BIG AS CHECKBIG
			      ,CH.MARK AS MARKNUMBER
			      ,TO_CHAR(CH.EFFECTIVE_START_DATE, 'YYYY/MM/DD') AS CHANGEDATE
			      ,CH.CHANGE_DESCRIPTION AS CHANGECONTENT
			      ,CH.CHANGE_PERSON AS CHARGENAME
			      ,CH.APPROVAL_PERSON AS APPROVOLNAME
			  FROM CB_CHECK_HISTORY CH
			 WHERE 1 = 1
			   AND CH.ORG_ID = #ORGID#
			   AND CH.COMPANY_ID = #COMPANYID#
			   AND CH.ITEM_CODE = (SELECT SIV.ITEM_CODE
			                         FROM CB_SHIPMENT_INSPECTION_H_V SIV
			                        WHERE 1=1
			                          AND SIV.SHIP_INS_NO = #SHIPINSNO#
			                       )
			   AND CH.CHECK_BIG = 'O'
			   AND SYSDATE BETWEEN CH.EFFECTIVE_START_DATE AND CH.EFFECTIVE_END_DATE
			   AND CB_REPORT_PKG.CB_CHECK_HISTORY_NO_FIND(CH.ORG_ID
			                                             ,CH.COMPANY_ID
			                                             ,CH.ITEM_CODE
			                                             ,CH.CHECK_BIG
			                                             ,CH.HISTORY_ID
			                                             ,5
			                                              ) BETWEEN 1 AND 5
      ]]>
    </select>
    
    <sql id="report.insp.work.check.sheet.list.sql-select">
    <![CDATA[
    SELECT SUM(REAL_NUM) AS COUNT
      FROM (
            SELECT RANK() OVER(ORDER BY ORG_ID, COMPANY_ID, ITEM_CODE, WORK_ORDER_ID, WORK_ORDER_SEQ, REAL_NUM) AS RN
                  ,ORG_ID
                  ,COMPANY_ID
                  ,ITEM_CODE
                  ,WORK_ORDER_ID
                  ,WORK_ORDER_SEQ
                  ,X_NUM
                  ,CHECK_BIG
                  ,REAL_NUM
              FROM (
                    SELECT RANK() OVER(ORDER BY ORG_ID, COMPANY_ID, ITEM_CODE, WORK_ORDER_ID, WORK_ORDER_SEQ) AS RN
                          ,ORG_ID
                          ,COMPANY_ID
                          ,ITEM_CODE
                          ,WORK_ORDER_ID
                          ,WORK_ORDER_SEQ
                          ,CHECK_BIG
                          ,MAX(X_NUM) AS X_NUM
                      FROM (
                            SELECT RANK() OVER(ORDER BY A.ORG_ID, A.COMPANY_ID, A.ITEM_CODE, A.WORK_ORDER_ID, A.WORK_ORDER_SEQ, A.FML_ID, A.EMPLOYEE_SEQ , A.ORDER_NO, A.CHECK_LIST_ID, TMP.X_NUM) AS RN
                                  ,A.ORG_ID
                                  ,A.COMPANY_ID
                                  ,A.ITEM_CODE
                                  ,A.WORK_ORDER_ID
                                  ,A.WORK_ORDER_SEQ
                                  ,A.FML_ID
                                  ,A.EMPLOYEE_SEQ
                                  ,A.ORDER_NO
                                  ,A.CHECK_LIST_ID
                                  ,A.CHECK_BIG
                                  ,TMP.X_NUM
                              FROM (
                                  SELECT FCR.ORG_ID
                                        ,FCR.COMPANY_ID
                                        ,FCR.ITEM_CODE
                                        ,FCR.WORK_ORDER_ID
                                        ,FCR.WORK_ORDER_SEQ
                                        ,FCM.EMPLOYEE_SEQ
                                        ,FCR.FML_ID
                                        ,FCR.ORDER_NO
                                        ,CM.ORDER_NO AS ORDER_NO1
                                        ,FCR.CHECK_LIST_ID
                                        ,FCM.CHECK_BIG
                                        ,CB_MFG_PKG.CB_FML_CHECK_QTY(FCR.ORG_ID
                                                                    ,FCR.COMPANY_ID
                                                                    ,FCR.FML_ID
                                                                    ,FCR.ORDER_NO) AS TOTAL_QTY
                                    FROM CB_WORK_ORDER_HEADER WOH
                                        ,CB_WORK_ORDER WO
                                        ,CB_FML_CHECK_MASTER FCM
                                        ,CB_FML_CHECK_RESULT FCR
                                        ,CB_CHECK_MASTER CM
                                        ,(SELECT #ORGID# AS ORG_ID
                                                ,#COMPANYID# AS COMPANY_ID
                                                ,#ITEMCODE# AS ITEM_CODE
                                                ,#ROUTINGID# AS ROUTING_ID
                                                ,#CHECKBIG# AS CHECK_BIG
                                                ,TO_DATE(#SEARCHFROM#, 'YYYY-MM-DD') AS SEARCH_FROM
                                                ,TO_DATE(#SEARCHTO#, 'YYYY-MM-DD') AS SEARCH_TO
                                                ,NULL AS CUSTOMER_CODE
                                                ,'동평테크' AS CUSTOMER_NAME
                                                ,#WORKORDERID# AS WORK_ORDER_ID
                                                ,#WORKORDERSEQ# AS WORK_ORDER_SEQ
                                                ,#EMPLOYEESEQ# AS EMPLOYEE_SEQ
                                            FROM DUAL) TMP
                                   WHERE 1=1
                                     AND WOH.ORG_ID = WO.ORG_ID
                                     AND WOH.COMPANY_ID = WO.COMPANY_ID
                                     AND WOH.WORK_ORDER_ID = WO.WORK_ORDER_ID
                                     AND WO.ORG_ID = FCM.ORG_ID
                                     AND WO.COMPANY_ID = FCM.COMPANY_ID
                                     AND WO.WORK_ORDER_ID = FCM.WORK_ORDER_ID
                                     AND WO.WORK_ORDER_SEQ = FCM.WORK_ORDER_SEQ
                                     AND FCM.ORG_ID = FCR.ORG_ID
                                     AND FCM.COMPANY_ID = FCR.COMPANY_ID
                                     AND FCM.WORK_ORDER_ID = FCR.WORK_ORDER_ID
                                     AND FCM.WORK_ORDER_SEQ = FCR.WORK_ORDER_SEQ
                                     AND FCR.ORG_ID = CM.ORG_ID
                                     AND FCR.COMPANY_ID = CM.COMPANY_ID
                                     AND FCR.ITEM_CODE = CM.ITEM_CODE
                                     AND FCR.CHECK_LIST_ID = CM.CHECK_SEQ
                                     AND FCM.FML_ID = FCR.FML_ID
                                     AND WO.WORK_STATUS IN ('END', 'COMPLETE')
                                     AND CB_MFG_PKG.CB_FML_CHECK_QTY(FCR.ORG_ID
                                                                    ,FCR.COMPANY_ID
                                                                    ,FCR.FML_ID
                                                                    ,FCR.ORDER_NO) > 0
                                     AND FCR.ORG_ID = TMP.ORG_ID
                                     AND FCR.COMPANY_ID = TMP.COMPANY_ID
                                     AND FCR.ITEM_CODE = TMP.ITEM_CODE
                                     AND FCM.ROUTING_ID = TMP.ROUTING_ID
                                     AND TO_DATE((TO_CHAR(FCM.CHECK_DATE, 'YYYY-MM-DD') || ' ' || FCM.CHECK_START_TIME), 'YYYY-MM-DD HH24:MI')
                                           BETWEEN TO_DATE((TO_CHAR(TMP.SEARCH_FROM, 'YYYY-MM-DD') || ' 07:30'), 'YYYY-MM-DD HH24:MI')
                                           AND TO_DATE((TO_CHAR(TMP.SEARCH_TO + 1, 'YYYY-MM-DD') || ' 07:30'), 'YYYY-MM-DD HH24:MI')
                                   ) A
                                  ,(SELECT LEVEL AS X_NUM
                                      FROM DUAL
                                   CONNECT BY LEVEL <= 50) TMP
                             WHERE 1=1
                               AND TMP.X_NUM <= A.TOTAL_QTY
                             ORDER BY A.ORG_ID, A.COMPANY_ID, A.ITEM_CODE, A.WORK_ORDER_ID, A.WORK_ORDER_SEQ, A.FML_ID, A.EMPLOYEE_SEQ , A.ORDER_NO, A.CHECK_LIST_ID, TMP.X_NUM
                             ) OA
                     WHERE 1=1
                     GROUP BY ORG_ID, COMPANY_ID, ITEM_CODE, WORK_ORDER_ID, WORK_ORDER_SEQ, CHECK_BIG
                     ) GA
                    ,(SELECT LEVEL AS REAL_NUM
                        FROM DUAL
                     CONNECT BY LEVEL <= 50) TMP
             WHERE 1=1
               AND TMP.REAL_NUM <= GA.X_NUM
             ORDER BY ORG_ID, COMPANY_ID, ITEM_CODE, WORK_ORDER_ID, WORK_ORDER_SEQ, CHECK_BIG, REAL_NUM
             ) SA
    ]]>
    </sql>
    
    <sql id="report.insp.work.check.sheet.list.sql-where">
    <![CDATA[
     WHERE 1 = 1
    ]]>
    </sql>
    
    <select id="report.insp.work.check.sheet.list.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
       <include refid="report.insp.work.check.sheet.list.sql-select" />
       <include refid="report.insp.work.check.sheet.list.sql-where" />
    </select>
    
    <select id="report.insp.work.check.sheet.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    <![CDATA[
    SELECT TMP.RN AS RN
		      ,TMP.ORG_ID AS ORGID
		      ,TMP.COMPANY_ID AS COMPANYID
		      ,NULL AS EQUIPMENTCODE
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO
		                                            ,'EQUIPMENT_NAME') AS EQUIPMENTNAME
		      ,NULL AS CUSTOMERCODE
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO
		                                            ,'CUSTOMER_NAME') AS CUSTOMERNAME
		      ,TMP.ITEM_CODE AS ITEMCODE
		      ,IM.ORDER_NAME AS ORDERNAME
		      ,IM.ITEM_NAME AS ITEMNAME
		      ,IM.CAR_TYPE AS MODEL
		      ,IM.CAR_TYPE_NAME AS MODELNAME
		      ,DECODE(IM.DRAWING_NO
		             ,NULL, NULL
		             ,CONCAT('(', IM.DRAWING_NO) || ')') AS DRAWINGNO
		      ,IM.MANAGEMENT_NUMBER AS MANAGENUMBER
		      ,TMP.CHECK_BIG AS CHECKBIG
		      ,TMP.ROUTING_ID AS ROUTINGID
		      ,DECODE(TMP.RN
		             ,1, GA.ROUTING_NO
		             ,NULL) AS ROUTINGNO
		      ,DECODE(TMP.RN
		             ,1, GA.ROUTING_OP
		             ,NULL) AS ROUTINGOP
		      ,DECODE(TMP.RN
		             ,1, GA.ROUTING_NAME
		             ,NULL) AS ROUTINGNAME
		      ,NVL(GA.ORDER_NO, TMP.RN) AS ORDERNO
		      ,GA.CHECK_MIDDLE AS CHECKMIDDLE
		      ,GA.CHECK_MIDDLE_NAME AS CHECKMIDDLENAME
		      ,GA.CHECK_SMALL AS CHECKSMALL
		      ,GA.CHECK_SMALL_NAME AS CHECKSMALLNAME
		      ,GA.STANDARD_VALUE AS STANDARDVALUE
		      ,GA.MAX_VALUE AS MAXVALUE
		      ,GA.MIN_VALUE AS MINVALUE
		      ,GA.EXT_STANDARD AS EXTSTANDARD
		      ,GA.CHECK_METHOD_TYPE AS CHECKMETHODTYPE
		      ,GA.CHECK_METHOD_TYPE_NAME AS CHECKMETHODTYPENAME
		      ,GA.CHECK_CYCLE AS CHECKCYCLE
		      ,GA.CHECK_CYCLE_NAME AS CHECKCYCLENAME
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO
		                                            ,'DATE') AS CHECKDATE1
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 1
		                                            ,'DATE') AS CHECKDATE2
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 2
		                                            ,'DATE') AS CHECKDATE3
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 3
		                                            ,'DATE') AS CHECKDATE4
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 4
		                                            ,'DATE') AS CHECKDATE5
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 5
		                                            ,'DATE') AS CHECKDATE6
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 6
		                                            ,'DATE') AS CHECKDATE7
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 7
		                                            ,'DATE') AS CHECKDATE8
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 8
		                                            ,'DATE') AS CHECKDATE9
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 9
		                                            ,'DATE') AS CHECKDATE10
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 10
		                                            ,'DATE') AS CHECKDATE11
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 11
		                                            ,'DATE') AS CHECKDATE12
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 12
		                                            ,'DATE') AS CHECKDATE13
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 13
		                                            ,'DATE') AS CHECKDATE14
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 14
		                                            ,'DATE') AS CHECKDATE15
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 15
		                                            ,'DATE') AS CHECKDATE16
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO
		                                            ,'WORKER') AS CHECKWORKER1
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 1
		                                            ,'WORKER') AS CHECKWORKER2
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 2
		                                            ,'WORKER') AS CHECKWORKER3
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 3
		                                            ,'WORKER') AS CHECKWORKER4
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 4
		                                            ,'WORKER') AS CHECKWORKER5
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 5
		                                            ,'WORKER') AS CHECKWORKER6
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 6
		                                            ,'WORKER') AS CHECKWORKER7
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 7
		                                            ,'WORKER') AS CHECKWORKER8
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 8
		                                            ,'WORKER') AS CHECKWORKER9
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 9
		                                            ,'WORKER') AS CHECKWORKER10
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 10
		                                            ,'WORKER') AS CHECKWORKER11
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 11
		                                            ,'WORKER') AS CHECKWORKER12
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 12
		                                            ,'WORKER') AS CHECKWORKER13
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 13
		                                            ,'WORKER') AS CHECKWORKER14
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 14
		                                            ,'WORKER') AS CHECKWORKER15
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 15
		                                            ,'WORKER') AS CHECKWORKER16
		      ,GA.CHECK_RESULT1 AS CHECKRESULT1
		      ,GA.CHECK_RESULT2 AS CHECKRESULT2
		      ,GA.CHECK_RESULT3 AS CHECKRESULT3
		      ,GA.CHECK_RESULT4 AS CHECKRESULT4
		      ,GA.CHECK_RESULT5 AS CHECKRESULT5
		      ,GA.CHECK_RESULT6 AS CHECKRESULT6
		      ,GA.CHECK_RESULT7 AS CHECKRESULT7
		      ,GA.CHECK_RESULT8 AS CHECKRESULT8
		      ,GA.CHECK_RESULT9 AS CHECKRESULT9
		      ,GA.CHECK_RESULT10 AS CHECKRESULT10
		      ,GA.CHECK_RESULT11 AS CHECKRESULT11
		      ,GA.CHECK_RESULT12 AS CHECKRESULT12
		      ,GA.CHECK_RESULT13 AS CHECKRESULT13
		      ,GA.CHECK_RESULT14 AS CHECKRESULT14
		      ,GA.CHECK_RESULT15 AS CHECKRESULT15
		      ,GA.CHECK_RESULT16 AS CHECKRESULT16
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO
		                                            ,'LOT_NO') AS CHECKLOT1
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 1
		                                            ,'LOT_NO') AS CHECKLOT2
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 2
		                                            ,'LOT_NO') AS CHECKLOT3
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 3
		                                            ,'LOT_NO') AS CHECKLOT4
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 4
		                                            ,'LOT_NO') AS CHECKLOT5
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 5
		                                            ,'LOT_NO') AS CHECKLOT6
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 6
		                                            ,'LOT_NO') AS CHECKLOT7
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 7
		                                            ,'LOT_NO') AS CHECKLOT8
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 8
		                                            ,'LOT_NO') AS CHECKLOT9
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 9
		                                            ,'LOT_NO') AS CHECKLOT10
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 10
		                                            ,'LOT_NO') AS CHECKLOT11
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 11
		                                            ,'LOT_NO') AS CHECKLOT12
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 12
		                                            ,'LOT_NO') AS CHECKLOT13
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 13
		                                            ,'LOT_NO') AS CHECKLOT14
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 14
		                                            ,'LOT_NO') AS CHECKLOT15
		      ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(TMP.ORG_ID
		                                            ,TMP.COMPANY_ID
		                                            ,TMP.ITEM_CODE
		                                            ,TMP.ROUTING_ID
		                                            ,GA.CHECK_LIST_ID
		                                            ,TMP.CHECK_BIG
		                                            ,TMP.WORK_ORDER_ID
		                                            ,TMP.WORK_ORDER_SEQ
		                                            ,TMP.EMPLOYEE_SEQ
		                                            ,TMP.SEARCH_FROM
		                                            ,TMP.SEARCH_TO
		                                            ,TMP.COL_NO + 15
		                                            ,'LOT_NO') AS CHECKLOT16
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,1
		                                           ,'NO') AS REVNO1
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,2
		                                           ,'NO') AS REVNO2
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,3
		                                           ,'NO') AS REVNO3
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,4
		                                           ,'NO') AS REVNO4
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,5
		                                           ,'NO') AS REVNO5
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,6
		                                           ,'NO') AS REVNO6
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,7
		                                           ,'NO') AS REVNO7
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,1
		                                           ,'DATE') AS REVDATE1
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,2
		                                           ,'DATE') AS REVDATE2
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,3
		                                           ,'DATE') AS REVDATE3
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,4
		                                           ,'DATE') AS REVDATE4
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,5
		                                           ,'DATE') AS REVDATE5
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,6
		                                           ,'DATE') AS REVDATE6
		      ,CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                           ,TMP.COMPANY_ID
		                                           ,TMP.ITEM_CODE
		                                           ,TMP.ROUTING_ID
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,7
		                                           ,'DATE') AS REVDATE7
		      ,(SELECT CONCAT('D:' || CF.FILEPATHREAL, CF.FILENMREAL)
		          FROM CB_ITEM_FILE CIF
		              ,CB_FILE CF
		         WHERE 1 = 1
		           AND CF.FILEID = CIF.FILEID
		           AND CIF.FILETYPE = 'check'
		           AND CIF.GUBUN = 'Image4'
		           AND CIF.CHECK_BIG = 'F'
		           AND CIF.ITEM_CODE = TMP.ITEM_CODE) AS FILEIMAGE
		      ,NULL AS REMARKS
		      ,'작업자 매회 확인, 이상 치수 확인시 (빨강색 체크)후 생산, 품질관리에게 통보할 것!' AS NOTE
		      ,'DPQP305-7(1)' || CB_REPORT_PKG.CB_REVISION_CHECK_FIND(TMP.ORG_ID
		                                                             ,TMP.COMPANY_ID
		                                                             ,TMP.ITEM_CODE
		                                                             ,TMP.ROUTING_ID
		                                                             ,TMP.SEARCH_FROM
		                                                             ,TMP.SEARCH_TO
		                                                             ,1
		                                                             ,'REV_NO') AS FOOTERLEFTINFO
		      ,NULL AS FOOTERCENTERINFO
		      ,'A4(210x297mm)' AS FOOTERRIGHTINFO
		  FROM (
		        SELECT RANK() OVER(ORDER BY WV.ORG_ID, WV.COMPANY_ID, WV.ITEM_CODE, WV.CHECK_BIG, WV.ORDER_NO) RN
		              ,WV.ORG_ID AS ORG_ID
		              ,WV.COMPANY_ID AS COMPANY_ID
		              ,WV.ITEM_CODE AS ITEM_CODE
		              ,WV.CHECK_LIST_ID AS CHECK_LIST_ID
		              ,WV.CHECK_BIG AS CHECK_BIG
		              ,WV.ROUTING_ID AS ROUTING_ID
		              ,WV.ROUTING_NO AS ROUTING_NO
		              ,WV.ROUTING_OP AS ROUTING_OP
		              ,WV.ROUTING_NAME AS ROUTING_NAME
		              ,WV.ORDER_NO AS ORDER_NO
		              ,WV.CHECK_MIDDLE AS CHECK_MIDDLE
		              ,WV.CHECK_MIDDLE_NAME AS CHECK_MIDDLE_NAME
		              ,WV.CHECK_SMALL AS CHECK_SMALL
		              ,WV.CHECK_SMALL_NAME AS CHECK_SMALL_NAME
		              ,WV.STANDARD_VALUE AS STANDARD_VALUE
		              ,WV.MAX_VALUE AS MAX_VALUE
		              ,WV.MIN_VALUE AS MIN_VALUE
		              ,WV.EXT_STANDARD AS EXT_STANDARD
		              ,WV.CHECK_METHOD_TYPE AS CHECK_METHOD_TYPE
		              ,WV.CHECK_METHOD_TYPE_NAME AS CHECK_METHOD_TYPE_NAME
		              ,WV.CHECK_CYCLE AS CHECK_CYCLE
		              ,WV.CHECK_CYCLE_NAME AS CHECK_CYCLE_NAME
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT1
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 1
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT2
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 2
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT3
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 3
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT4
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 4
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT5
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 5
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT6
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 6
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT7
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 7
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT8
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 8
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT9
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 9
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT10
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 10
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT11
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 11
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT12
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 12
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT13
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 13
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT14
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 14
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT15
		              ,CB_REPORT_PKG.CB_WORK_INSP_CHECK_FIND(WV.ORG_ID
		                                                    ,WV.COMPANY_ID
		                                                    ,WV.ITEM_CODE
		                                                    ,WV.ROUTING_ID
		                                                    ,WV.CHECK_LIST_ID
		                                                    ,WV.CHECK_BIG
		                                                    ,TMP.WORK_ORDER_ID
		                                                    ,TMP.WORK_ORDER_SEQ
		                                                    ,TMP.EMPLOYEE_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,TMP.COL_NO + 15
		                                                    ,'CHECK_RESULT') AS CHECK_RESULT16
		          FROM CB_WORK_ORDER_HISTORY_REPORT_V WV
		                 ,(SELECT #ORGID# AS ORG_ID
		                         ,#COMPANYID# AS COMPANY_ID
		                         ,#ITEMCODE# AS ITEM_CODE
		                         ,#ROUTINGID# AS ROUTING_ID
		                         ,#CHECKBIG# AS CHECK_BIG
		                         ,#SEARCHFROM# AS SEARCH_FROM
		                         ,#SEARCHTO# AS SEARCH_TO
		                         ,NULL AS CUSTOMER_CODE
		                         ,'동평테크' AS CUSTOMER_NAME
		                         ,#WORKORDERID# AS WORK_ORDER_ID
		                         ,#WORKORDERSEQ# AS WORK_ORDER_SEQ
		                         ,#EMPLOYEESEQ# AS EMPLOYEE_SEQ
		                         ,#COLNO# AS COL_NO
		                     FROM DUAL) TMP
		         WHERE 1=1
		           AND WV.CHECK_BIG = TMP.CHECK_BIG
               AND (WV.ORG_ID, WV.COMPANY_ID, WV.ITEM_CODE, WV.ROUTING_ID) IN (SELECT WO.ORG_ID, WO.COMPANY_ID, WO.ITEM_CODE, WO.ROUTING_CODE
														                                                                                 FROM CB_WORK_ORDER WO
														                                                                                     ,(SELECT TRIM(REGEXP_SUBSTR(WORK_ORDER_ID, '[^,]+', 1, LEVEL)) AS WORK_ORDER_ID
														                                                                                             ,TRIM(REGEXP_SUBSTR(WORK_ORDER_SEQ, '[^,]+', 1, LEVEL)) AS WORK_ORDER_SEQ
														                                                                                         FROM (SELECT #WORKORDERID# AS WORK_ORDER_ID
															                                                                                                         ,#WORKORDERSEQ# AS WORK_ORDER_SEQ
															                                                                                                 FROM DUAL )
														                                                                                       CONNECT BY (INSTR(WORK_ORDER_ID, ',', 1, LEVEL - 1) > 0
														                                                                                                OR INSTR(WORK_ORDER_SEQ, ',', 1, LEVEL - 1) > 0)) TMP1
														                                                                                WHERE 1=1
														                                                                                  AND WO.ORG_ID = TMP.ORG_ID
														                                                                                  AND WO.COMPANY_ID = TMP.COMPANY_ID
														                                                                                  AND WO.ITEM_CODE = TMP.ITEM_CODE
														                                                                                  AND WO.ROUTING_CODE = TMP.ROUTING_ID
														                                                                                  AND WO.WORK_ORDER_ID IN ( NVL(TMP1.WORK_ORDER_ID, WO.WORK_ORDER_ID) )
														                                                                                  AND TO_CHAR(WO.WORK_ORDER_SEQ) IN ( NVL(TMP1.WORK_ORDER_SEQ, WO.WORK_ORDER_SEQ) )
														                                                                                GROUP BY WO.ORG_ID, WO.COMPANY_ID, WO.ITEM_CODE, WO.ROUTING_CODE
														                                                                               )
		         ORDER BY WV.ORG_ID, WV.COMPANY_ID, WV.ITEM_CODE, WV.CHECK_BIG, WV.ORDER_NO
		         ) GA
		      ,CB_ITEM_MASTER_V IM
		      ,(SELECT LEVEL AS RN
		              ,#ORGID# AS ORG_ID
		              ,#COMPANYID# AS COMPANY_ID
		              ,#ITEMCODE# AS ITEM_CODE
		              ,#ROUTINGID# AS ROUTING_ID
		              ,#CHECKBIG# AS CHECK_BIG
		              ,#SEARCHFROM# AS SEARCH_FROM
		              ,#SEARCHTO# AS SEARCH_TO
		              ,NULL AS CUSTOMER_CODE
		              ,'동평테크' AS CUSTOMER_NAME
		              ,#WORKORDERID# AS WORK_ORDER_ID
		              ,#WORKORDERSEQ# AS WORK_ORDER_SEQ
		              ,#EMPLOYEESEQ# AS EMPLOYEE_SEQ
		              ,#COLNO# AS COL_NO
		          FROM DUAL
		        CONNECT BY LEVEL BETWEEN ( ( ( $PAGECNT$ - 1 ) * 10 ) + 1 ) AND ( $PAGECNT$ * 10 ) ) TMP
		 WHERE 1=1
		   AND TMP.ORG_ID = IM.ORG_ID
		   AND TMP.COMPANY_ID = IM.COMPANY_ID
		   AND TMP.ITEM_CODE = IM.ITEM_CODE
		   AND TMP.RN = GA.RN (+)
		 ORDER BY TMP.ITEM_CODE, TMP.ROUTING_ID, TMP.RN
    ]]>
    </select>
    
    <select id="report.proc.capa.worksheet.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    <![CDATA[
    SELECT PV.LOGO_IMAGE AS LOGOIMAGE
				      ,PV.TITLE_NAME AS TITLENAME
				      ,PV.SUB_TITLE_NAME AS SUBTITLENAME
				      ,PV.WRITE_DATE AS WRITEDATE
				      ,PV.DEPARTMENT_CODE AS DEPARTMENTCODE
				      ,PV.DEPARTMENT_NAME AS DEPARTMENTNAME
				      ,PV.ANALYST_EMPLOYEE AS ANALYSTEMPLOYEE
				      ,PV.ANALYST_NAME AS ANALYSTNAME
				      ,PV.ORG_ID AS ORGID
				      ,PV.COMPANY_ID AS COMPANYID
				      ,PV.ITEM_CODE AS ITEMCODE
				      ,PV.CHECK_LIST_ID AS CHECKLISTID
				      ,PV.CHECK_BIG AS CHECKBIG
				      ,PV.MODEL AS MODEL
				      ,PV.MODEL_NAME AS MODELNAME
				      ,PV.ORDER_NAME AS ORDERNAME
				      ,PV.ITEM_NAME AS ITEMNAME
				      ,PV.STANDARD_VALUE AS STANDARDVALUE
				      ,PV.MAX_VALUE AS MAXVALUE
				      ,PV.MIN_VALUE AS MINVALUE
				      ,PV.ROUTING_ID AS ROUTINGID
				      ,PV.ROUTING_NO AS ROUTINGNO
				      ,PV.ROUTING_NAME AS ROUTINGNAME
				      ,PV.ROUTING_OP AS ROUTINGOP
				      ,PV.ROUTING_GROUP_NAME AS ROUTINGGROUPNAME
				      ,PV.CHK1 AS CHK1
				      ,PV.CHK1_NAME AS CHK1NAME
				      ,PV.CHK2 AS CHK2
				      ,PV.CHK2_NAME AS CHK2NAME
				      ,PV.CHK3 AS CHK3
				      ,PV.CHK3_NAME AS CHK3NAME
				      ,PV.CHK4 AS CHK4
				      ,PV.CHK4_NAME_FIRST AS CHK4NAMEFIRST
				      ,PV.CHK4_REMARKS AS CHK4REMARKS
				      ,PV.CHK4_NAME_LAST AS CHK4NAMELAST
				
				      ,PV.IMAGE01
				      ,PV.IMAGE02
				      ,PV.IMAGE03
				      ,PV.IMAGE04
				      ,PV.IMAGE05
				      ,PV.IMAGE06
				      ,PV.IMAGE07
				      ,PV.IMAGE08
				      ,PV.IMAGE09
				      ,PV.IMAGE10
				      ,PV.IMAGE11
				      ,PV.IMAGE12
				      ,PV.IMAGE13
				      ,PV.IMAGE14
				      ,PV.IMAGE15
				      ,PV.IMAGE16
				      ,PV.IMAGE17
				      ,PV.IMAGE18
				      ,PV.BOX_REMARKS AS BOXREMARKS
				
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'AVERAGE_TOTAL'
				                                           ,1
				                                            ) AS ROUTINGAVERAGE
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'DEV_TOTAL'
				                                           ,1
				                                            ) AS DEVAVERAGE
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'SAMPLE_COUNT'
				                                           ,1
				                                            ) AS SAMPLECOUNT
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'USL'
				                                           ,1
				                                            ) AS USL
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'LSL'
				                                           ,1
				                                            ) AS LSL
				
				      ,'n' AS SPCNUMBERTITLE
				      ,'d2' AS SPCCALCTITLE
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0)) - 3
				                                              ,'N') AS SPCNUMBER1
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0)) - 3
				                                              ,'VALUE') AS SPCCALC1
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0)) - 2
				                                              ,'N') AS SPCNUMBER2
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0)) - 2
				                                              ,'VALUE') AS SPCCALC2
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0)) - 1
				                                              ,'N') AS SPCNUMBER3
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0)) - 1
				                                              ,'VALUE') AS SPCCALC3
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0))
				                                              ,'N') AS SPCNUMBER4
				      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(PV.ORG_ID
				                                              ,PV.COMPANY_ID
				                                              ,'d2'
				                                              ,TO_NUMBER(NVL(CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                                                                             ,PV.COMPANY_ID
				                                                                                             ,PV.ITEM_CODE
				                                                                                             ,PV.ROUTING_ID
				                                                                                             ,PV.CHECK_LIST_ID
				                                                                                             ,TMP.SEARCH_FROM
				                                                                                             ,TMP.SEARCH_TO
				                                                                                             ,'SAMPLE_COUNT'
				                                                                                             ,1
				                                                                                              ), 0))
				                                              ,'VALUE') AS SPCCALC4
				
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'DEVIATION'
				                                           ,1
				                                            ) AS DEV
				
				      ,NUMBER6 AS NUMBER6
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'CP'
				                                           ,1
				                                            ) AS CP
				
				      ,NUMBER3 AS NUMBER3
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'CPL'
				                                           ,1
				                                            ) AS CPL
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'CPU'
				                                           ,1
				                                            ) AS CPU
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(PV.ORG_ID
				                                           ,PV.COMPANY_ID
				                                           ,PV.ITEM_CODE
				                                           ,PV.ROUTING_ID
				                                           ,PV.CHECK_LIST_ID
				                                           ,TMP.SEARCH_FROM
				                                           ,TMP.SEARCH_TO
				                                           ,'CPK'
				                                           ,1
				                                            ) AS CPK
				
				      ,PV.PAGE_TITLE1 AS PAGETITLE1
				      ,PV.PAGE_TITLE2 AS PAGETITLE2
				      ,PV.PAGE_TITLE2_SUB1 AS PAGETITLE2SUB1
				      ,PV.PAGE_TITLE2_SUB2 AS PAGETITLE2SUB2
				      ,PV.FOOTER_LEFT_INFO AS FOOTERLEFTINFO
				      ,PV.FOOTER_CENTER_INFO AS FOOTERCENTERINFO
				      ,PV.FOOTER_RIGHT_INFO AS FOOTERRIGHTINFO
		  FROM CB_PROC_CAPA_SHEET_BASE_V PV
				      ,(SELECT #ORGID# AS ORG_ID
				              ,#COMPANYID# AS COMPANY_ID
				              ,#ITEMCODE# AS ITEM_CODE
				              ,#CHECKLISTID# AS CHECK_LIST_ID
				              ,#CHECKBIG# AS CHECK_BIG
				              ,TO_DATE(#SEARCHFROM#, 'YYYY-MM-DD') AS SEARCH_FROM
				              ,TO_DATE(#SEARCHTO#, 'YYYY-MM-DD') AS SEARCH_TO
				          FROM DUAL) TMP
		 WHERE 1=1
		   AND PV.ORG_ID = TMP.ORG_ID
		   AND PV.COMPANY_ID = TMP.COMPANY_ID
		   AND PV.ITEM_CODE = TMP.ITEM_CODE
		   AND PV.CHECK_LIST_ID = TMP.CHECK_LIST_ID
    ]]>
    </select>
    
    <select id="report.spc.control.chart.main.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT CM.ORG_ID AS ORGID
		      ,LOGO_IMAGE AS LOGOIMAGE
		      ,TITLE_NAME AS TITLENAME
		      ,ORG_TITLE AS ORGTITLE
		      ,ORG_NAME AS ORGNAME
		      ,CM.COMPANY_ID AS COMPANYID
		      ,CM.ITEM_CODE AS ITEMCODE
		      ,CM.CHECK_SEQ AS CHECKSEQ
		      ,ROUTING_TITLE AS ROUTINGTITLE
		      ,CM.ROUTING_ID AS ROUTINGID
		      ,ROUTING_NO AS ROUTINGNO
		      ,ROUTING_NAME AS ROUTINGNAME
		      ,DEPARTMENT_TITLE AS DEPARTMENTTITLE
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,1
		                                                    ,'DEPT_NAME'
		                                                     ) AS DEPARTMENTNAME
		      ,WRITE_TITLE AS WRITETITLE
		      ,WRITE_DATE AS WRITEDATE
		      ,WORK_TITLE AS WORKTITLE
		      ,WORK_NAME AS WORKNAME
		      ,SPECIAL_TITLE AS SPECIALTITLE
		      ,SPECIAL_REMARKS AS SPECIALREMARKS
		      ,MANAGE_TITLE AS MANAGETITLE
		      ,STANDARD_VALUE AS STANDARDVALUE
		      ,MAX_VALUE AS MAXVALUE
		      ,MIN_VALUE AS MINVALUE
		      ,WORKER_TITLE AS WORKERTITLE
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,1
		                                                    ,'KR_NAME'
		                                                     ) AS WORKERNAME
		      ,TECH_TITLE AS TECHTITLE
		      ,CHECK_CYCLE_TITLE AS CHECKCYCLETITLE
		      ,CHECK_CYCLE AS CHECKCYCLE
		      ,CHECK_CYCLE_NAME AS CHECKCYCLENAME
		      ,MODEL_TITLE AS MODELTITLE
		      ,MODEL AS MODEL
		      ,MODEL_NAME AS MODELNAME
		      ,ITEM_TITLE AS ITEMTITLE
		      ,ITEM_NAME AS ITEMNAME
		      ,AVG_TITLE AS AVGTITLE
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE_TOTAL'
		                                           ,1) AS AVGVALUE
		      ,UCL_TITLE AS UCLTITLE
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'USL'
		                                           ,1) AS UCLVALUE
		      ,LCL_TITLE LCLTITLE
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'LSL'
		                                           ,1) AS LCLVALUE
		      ,DEV_TITLE AS DEVTITLE
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEV_TOTAL'
		                                           ,1) AS DEVVALUE
		      ,UCR_TITLE AS UCRTITLE
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'UCR'
		                                           ,1) AS UCRVALUE
		      ,LCR_TITLE AS LCRTITLE
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'LCR'
		                                           ,1) AS LCRVALUE
		      ,COL_TITLE1 AS COLTITLE1
		      ,COL_TITLE2 AS COLTITLE2
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) AS SAMPLECOUNT
		      ,COL_TITLE3 AS COLTITLE3
		      ,COL_TITLE4 AS COLTITLE4
		      ,COL_TITLE5 AS COLTITLE5
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,1
		                                                    ,'VALUE'
		                                                     ) AS X1
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,2
		                                                    ,'VALUE'
		                                                     ) AS X2
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,3
		                                                    ,'VALUE'
		                                                     ) AS X3
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,4
		                                                    ,'VALUE'
		                                                     ) AS X4
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,5
		                                                    ,'VALUE'
		                                                     ) AS X5
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,6
		                                                    ,'VALUE'
		                                                     ) AS X6
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,7
		                                                    ,'VALUE'
		                                                     ) AS X7
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,8
		                                                    ,'VALUE'
		                                                     ) AS X8
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,9
		                                                    ,'VALUE'
		                                                     ) AS X9
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,10
		                                                    ,'VALUE'
		                                                     ) AS X10
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,11
		                                                    ,'VALUE'
		                                                     ) AS X11
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,12
		                                                    ,'VALUE'
		                                                     ) AS X12
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,13
		                                                    ,'VALUE'
		                                                     ) AS X13
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,14
		                                                    ,'VALUE'
		                                                     ) AS X14
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,15
		                                                    ,'VALUE'
		                                                     ) AS X15
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,16
		                                                    ,'VALUE'
		                                                     ) AS X16
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,17
		                                                    ,'VALUE'
		                                                     ) AS X17
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,18
		                                                    ,'VALUE'
		                                                     ) AS X18
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,19
		                                                    ,'VALUE'
		                                                     ) AS X19
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,20
		                                                    ,'VALUE'
		                                                     ) AS X20
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,21
		                                                    ,'VALUE'
		                                                     ) AS X21
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,22
		                                                    ,'VALUE'
		                                                     ) AS X22
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,23
		                                                    ,'VALUE'
		                                                     ) AS X23
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,24
		                                                    ,'VALUE'
		                                                     ) AS X24
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,25
		                                                    ,'VALUE'
		                                                     ) AS X25
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,26
		                                                    ,'VALUE'
		                                                     ) AS X26
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,27
		                                                    ,'VALUE'
		                                                     ) AS X27
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,28
		                                                    ,'VALUE'
		                                                     ) AS X28
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,29
		                                                    ,'VALUE'
		                                                     ) AS X29
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,30
		                                                    ,'VALUE'
		                                                     ) AS X30
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,31
		                                                    ,'VALUE'
		                                                     ) AS X31
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,32
		                                                    ,'VALUE'
		                                                     ) AS X32
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,33
		                                                    ,'VALUE'
		                                                     ) AS X33
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,34
		                                                    ,'VALUE'
		                                                     ) AS X34
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,35
		                                                    ,'VALUE'
		                                                     ) AS X35
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,36
		                                                    ,'VALUE'
		                                                     ) AS X36
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,37
		                                                    ,'VALUE'
		                                                     ) AS X37
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,38
		                                                    ,'VALUE'
		                                                     ) AS X38
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,39
		                                                    ,'VALUE'
		                                                     ) AS X39
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,40
		                                                    ,'VALUE'
		                                                     ) AS X40
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,41
		                                                    ,'VALUE'
		                                                     ) AS X41
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,42
		                                                    ,'VALUE'
		                                                     ) AS X42
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,43
		                                                    ,'VALUE'
		                                                     ) AS X43
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,44
		                                                    ,'VALUE'
		                                                     ) AS X44
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,45
		                                                    ,'VALUE'
		                                                     ) AS X45
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,46
		                                                    ,'VALUE'
		                                                     ) AS X46
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,47
		                                                    ,'VALUE'
		                                                     ) AS X47
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,48
		                                                    ,'VALUE'
		                                                     ) AS X48
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,49
		                                                    ,'VALUE'
		                                                     ) AS X49
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,50
		                                                    ,'VALUE'
		                                                     ) AS X50
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,51
		                                                    ,'VALUE'
		                                                     ) AS X51
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,52
		                                                    ,'VALUE'
		                                                     ) AS X52
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,53
		                                                    ,'VALUE'
		                                                     ) AS X53
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,54
		                                                    ,'VALUE'
		                                                     ) AS X54
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,55
		                                                    ,'VALUE'
		                                                     ) AS X55
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,56
		                                                    ,'VALUE'
		                                                     ) AS X56
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,57
		                                                    ,'VALUE'
		                                                     ) AS X57
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,58
		                                                    ,'VALUE'
		                                                     ) AS X58
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,59
		                                                    ,'VALUE'
		                                                     ) AS X59
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,60
		                                                    ,'VALUE'
		                                                     ) AS X60
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,61
		                                                    ,'VALUE'
		                                                     ) AS X61
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,62
		                                                    ,'VALUE'
		                                                     ) AS X62
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,63
		                                                    ,'VALUE'
		                                                     ) AS X63
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,64
		                                                    ,'VALUE'
		                                                     ) AS X64
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,65
		                                                    ,'VALUE'
		                                                     ) AS X65
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,66
		                                                    ,'VALUE'
		                                                     ) AS X66
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,67
		                                                    ,'VALUE'
		                                                     ) AS X67
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,68
		                                                    ,'VALUE'
		                                                     ) AS X68
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,69
		                                                    ,'VALUE'
		                                                     ) AS X69
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,70
		                                                    ,'VALUE'
		                                                     ) AS X70
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,71
		                                                    ,'VALUE'
		                                                     ) AS X71
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,72
		                                                    ,'VALUE'
		                                                     ) AS X72
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,73
		                                                    ,'VALUE'
		                                                     ) AS X73
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,74
		                                                    ,'VALUE'
		                                                     ) AS X74
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,75
		                                                    ,'VALUE'
		                                                     ) AS X75
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,76
		                                                    ,'VALUE'
		                                                     ) AS X76
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,77
		                                                    ,'VALUE'
		                                                     ) AS X77
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,78
		                                                    ,'VALUE'
		                                                     ) AS X78
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,79
		                                                    ,'VALUE'
		                                                     ) AS X79
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,80
		                                                    ,'VALUE'
		                                                     ) AS X80
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,81
		                                                    ,'VALUE'
		                                                     ) AS X81
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,82
		                                                    ,'VALUE'
		                                                     ) AS X82
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,83
		                                                    ,'VALUE'
		                                                     ) AS X83
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,84
		                                                    ,'VALUE'
		                                                     ) AS X84
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,85
		                                                    ,'VALUE'
		                                                     ) AS X85
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,86
		                                                    ,'VALUE'
		                                                     ) AS X86
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,87
		                                                    ,'VALUE'
		                                                     ) AS X87
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,88
		                                                    ,'VALUE'
		                                                     ) AS X88
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,89
		                                                    ,'VALUE'
		                                                     ) AS X89
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,90
		                                                    ,'VALUE'
		                                                     ) AS X90
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,91
		                                                    ,'VALUE'
		                                                     ) AS X91
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,92
		                                                    ,'VALUE'
		                                                     ) AS X92
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,93
		                                                    ,'VALUE'
		                                                     ) AS X93
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,94
		                                                    ,'VALUE'
		                                                     ) AS X94
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,95
		                                                    ,'VALUE'
		                                                     ) AS X95
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,96
		                                                    ,'VALUE'
		                                                     ) AS X96
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,97
		                                                    ,'VALUE'
		                                                     ) AS X97
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,98
		                                                    ,'VALUE'
		                                                     ) AS X98
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,99
		                                                    ,'VALUE'
		                                                     ) AS X99
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,100
		                                                    ,'VALUE'
		                                                     ) AS X100
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,101
		                                                    ,'VALUE'
		                                                     ) AS X101
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,102
		                                                    ,'VALUE'
		                                                     ) AS X102
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,103
		                                                    ,'VALUE'
		                                                     ) AS X103
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,104
		                                                    ,'VALUE'
		                                                     ) AS X104
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,105
		                                                    ,'VALUE'
		                                                     ) AS X105
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,106
		                                                    ,'VALUE'
		                                                     ) AS X106
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,107
		                                                    ,'VALUE'
		                                                     ) AS X107
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,108
		                                                    ,'VALUE'
		                                                     ) AS X108
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,109
		                                                    ,'VALUE'
		                                                     ) AS X109
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,110
		                                                    ,'VALUE'
		                                                     ) AS X110
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,111
		                                                    ,'VALUE'
		                                                     ) AS X111
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,112
		                                                    ,'VALUE'
		                                                     ) AS X112
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,113
		                                                    ,'VALUE'
		                                                     ) AS X113
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,114
		                                                    ,'VALUE'
		                                                     ) AS X114
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,115
		                                                    ,'VALUE'
		                                                     ) AS X115
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,116
		                                                    ,'VALUE'
		                                                     ) AS X116
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,117
		                                                    ,'VALUE'
		                                                     ) AS X117
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,118
		                                                    ,'VALUE'
		                                                     ) AS X118
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,119
		                                                    ,'VALUE'
		                                                     ) AS X119
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,120
		                                                    ,'VALUE'
		                                                     ) AS X120
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,121
		                                                    ,'VALUE'
		                                                     ) AS X121
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,122
		                                                    ,'VALUE'
		                                                     ) AS X122
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,123
		                                                    ,'VALUE'
		                                                     ) AS X123
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,124
		                                                    ,'VALUE'
		                                                     ) AS X124
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CHECK_DATA_FIND(CM.ORG_ID
		                                                    ,CM.COMPANY_ID
		                                                    ,CM.ITEM_CODE
		                                                    ,CM.CHECK_SEQ
		                                                    ,TMP.SEARCH_FROM
		                                                    ,TMP.SEARCH_TO
		                                                    ,125
		                                                    ,'VALUE'
		                                                     ) AS X125
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,1
		                                            ) AS SUM1
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,2
		                                            ) AS SUM2
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,3
		                                            ) AS SUM3
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,4
		                                            ) AS SUM4
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,5
		                                            ) AS SUM5
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,6
		                                            ) AS SUM6
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,7
		                                            ) AS SUM7
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,8
		                                            ) AS SUM8
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,9
		                                            ) AS SUM9
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,10
		                                            ) AS SUM10
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,11
		                                            ) AS SUM11
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,12
		                                            ) AS SUM12
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,13
		                                            ) AS SUM13
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,14
		                                            ) AS SUM14
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,15
		                                            ) AS SUM15
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,16
		                                            ) AS SUM16
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,17
		                                            ) AS SUM17
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,18
		                                            ) AS SUM18
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,19
		                                            ) AS SUM19
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,20
		                                            ) AS SUM20
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,21
		                                            ) AS SUM21
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,22
		                                            ) AS SUM22
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,23
		                                            ) AS SUM23
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,24
		                                            ) AS SUM24
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SUM'
		                                           ,25
		                                            ) AS SUM25
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,1
		                                            ) AS AVG1
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,2
		                                            ) AS AVG2
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,3
		                                            ) AS AVG3
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,4
		                                            ) AS AVG4
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,5
		                                            ) AS AVG5
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,6
		                                            ) AS AVG6
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,7
		                                            ) AS AVG7
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,8
		                                            ) AS AVG8
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,9
		                                            ) AS AVG9
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,10
		                                            ) AS AVG10
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,11
		                                            ) AS AVG11
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,12
		                                            ) AS AVG12
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,13
		                                            ) AS AVG13
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,14
		                                            ) AS AVG14
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,15
		                                            ) AS AVG15
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,16
		                                            ) AS AVG16
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,17
		                                            ) AS AVG17
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,18
		                                            ) AS AVG18
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,19
		                                            ) AS AVG19
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,20
		                                            ) AS AVG20
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,21
		                                            ) AS AVG21
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,22
		                                            ) AS AVG22
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,23
		                                            ) AS AVG23
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,24
		                                            ) AS AVG24
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'AVERAGE'
		                                           ,25
		                                            ) AS AVG25
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,1
		                                            ) AS DEV1
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,2
		                                            ) AS DEV2
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,3
		                                            ) AS DEV3
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,4
		                                            ) AS DEV4
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,5
		                                            ) AS DEV5
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,6
		                                            ) AS DEV6
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,7
		                                            ) AS DEV7
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,8
		                                            ) AS DEV8
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,9
		                                            ) AS DEV9
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,10
		                                            ) AS DEV10
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,11
		                                            ) AS DEV11
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,12
		                                            ) AS DEV12
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,13
		                                            ) AS DEV13
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,14
		                                            ) AS DEV14
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,15
		                                            ) AS DEV15
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,16
		                                            ) AS DEV16
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,17
		                                            ) AS DEV17
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,18
		                                            ) AS DEV18
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,19
		                                            ) AS DEV19
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,20
		                                            ) AS DEV20
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,21
		                                            ) AS DEV21
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,22
		                                            ) AS DEV22
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,23
		                                            ) AS DEV23
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,24
		                                            ) AS DEV24
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'DEVIATION_AVERAGE'
		                                           ,25
		                                            ) AS DEV25
		      ,BOTTOM_COL_TITLE1 AS BOTTOMCOLTITLE1
		      ,BOTTOM_COL_TITLE2 AS BOTTOMCOLTITLE2
		      ,BOTTOM_COL_TITLE3 AS BOTTOMCOLTITLE3
		      ,BOTTOM_COL_TITLE4 AS BOTTOMCOLTITLE4
		      ,BOTTOM_CONTENT1 AS BOTTOMCONTENT1
		      ,BOTTOM_CONTENT2 AS BOTTOMCONTENT2
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) - 3 AS NO1
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) - 2 AS NO2
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) - 1 AS NO3
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) AS NO4
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) + 1 AS NO5
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) + 2 AS NO6
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'SAMPLE_COUNT'
		                                           ,1) + 3 AS NO7
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'A2'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 3
		                                              ,'VALUE') AS A21
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'A2'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 2
		                                              ,'VALUE') AS A22
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'A2'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 1
		                                              ,'VALUE') AS A23
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'A2'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1)
		                                              ,'VALUE') AS A24
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'A2'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 1
		                                              ,'VALUE') AS A25
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'A2'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 2
		                                              ,'VALUE') AS A26
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'A2'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 3
		                                              ,'VALUE') AS A27
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D3'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 3
		                                              ,'VALUE') AS D31
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D3'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 2
		                                              ,'VALUE') AS D32
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D3'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 1
		                                              ,'VALUE') AS D33
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D3'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1)
		                                              ,'VALUE') AS D34
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D3'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 1
		                                              ,'VALUE') AS D35
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D3'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 2
		                                              ,'VALUE') AS D36
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D3'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 3
		                                              ,'VALUE') AS D37
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D4'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 3
		                                              ,'VALUE') AS D41
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D4'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 2
		                                              ,'VALUE') AS D42
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D4'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) - 1
		                                              ,'VALUE') AS D43
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D4'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1)
		                                              ,'VALUE') AS D44
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D4'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 1
		                                              ,'VALUE') AS D45
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D4'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 2
		                                              ,'VALUE') AS D46
		      ,CB_COMMON_STANDARD_PKG.CB_SPC_CALC_FIND(CM.ORG_ID
		                                              ,CM.COMPANY_ID
		                                              ,'D4'
		                                              ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                                                                   ,CM.COMPANY_ID
		                                                                                   ,CM.ITEM_CODE
		                                                                                   ,CM.ROUTING_ID
		                                                                                   ,CM.CHECK_SEQ
		                                                                                   ,TMP.SEARCH_FROM
		                                                                                   ,TMP.SEARCH_TO
		                                                                                   ,'SAMPLE_COUNT'
		                                                                                   ,1) + 3
		                                              ,'VALUE') AS D47
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'CP'
		                                           ,1
		                                            ) AS CP
		      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(CM.ORG_ID
		                                           ,CM.COMPANY_ID
		                                           ,CM.ITEM_CODE
		                                           ,CM.ROUTING_ID
		                                           ,CM.CHECK_SEQ
		                                           ,TMP.SEARCH_FROM
		                                           ,TMP.SEARCH_TO
		                                           ,'CPK'
		                                           ,1
		                                            ) AS CPK
		      ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
		      ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
		      ,FOOTER_RIGHT_INFO AS FOOTERRIGHTINFO
		
		  FROM CB_SPC_BASE_REPORT_V CM
		      ,(SELECT #ORGID# AS ORG_ID
		              ,#COMPANYID# AS COMPANY_ID
		              ,#ITEMCODE# AS ITEM_CODE
		              ,#CHECKLISTID# AS CHECK_LIST_ID
		              ,TO_DATE(#SEARCHFROM#, 'YYYY-MM-DD') AS SEARCH_FROM
		              ,TO_DATE(#SEARCHTO#, 'YYYY-MM-DD') AS SEARCH_TO
		          FROM DUAL) TMP
		 WHERE 1=1
		   AND CM.ORG_ID = TMP.ORG_ID
		   AND CM.COMPANY_ID = TMP.COMPANY_ID
		   AND CM.ITEM_CODE = TMP.ITEM_CODE
		   AND CM.CHECK_SEQ = TMP.CHECK_LIST_ID
      ]]>
    </select>
    
    <select id="report.spc.control.chart.sub1.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT '평균' AS GUBUN
				      ,LEV AS RN
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'AVERAGE_TOTAL'
				                                           ,1
				                                            ) AS VALUE
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'USL'
				                                           ,1
				                                            ) AS USL
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'LSL'
				                                           ,1
				                                            ) AS LSL
		  FROM (SELECT LEVEL AS LEV
		              ,#ORGID# AS ORG_ID
		              ,#COMPANYID# AS COMPANY_ID
		              ,#ITEMCODE# AS ITEM_CODE
		              ,#CHECKLISTID# AS CHECK_LIST_ID
		              ,TO_DATE(#SEARCHFROM#, 'YYYY-MM-DD') AS SEARCH_FROM
		              ,TO_DATE(#SEARCHTO#, 'YYYY-MM-DD') AS SEARCH_TO
		          FROM DUAL
		       CONNECT BY LEVEL <= 25) TMP
		 WHERE 1=1
		 UNION ALL
		SELECT '값' AS GUBUN
				      ,LEV AS RN
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'AVERAGE'
				                                           ,LEV
				                                            ) AS VALUE
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'USL'
				                                           ,1
				                                            ) AS USL
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'LSL'
				                                           ,1
				                                            ) AS LSL
		FROM (SELECT LEVEL AS LEV
		            ,#ORGID# AS ORG_ID
		            ,#COMPANYID# AS COMPANY_ID
		            ,#ITEMCODE# AS ITEM_CODE
		            ,#CHECKLISTID# AS CHECK_LIST_ID
		            ,TO_DATE(#SEARCHFROM#, 'YYYY-MM-DD') AS SEARCH_FROM
		            ,TO_DATE(#SEARCHTO#, 'YYYY-MM-DD') AS SEARCH_TO
		        FROM DUAL
		     CONNECT BY LEVEL <= 25) TMP
		WHERE 1=1
      ]]>
    </select>
    
    <select id="report.spc.control.chart.sub2.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
      <![CDATA[
      SELECT '평균' AS GUBUN
				      ,LEV AS RN
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'DEV_TOTAL'
				                                           ,1
				                                            ) AS VALUE
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'UCR'
				                                           ,1
				                                            ) AS USL
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'LCR'
				                                           ,1
				                                            ) AS LSL
		  FROM (SELECT LEVEL AS LEV
		              ,#ORGID# AS ORG_ID
		              ,#COMPANYID# AS COMPANY_ID
		              ,#ITEMCODE# AS ITEM_CODE
		              ,#CHECKLISTID# AS CHECK_LIST_ID
		              ,TO_DATE(#SEARCHFROM#, 'YYYY-MM-DD') AS SEARCH_FROM
		              ,TO_DATE(#SEARCHTO#, 'YYYY-MM-DD') AS SEARCH_TO
		          FROM DUAL
		       CONNECT BY LEVEL <= 25) TMP
		 WHERE 1=1
		 UNION ALL
		SELECT '값' AS GUBUN
				      ,LEV AS RN
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'DEVIATION_AVERAGE'
				                                           ,LEV
				                                            ) AS VALUE
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'UCR'
				                                           ,1
				                                            ) AS USL
				      ,CB_REPORT_PKG.CB_SPC_CALC_CHECK_FIND(ORG_ID
				                                           ,COMPANY_ID
				                                           ,ITEM_CODE
				                                           ,NULL
				                                           ,CHECK_LIST_ID
				                                           ,SEARCH_FROM
				                                           ,SEARCH_TO
				                                           ,'LCR'
				                                           ,1
				                                            ) AS LSL
		FROM (SELECT LEVEL AS LEV
		            ,#ORGID# AS ORG_ID
		            ,#COMPANYID# AS COMPANY_ID
		            ,#ITEMCODE# AS ITEM_CODE
		            ,#CHECKLISTID# AS CHECK_LIST_ID
		            ,TO_DATE(#SEARCHFROM#, 'YYYY-MM-DD') AS SEARCH_FROM
		            ,TO_DATE(#SEARCHTO#, 'YYYY-MM-DD') AS SEARCH_TO
		        FROM DUAL
		     CONNECT BY LEVEL <= 25) TMP
		WHERE 1=1
      ]]>
    </select>
    
    <select id="report.scm.out.checksheet.report.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
			SELECT RANK() OVER(ORDER BY DV.ORGID, DV.COMPANYID, DV.INSPECTIONPLANNO, DV.INSPECTIONSEQ) AS RN
			      ,DV.ORGID AS ORGID
			      ,DV.COMPANYID AS COMPANYID
			      ,DV.INSPECTIONPLANNO AS INSPECTIONPLANNO
			      ,DV.INSPECTIONSEQ AS INSPECTIONSEQ
			      ,TO_CHAR(DH.INSPECTIONDATE, 'MM/DD') AS CHECKDATE1
			      ,DH.WORKORDERID AS WORKORDERID
			      ,DH.WORKORDERSEQ AS WORKORDERSEQ
			      ,(SELECT EM.EQUIPMENT_NAME
			           FROM CB_EQUIPMENT_MASTER EM
			          WHERE EM.ORG_ID = WO.ORG_ID
			            AND EM.COMPANY_ID = WO.COMPANY_ID
			            AND EM.EQUIPMENT_CODE = WO.EQUIPMENT_CODE) AS EQUIPMENTNAME
			      ,DH.CARTYPE AS MODEL
			      ,DH.CARTYPENAME AS MODELNAME
			      ,DH.MANAGEMENTNUMBER AS MANAGENUMBER
			      ,DH.ORDERNO AS ORDERNO
			      ,DH.ORDERSEQ AS ORDERSEQ
			      ,DH.ROUTINGOP AS ROUTINGOP
			      ,DH.ROUTINGNAME AS ROUTINGNAME
			      ,DH.CUSTOMERCODE AS CUSTOMERCODE
			      ,DH.CUSTOMERNAME AS CUSTOMERNAME
			      ,DH.CUSTOMERNAME AS CHECKWORKER1
			      ,DH.ORDERQTY AS ORDERQTY
			      ,DH.CHECKQTY AS CHECKQTY
			      ,DH.PASSQTY AS PASSQTY
			      ,DH.FAILQTY AS FAILQTY
			      ,DH.CHECKYN AS CHECKYN
			      ,DH.CHECKYNNAME AS CHECKYNNAME
			      ,DH.REMARKS AS REMARKS
			      ,DV.CHECKSEQ AS CHECKSEQ
			      ,DV.ITEMCODE AS ITEMCODE
			      ,DV.ITEMNAME AS ITEMNAME
			      ,DV.DRAWINGNO AS DRAWINGNO
			      ,DV.ORDERNAME AS ORDERNAME
			      ,DH.MANAGEMENTNUMBER AS MANAGEMENTNUMBER
			      ,DV.CHECKBIG AS CHECKBIG
			      ,DV.CHECKBIGNAME AS CHECKBIGNAME
			      ,DV.CHECKMIDDLE AS CHECKMIDDLE
			      ,DV.CHECKMIDDLENAME AS CHECKMIDDLENAME
			      ,DV.CHECKSMALL AS CHECKSMALL
			      ,DV.CHECKSMALLNAME AS CHECKSMALLNAME
			      ,DV.CHECKUOM AS CHECKUOM
			      ,DV.UOMNAME AS UOMNAME
			      ,DV.UOM AS UOM
			      ,DV.CHECKSTANDARD AS CHECKSTANDARD
			      ,DV.STANDARDVALUE AS STANDARDVALUE
			      ,DV.MAXVALUE AS MAXVALUE
			      ,DV.MINVALUE AS MINVALUE
			      ,DV.CHECKMETHODTYPE AS CHECKMETHODTYPE
			      ,DV.CHECKMETHODTYPENAME AS CHECKMETHODTYPENAME
			      ,DV.CHECKCYCLE AS CHECKCYCLE
			      ,DV.CHECKCYCLENAME AS CHECKCYCLENAME
			      ,'0' AS REVNO1
			      ,'2016-02-17' AS REVDATE1
			      ,DV.CHECKQTY AS CHECKQTY
			      ,DV.CHECKRESULT1 AS CHECKRESULT1
			      ,DV.CHECKRESULT2 AS CHECKRESULT2
			      ,DV.CHECKRESULT3 AS CHECKRESULT3
			      ,DV.CHECKRESULT4 AS CHECKRESULT4
			      ,DV.CHECKRESULT5 AS CHECKRESULT5
			      ,DV.CHECKYN AS CHECKYN
			      ,DV.CHECKYNNAME AS CHECKYNNAME
			      ,DV.REMARKS AS DETAILREMARKS
			      ,(SELECT CONCAT('D:' || CF.FILEPATHREAL, CF.FILENMREAL)
			          FROM CB_FILE CF
			         INNER JOIN CB_ITEM_FILE i
			            ON (i.FILEID = CF.FILEID)
			         WHERE i.ITEM_CODE = DV.ITEMCODE
			           AND i.FILETYPE = 'check'
			           AND i.GUBUN = 'Image4'
			           AND i.CHECK_BIG = 'L') AS FILEIMAGE
			      ,'작업자 매회 확인, 이상 치수 확인시 (빨강색 체크)후 생산, 품질관리에게 통보할 것!' AS NOTE
			      ,'DPQP305-7(1)(REV.0)' AS FOOTERLEFTINFO
			      ,NULL AS FOOTERCENTERINFO
			      ,'A4(210x297mm)' AS FOOTERRIGHTINFO         
			  FROM CB_SCM_INSPECTION_H_V DH
			      ,CB_SCM_INSPECTION_D_V DV
			      ,CB_WORK_ORDER WO
			 WHERE DH.ORGID = DV.ORGID
			   AND DH.COMPANYID = DV.COMPANYID
			   AND DH.INSPECTIONPLANNO = DV.INSPECTIONPLANNO
			   AND DH.ORGID = WO.ORG_ID
			   AND DH.COMPANYID = WO.COMPANY_ID
			   AND DH.WORKORDERID = WO.WORK_ORDER_ID
			   AND DH.WORKORDERSEQ = WO.WORK_ORDER_SEQ   
			   AND DV.ORGID = #ORGID#
			   AND DV.COMPANYID = #COMPANYID#
			   AND DV.INSPECTIONPLANNO = #INSPECTIONPLANNO#
			 ORDER BY DV.ORGID, DV.COMPANYID, DV.INSPECTIONPLANNO, DV.INSPECTIONSEQ
    </select>
    
    <select id="report.scm.mat.checksheet.report.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
			SELECT RANK() OVER(ORDER BY SD.ORGID, SD.COMPANYID, SD.INSPECTIONPLANNO, SD.INSPECTIONSEQ) AS RN
			      ,SD.ORGID AS ORGID
			      ,SD.COMPANYID AS COMPANYID
			      ,SD.INSPECTIONPLANNO AS INSPECTIONPLANNO
			      ,SD.INSPECTIONSEQ AS INSPECTIONSEQ
			      ,TO_CHAR(SH.INSPECTIONDATE, 'MM/DD') AS CHECKDATE1
			      ,SH.CARTYPE AS MODEL
			      ,SH.CARTYPENAME AS MODELNAME
			      ,SH.MANAGEMENTNUMBER AS MANAGENUMBER
			      ,SH.ORDERNO AS ORDERNO
			      ,SH.ORDERSEQ AS ORDERSEQ
			      ,SH.ROUTINGOP AS ROUTINGOP
			      ,SH.ROUTINGNAME AS ROUTINGNAME
			      ,SH.CUSTOMERCODE AS CUSTOMERCODE
			      ,SH.CUSTOMERNAME AS CUSTOMERNAME
			      ,SH.CUSTOMERNAME AS CHECKWORKER1
			      ,SH.ORDERQTY AS ORDERQTY
			      ,SH.CHECKQTY AS CHECKQTY
			      ,SH.PASSQTY AS PASSQTY
			      ,SH.FAILQTY AS FAILQTY
			      ,SH.CHECKYN AS CHECKYN
			      ,SH.CHECKYNNAME AS CHECKYNNAME
			      ,SH.REMARKS AS REMARKS
			      ,SD.CHECKSEQ AS CHECKSEQ
			      ,SD.ITEMCODE AS ITEMCODE
			      ,SD.ITEMNAME AS ITEMNAME
			      ,SD.DRAWINGNO AS DRAWINGNO
			      ,SD.ORDERNAME AS ORDERNAME
			      ,SH.MANAGEMENTNUMBER AS MANAGEMENTNUMBER
			      ,SD.CHECKBIG AS CHECKBIG
			      ,SD.CHECKBIGNAME AS CHECKBIGNAME
			      ,SD.CHECKMIDDLE AS CHECKMIDDLE
			      ,SD.CHECKMIDDLENAME AS CHECKMIDDLENAME
			      ,SD.CHECKSMALL AS CHECKSMALL
			      ,SD.CHECKSMALLNAME AS CHECKSMALLNAME
			      ,SD.CHECKUOM AS CHECKUOM
			      ,SD.UOMNAME AS UOMNAME
			      ,SD.UOM AS UOM
			      ,SD.CHECKSTANDARD AS CHECKSTANDARD
			      ,SD.STANDARDVALUE AS STANDARDVALUE
			      ,SD.MAXVALUE AS MAXVALUE
			      ,SD.MINVALUE AS MINVALUE
			      ,SD.CHECKMETHODTYPE AS CHECKMETHODTYPE
			      ,SD.CHECKMETHODTYPENAME AS CHECKMETHODTYPENAME
			      ,SD.CHECKCYCLE AS CHECKCYCLE
			      ,SD.CHECKCYCLENAME AS CHECKCYCLENAME
			      ,'0' AS REVNO1
			      ,'2016-02-17' AS REVDATE1
			      ,SD.CHECKQTY AS CHECKQTY
			      ,SD.CHECKRESULT1 AS CHECKRESULT1
			      ,SD.CHECKRESULT2 AS CHECKRESULT2
			      ,SD.CHECKRESULT3 AS CHECKRESULT3
			      ,SD.CHECKRESULT4 AS CHECKRESULT4
			      ,SD.CHECKRESULT5 AS CHECKRESULT5
			      ,SD.CHECKYN AS CHECKYN
			      ,SD.CHECKYNNAME AS CHECKYNNAME
			      ,SD.REMARKS AS DETAILREMARKS
			      ,(SELECT CONCAT('D:' || CF.FILEPATHREAL, CF.FILENMREAL)
			          FROM CB_FILE CF
			         INNER JOIN CB_ITEM_FILE i
			            ON (i.FILEID = CF.FILEID)
			         WHERE i.ITEM_CODE = SD.ITEMCODE
			           AND i.FILETYPE = 'check'
			           AND i.GUBUN = 'Image4'
			           AND i.CHECK_BIG = 'L') AS FILEIMAGE
			      ,'작업자 매회 확인, 이상 치수 확인시 (빨강색 체크)후 생산, 품질관리에게 통보할 것!' AS NOTE
			      ,'DPQP305-7(1)(REV.0)' AS FOOTERLEFTINFO
			      ,NULL AS FOOTERCENTERINFO
			      ,'A4(210x297mm)' AS FOOTERRIGHTINFO
			  FROM CB_INSP_SCM_H_V SH
			      ,CB_INSP_SCM_D_V SD
			 WHERE 1 = 1
			   AND SH.ORGID = SD.ORGID
			   AND SH.COMPANYID = SD.COMPANYID
			   AND SH.INSPECTIONPLANNO = SD.INSPECTIONPLANNO
			   AND SH.ORGID = #ORGID#
			   AND SH.COMPANYID = #COMPANYID#
			   AND SH.INSPECTIONPLANNO = #INSPECTIONPLANNO#
			 ORDER BY SD.ORGID, SD.COMPANYID, SD.INSPECTIONPLANNO, SD.INSPECTIONSEQ
    </select>
    
    <select id="report.outside.order.select" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
			SELECT RANK() OVER(ORDER BY ORG_ID, COMPANY_ID, PO_NO, PO_SEQ) AS RN
			        ,ORG_ID AS ORGID
				      ,COMPANY_ID AS COMPANYID
				      ,PO_NO AS PONO
				      ,PO_DATE AS PODATE
				      ,PO_DATE1 AS PODATE1
				      ,CUSTOMER_CODE AS CUSTOMERCODE
				      ,CUSTOMER_NAME AS CUSTOMERNAME
				      ,CUSTOMER_PERSON AS CUSTOMERPERSON
				      ,CUSTOMER_PERSON_NAME AS CUSTOMERPERSONNAME
				      ,CUSTOMER_PERSON_PHONE AS CUSTOMERPERSONPHONE
				      ,LICENSE_NO AS LICENSENO
				      ,PHONE_NUMBER AS PHONENUMBER
				      ,FAX_NUMBER AS FAXNUMBER
				      ,REFER AS REFER
				      ,DUE_DATE AS DUEDATE
				      ,CUSTOMER_IMAGE AS CUSTOMERIMAGE
				      ,TO_CUSTOMER_CODE AS TOCUSTOMERCODE
				      ,TO_CUSTOMER_NAME AS TOCUSTOMERNAME
				      ,TO_LICENSE_NO AS TOLICENSENO
				      ,TO_OWNER AS TOOWNER
				      ,TO_ADDRESS AS TOADDRESS
				      ,TO_PHONE_NUMBER AS TOPHONENUMBER
				      ,TO_FAX_NUMBER AS TOFAXNUMBER
				      ,PO_PERSON AS POPERSON
				      ,PO_KR_NAME AS POKRNAME
				      ,PO_PHONE_NUMBER AS POPHONENUMBER
				      ,PO_DEPT_NAME AS PODEPTNAME
				      ,DISPLAY_TEXT AS DISPLAYTEXT
				      ,PO_SEQ AS POSEQ
				      ,ITEM_CODE AS ITEMCODE
				      ,ITEM_NAME AS ITEMNAME
				      ,ORDER_NAME AS ORDERNAME
				      ,ITEM_STANDARD AS ITEMSTANDARD
				      ,MODEL_NAME AS CARTYPENAME
				      ,ITEM_STANDARD_DETAIL AS ITEMSTANDARDDETAIL
				      ,UOM AS UOM
				      ,UOM_NAME AS UOMNAME
				      ,ORDER_QTY AS ORDERQTY
				      ,ROUTING_NAME AS ROUTINGNAME
				      ,DETAIL_REMARKS AS DETAILREMARKS
				      ,MOD_QTY AS MODQTY
				      ,TOTAL_ORDER_QTY AS TOTALORDERQTY
				      ,TOTAL_QTY AS TOTALQTY
				      ,REMARKS AS REMARKS
				      ,LOGO_IMAGE AS LOGOIMAGE
				      ,FOOTER_LEFT_INFO AS FOOTERLEFTINFO
				      ,FOOTER_CENTER_INFO AS FOOTERCENTERINFO
				      ,FOOTER_RIGHT_INFO AS FOOTERRIGHTINFO
			  FROM CB_OUT_ORDER_REPORT_V
			 WHERE ORG_ID = $searchOrgId$
	       AND COMPANY_ID = $searchCompanyId$
	       AND PO_NO = #PoNo#
    </select>
    
    <!--   -->
    <select id="report.CostStdSales.PerforList.main" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
        SELECT TMP.ORGID AS ORGID
				       ,TMP.COMPANYID AS COMPANYID
				       ,TMP.SEARCHYEAR AS SEARCHYEAR
				       ,'월별 매출 실적 (' || TMP.SEARCHYEAR || '년)' AS TITLE
			  FROM (
			SELECT $ORGID$ AS ORGID
            ,$COMPANYID$ AS COMPANYID
			      ,#SEARCHYEAR# AS SEARCHYEAR
			  FROM DUAL) TMP
    </select>
    
    <select id="report.CostStdSales.PerforList.sub1" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    <![CDATA[
    SELECT TMP.ORGID AS ORGID,
		       TMP.COMPANYID AS COMPANYID,
		       '월별 매출 실적(' || TMP.SEARCHYEAR || '년)' AS TITLE,
		       TMP.SEARCHNUM || '월' AS SEARCHYEAR,
		       NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,NULL
		                                          ,TMP.SEARCHYEAR
		                                          ,TMP.SEARCHNUM
		                                          ,'MONTHLY_TOTAL'), 0) AS TOTALMONTH
		  FROM (SELECT $ORGID$ AS ORGID
		              ,$COMPANYID$ AS COMPANYID
		              ,#SEARCHYEAR# AS SEARCHYEAR
		              ,LPAD(LEVEL, 2, '0') AS SEARCHNUM
		          FROM DUAL
		        CONNECT BY LEVEL <= 12) TMP
		 WHERE NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,NULL
		                                          ,TMP.SEARCHYEAR
		                                          ,NULL
		                                          ,'TOTAL'), 0) > 0
    ]]>
    </select>
    
    <select id="report.CostStdSales.PerforList.sub2" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    <![CDATA[
    SELECT 1 AS RN,
		       TMP.ORGID AS ORGID,
		       TMP.COMPANYID AS COMPANYID,
		       NULL AS LICENSENO,
		       NULL AS CUSTOMERCODE,
		       '업  체' AS CUSTOMERNAME,
		       TMP.SEARCHYEAR AS SEARCHYEAR,
		
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'01'
		                                      ,'MONTHLY_TOTAL') AS MONTH01,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'02'
		                                      ,'MONTHLY_TOTAL') AS MONTH02,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'03'
		                                      ,'MONTHLY_TOTAL') AS MONTH03,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'04'
		                                      ,'MONTHLY_TOTAL') AS MONTH04,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'05'
		                                      ,'MONTHLY_TOTAL') AS MONTH05,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'06'
		                                      ,'MONTHLY_TOTAL') AS MONTH06,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'07'
		                                      ,'MONTHLY_TOTAL') AS MONTH07,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'08'
		                                      ,'MONTHLY_TOTAL') AS MONTH08,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'09'
		                                      ,'MONTHLY_TOTAL') AS MONTH09,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'10'
		                                      ,'MONTHLY_TOTAL') AS MONTH10,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'11'
		                                      ,'MONTHLY_TOTAL') AS MONTH11,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,'12'
		                                      ,'MONTHLY_TOTAL') AS MONTH12,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TMP.SEARCHYEAR
		                                      ,NULL
		                                      ,'TOTAL') AS TOTALMONTH,
		       '월별 매출실적' AS MONTHPERFOR,
		       'TOTAL' AS MONTHTEXT,
		       '01월' AS MO1,
		       '02월' AS MO2,
		       '03월' AS MO3,
		       '04월' AS MO4,
		       '05월' AS MO5,
		       '06월' AS MO6,
		       '07월' AS MO7,
		       '08월' AS MO8,
		       '09월' AS MO9,
		       '10월' AS MO10,
		       '11월' AS MO11,
		       '12월' AS MO12
		      FROM (SELECT $ORGID$ AS ORGID
                      ,$COMPANYID$ AS COMPANYID
		                  ,#SEARCHYEAR# AS SEARCHYEAR
		              FROM DUAL) TMP
		     WHERE NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                              ,TMP.COMPANYID
		                                              ,NULL
		                                              ,TMP.SEARCHYEAR
		                                              ,NULL
		                                              ,'TOTAL'), 0) > 0
		 UNION ALL
		SELECT A.RN + 1 AS RN,
		       A.ORGID,
		       A.COMPANYID,
		       A.LICENSENO,
		       A.CUSTOMERCODE,
		       A.CUSTOMERNAME,
		       A.SEARCHYEAR,
		       A.MONTH01,
		       A.MONTH02,
		       A.MONTH03,
		       A.MONTH04,
		       A.MONTH05,
		       A.MONTH06,
		       A.MONTH07,
		       A.MONTH08,
		       A.MONTH09,
		       A.MONTH10,
		       A.MONTH11,
		       A.MONTH12,
		       A.TOTALMONTH,
		       '월별 매출실적' AS MONTHPERFOR,
		       'TOTAL' AS MONTHTEXT,
		       '01월' AS MO1,
		       '02월' AS MO2,
		       '03월' AS MO3,
		       '04월' AS MO4,
		       '05월' AS MO5,
		       '06월' AS MO6,
		       '07월' AS MO7,
		       '08월' AS MO8,
		       '09월' AS MO9,
		       '10월' AS MO10,
		       '11월' AS MO11,
		       '12월' AS MO12
		        FROM (
		       (SELECT RANK() OVER(ORDER BY NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                                       ,TMP.COMPANYID
		                                                                       ,CC.CUSTOMER_CODE
		                                                                       ,TMP.SEARCHYEAR
		                                                                       ,NULL
		                                                                       ,'TOTAL'), 0) DESC) AS RN,
		           CC.ORG_ID AS ORGID,
		           CC.COMPANY_ID AS COMPANYID,
		           CC.LICENSE_NO AS LICENSENO,
		           CC.CUSTOMER_CODE AS CUSTOMERCODE,
		           CC.CUSTOMER_NAME AS CUSTOMERNAME,
		           TMP.SEARCHYEAR AS SEARCHYEAR,
		
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'01'
		                                          ,'MONTHLY') AS MONTH01,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'02'
		                                          ,'MONTHLY') AS MONTH02,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'03'
		                                          ,'MONTHLY') AS MONTH03,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'04'
		                                          ,'MONTHLY') AS MONTH04,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'05'
		                                          ,'MONTHLY') AS MONTH05,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'06'
		                                          ,'MONTHLY') AS MONTH06,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'07'
		                                          ,'MONTHLY') AS MONTH07,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'08'
		                                          ,'MONTHLY') AS MONTH08,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'09'
		                                          ,'MONTHLY') AS MONTH09,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'10'
		                                          ,'MONTHLY') AS MONTH10,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'11'
		                                          ,'MONTHLY') AS MONTH11,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,'12'
		                                          ,'MONTHLY') AS MONTH12,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TMP.SEARCHYEAR
		                                          ,NULL
		                                          ,'TOTAL') AS TOTALMONTH
		      FROM CB_CUSTOMER CC
		          ,(SELECT $ORGID$ AS ORGID
                      ,$COMPANYID$ AS COMPANYID
		                  ,#SEARCHYEAR# AS SEARCHYEAR
		              FROM DUAL) TMP
		     WHERE CC.CUSTOMER_CODE <> '9999999999'
		       AND CC.CUSTOMER_TYPE IN ('A', 'S')
		       AND CC.USE_YN = 'Y'
		       AND CC.ORG_ID = TMP.ORGID
		       AND CC.COMPANY_ID = TMP.COMPANYID
		       AND NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                              ,TMP.COMPANYID
		                                              ,CC.CUSTOMER_CODE
		                                              ,TMP.SEARCHYEAR
		                                              ,NULL
		                                              ,'TOTAL'), 0) > 0
		     )) A
		 WHERE A.RN BETWEEN 1 AND 13
		
		UNION ALL
		
		SELECT 15 AS RN
		      ,ORGID
		      ,COMPANYID
		      ,NULL AS LICENSENO
		      ,NULL AS CUSTOMERCODE
		      ,'기  타' AS CUSTOMERNAME
		      ,SEARCHYEAR
		      ,SUM(MONTH01) AS MONTH01
		      ,SUM(MONTH02) AS MONTH02
		      ,SUM(MONTH03) AS MONTH03
		      ,SUM(MONTH04) AS MONTH04
		      ,SUM(MONTH05) AS MONTH05
		      ,SUM(MONTH06) AS MONTH06
		      ,SUM(MONTH07) AS MONTH07
		      ,SUM(MONTH08) AS MONTH08
		      ,SUM(MONTH09) AS MONTH09
		      ,SUM(MONTH10) AS MONTH10
		      ,SUM(MONTH11) AS MONTH11
		      ,SUM(MONTH12) AS MONTH12
		      ,SUM(TOTALMONTH) AS TOTALMONTH
		      ,'월별 매출실적' AS MONTHPERFOR
		      ,'TOTAL' AS MONTHTEXT
		      ,'01월' AS MO1
		      ,'02월' AS MO2
		      ,'03월' AS MO3
		      ,'04월' AS MO4
		      ,'05월' AS MO5
		      ,'06월' AS MO6
		      ,'07월' AS MO7
		      ,'08월' AS MO8
		      ,'09월' AS MO9
		      ,'10월' AS MO10
		      ,'11월' AS MO11
		      ,'12월' AS MO12
		  FROM (
		        SELECT A.ORGID,
		               A.COMPANYID,
		               A.LICENSENO,
		               A.CUSTOMERCODE,
		               A.CUSTOMERNAME,
		               A.SEARCHYEAR,
		               A.MONTH01,
		               A.MONTH02,
		               A.MONTH03,
		               A.MONTH04,
		               A.MONTH05,
		               A.MONTH06,
		               A.MONTH07,
		               A.MONTH08,
		               A.MONTH09,
		               A.MONTH10,
		               A.MONTH11,
		               A.MONTH12,
		               A.TOTALMONTH
		                FROM (
		               (SELECT RANK() OVER(ORDER BY NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                                               ,TMP.COMPANYID
		                                                                               ,CC.CUSTOMER_CODE
		                                                                               ,TMP.SEARCHYEAR
		                                                                               ,NULL
		                                                                               ,'TOTAL'), 0) DESC) AS RN,
		                   CC.ORG_ID AS ORGID,
		                   CC.COMPANY_ID AS COMPANYID,
		                   CC.LICENSE_NO AS LICENSENO,
		                   CC.CUSTOMER_CODE AS CUSTOMERCODE,
		                   CC.CUSTOMER_NAME AS CUSTOMERNAME,
		                   TMP.SEARCHYEAR AS SEARCHYEAR,
		
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'01'
		                                                  ,'MONTHLY') AS MONTH01,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'02'
		                                                  ,'MONTHLY') AS MONTH02,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'03'
		                                                  ,'MONTHLY') AS MONTH03,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'04'
		                                                  ,'MONTHLY') AS MONTH04,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'05'
		                                                  ,'MONTHLY') AS MONTH05,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'06'
		                                                  ,'MONTHLY') AS MONTH06,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'07'
		                                                  ,'MONTHLY') AS MONTH07,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'08'
		                                                  ,'MONTHLY') AS MONTH08,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'09'
		                                                  ,'MONTHLY') AS MONTH09,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'10'
		                                                  ,'MONTHLY') AS MONTH10,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'11'
		                                                  ,'MONTHLY') AS MONTH11,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,'12'
		                                                  ,'MONTHLY') AS MONTH12,
		                   CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                  ,TMP.COMPANYID
		                                                  ,CC.CUSTOMER_CODE
		                                                  ,TMP.SEARCHYEAR
		                                                  ,NULL
		                                                  ,'TOTAL') AS TOTALMONTH
		              FROM CB_CUSTOMER CC
		                  ,(SELECT $ORGID$ AS ORGID
                              ,$COMPANYID$ AS COMPANYID
		                          ,#SEARCHYEAR# AS SEARCHYEAR
		                      FROM DUAL) TMP
		             WHERE CC.CUSTOMER_CODE <> '9999999999'
		               AND CC.CUSTOMER_TYPE IN ('A', 'S')
		               AND CC.USE_YN = 'Y'
		               AND CC.ORG_ID = TMP.ORGID
		               AND CC.COMPANY_ID = TMP.COMPANYID
		               AND NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                      ,TMP.COMPANYID
		                                                      ,CC.CUSTOMER_CODE
		                                                      ,TMP.SEARCHYEAR
		                                                      ,NULL
		                                                      ,'TOTAL'), 0) > 0
		             )
		         ) A
		     WHERE A.RN > 13
		       ) GA
		 WHERE 1=1
		 GROUP BY ORGID, COMPANYID, SEARCHYEAR
		]]>
    </select>
    
    <select id="report.CostStdSales.PerforList.sub3" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    <![CDATA[
    SELECT TMP.ORGID AS ORGID,
		       TMP.COMPANYID AS COMPANYID,
		       '년도별 매출 실적' AS TITLE,
		       TO_CHAR(TO_NUMBER(TMP.SEARCHYEAR,'9999') - TMP.SEARCHNUM) || '년' AS SEARCHYEAR,
		       NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,NULL
		                                          ,TO_CHAR(TO_NUMBER(TMP.SEARCHYEAR,'9999') - TMP.SEARCHNUM)
		                                          ,NULL
		                                          ,'TOTAL'), 0) AS TOTALYEAR
		  FROM (SELECT $ORGID$ AS ORGID
                  ,$COMPANYID$ AS COMPANYID
		              ,#SEARCHYEAR# AS SEARCHYEAR
		              ,LEVEL - 1 AS SEARCHNUM
		          FROM DUAL
		        CONNECT BY LEVEL <= 3) TMP
		 WHERE NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,NULL
		                                          ,TMP.SEARCHYEAR
		                                          ,NULL
		                                          ,'TOTAL'), 0) > 0
		 ORDER BY SEARCHYEAR
		]]>
    </select>
    
    <select id="report.CostStdSales.PerforList.sub4" parameterClass="java.util.Map"
        resultClass="java.util.HashMap">
    <![CDATA[
    SELECT 1 AS RN,
		       TMP.ORGID AS ORGID,
		       TMP.COMPANYID AS COMPANYID,
		       NULL AS LICENSENO,
		       NULL AS CUSTOMERCODE,
		       '업  체' AS CUSTOMERNAME,
		       TO_CHAR(TMP.SEARCHYEAR-2) || '년' AS SEARCHYEAR1,
		       TO_CHAR(TMP.SEARCHYEAR-1) || '년' AS SEARCHYEAR2,
		       TO_CHAR(TMP.SEARCHYEAR) || '년' AS SEARCHYEAR3 ,
		       '년도별 매출실적' AS TITLE,
		       'TOTAL' AS TOTALTEXT,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TO_CHAR(TMP.SEARCHYEAR-2)
		                                      ,NULL
		                                      ,'TOTAL') AS TOTALYEAR1,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TO_CHAR(TMP.SEARCHYEAR-1)
		                                      ,NULL
		                                      ,'TOTAL') AS TOTALYEAR2,
		       CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TO_CHAR(TMP.SEARCHYEAR)
		                                      ,NULL
		                                      ,'TOTAL') AS TOTALYEAR3,
		       NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TO_CHAR(TMP.SEARCHYEAR-2)
		                                      ,NULL
		                                      ,'TOTAL'),0)
		       +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TO_CHAR(TMP.SEARCHYEAR-1)
		                                      ,NULL
		                                      ,'TOTAL'),0)
		       +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                      ,TMP.COMPANYID
		                                      ,NULL
		                                      ,TO_CHAR(TMP.SEARCHYEAR)
		                                      ,NULL
		                                      ,'TOTAL'),0) AS TOTALYEAR
		
		      FROM (SELECT $ORGID$ AS ORGID
                      ,$COMPANYID$ AS COMPANYID
		                  ,#SEARCHYEAR# AS SEARCHYEAR
		              FROM DUAL) TMP
		     WHERE NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                              ,TMP.COMPANYID
		                                              ,NULL
		                                              ,TMP.SEARCHYEAR
		                                              ,NULL
		                                              ,'TOTAL'), 0) > 0
		 UNION ALL
		SELECT A.RN + 1 AS RN,
		       A.ORGID,
		       A.COMPANYID,
		       A.LICENSENO,
		       A.CUSTOMERCODE,
		       A.CUSTOMERNAME,
		       A.SEARCHYEAR1,
		       A.SEARCHYEAR2,
		       A.SEARCHYEAR3,
		       A.TITLE,
		       A.TOTALTEXT,
		       A.TOTALYEAR1,
		       A.TOTALYEAR2,
		       A.TOTALYEAR3,
		       A.TOTALYEAR
		
		        FROM (
		       (SELECT RANK() OVER(ORDER BY NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                                       ,TMP.COMPANYID
		                                                                       ,CC.CUSTOMER_CODE
		                                                                       ,TMP.SEARCHYEAR
		                                                                       ,NULL
		                                                                       ,'TOTAL'), 0) DESC) AS RN,
		           CC.ORG_ID AS ORGID,
		           CC.COMPANY_ID AS COMPANYID,
		           CC.LICENSE_NO AS LICENSENO,
		           CC.CUSTOMER_CODE AS CUSTOMERCODE,
		           CC.CUSTOMER_NAME AS CUSTOMERNAME,
		           TO_CHAR(TMP.SEARCHYEAR-2) AS SEARCHYEAR1,
		           TO_CHAR(TMP.SEARCHYEAR-1) AS SEARCHYEAR2,
		           TO_CHAR(TMP.SEARCHYEAR) AS SEARCHYEAR3,
		
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR)
		                                          ,NULL
		                                          ,'TOTAL') AS TOTALYEAR3,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-1)
		                                          ,NULL
		                                          ,'TOTAL') AS TOTALYEAR2,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-2)
		                                          ,NULL
		                                          ,'TOTAL') AS TOTALYEAR1 ,
		
		           NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR)
		                                          ,NULL
		                                          ,'TOTAL'),0)
		           +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-1)
		                                          ,NULL
		                                          ,'TOTAL'),0)
		           +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-2)
		                                          ,NULL
		                                          ,'TOTAL'),0) AS TOTALYEAR,
		           '년도별 매출실적' AS TITLE,
		           'TOTAL' AS TOTALTEXT
		
		      FROM CB_CUSTOMER CC
		          ,(SELECT $ORGID$ AS ORGID
                      ,$COMPANYID$ AS COMPANYID
		                  ,#SEARCHYEAR# AS SEARCHYEAR
		              FROM DUAL) TMP
		     WHERE CC.CUSTOMER_CODE <> '9999999999'
		       AND CC.CUSTOMER_TYPE IN ('A', 'S')
		       AND CC.USE_YN = 'Y'
		       AND CC.ORG_ID = TMP.ORGID
		       AND CC.COMPANY_ID = TMP.COMPANYID
		       AND NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                              ,TMP.COMPANYID
		                                              ,CC.CUSTOMER_CODE
		                                              ,TMP.SEARCHYEAR
		                                              ,NULL
		                                              ,'TOTAL'), 0) > 0
		     )) A
		 WHERE A.RN BETWEEN 1 AND 13
		
		   UNION ALL
		
		SELECT
		       15 AS RN,
		       ORGID,
		       COMPANYID,
		       NULL AS LICENSENO,
		       NULL AS CUSTOMERCODE,
		       '기 타'  AS CUSTOMERNAME,
		       SEARCHYEAR1,
		       SEARCHYEAR2,
		       SEARCHYEAR3,
		       NULL AS TITLE,
		       NULL AS TOTALTEXT,
		       SUM(TOTALYEAR1) AS TOTALYEAR1,
		       SUM(TOTALYEAR2) AS TOTALYEAR2,
		       SUM(TOTALYEAR3) AS TOTALYEAR3,
		       SUM(TOTALYEAR) AS TOTALYEAR
		
		FROM (
		   SELECT
		       A.RN+1 AS RN,
		       A.ORGID,
		       A.COMPANYID,
		       A.LICENSENO,
		       A.CUSTOMERCODE,
		       A.CUSTOMERNAME,
		       A.SEARCHYEAR1,
		       A.SEARCHYEAR2,
		       A.SEARCHYEAR3,
		       A.TITLE,
		       A.TOTALTEXT,
		       A.TOTALYEAR1,
		       A.TOTALYEAR2,
		       A.TOTALYEAR3,
		       A.TOTALYEAR
		
		        FROM (
		       (SELECT RANK() OVER(ORDER BY NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                                                       ,TMP.COMPANYID
		                                                                       ,CC.CUSTOMER_CODE
		                                                                       ,TO_CHAR(TMP.SEARCHYEAR)
		                                                                       ,NULL
		                                                                       ,'TOTAL'), 0) DESC) AS RN,
		           CC.ORG_ID AS ORGID,
		           CC.COMPANY_ID AS COMPANYID,
		           CC.LICENSE_NO AS LICENSENO,
		           CC.CUSTOMER_CODE AS CUSTOMERCODE,
		           CC.CUSTOMER_NAME AS CUSTOMERNAME,
		           TO_CHAR(TMP.SEARCHYEAR-2) AS SEARCHYEAR1,
		           TO_CHAR(TMP.SEARCHYEAR-1) AS SEARCHYEAR2,
		           TO_CHAR(TMP.SEARCHYEAR) AS SEARCHYEAR3,
		
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR)
		                                          ,NULL
		                                          ,'TOTAL') AS TOTALYEAR3,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-1)
		                                          ,NULL
		                                          ,'TOTAL') AS TOTALYEAR2,
		           CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-2)
		                                          ,NULL
		                                          ,'TOTAL') AS TOTALYEAR1 ,
		           NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR)
		                                          ,NULL
		                                          ,'TOTAL'),0)
		           +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-1)
		                                          ,NULL
		                                          ,'TOTAL'),0)
		           +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                          ,TMP.COMPANYID
		                                          ,CC.CUSTOMER_CODE
		                                          ,TO_CHAR(TMP.SEARCHYEAR-2)
		                                          ,NULL
		                                          ,'TOTAL'),0) AS TOTALYEAR,
		           '년도별 매출실적' AS TITLE,
		           'TOTAL' AS TOTALTEXT
		
		      FROM CB_CUSTOMER CC
		          ,(SELECT $ORGID$ AS ORGID
                      ,$COMPANYID$ AS COMPANYID
		                  ,#SEARCHYEAR# AS SEARCHYEAR
		              FROM DUAL) TMP
		     WHERE CC.CUSTOMER_CODE <> '9999999999'
		       AND CC.CUSTOMER_TYPE IN ('A', 'S')
		       AND CC.USE_YN = 'Y'
		       AND CC.ORG_ID = TMP.ORGID
		       AND CC.COMPANY_ID = TMP.COMPANYID
		       AND NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
		                                              ,TMP.COMPANYID
		                                              ,CC.CUSTOMER_CODE
		                                              ,TMP.SEARCHYEAR
		                                              ,NULL
		                                              ,'TOTAL'), 0) > 0
		     )) A
		 WHERE A.RN > 13
		
		   ) GA
		   WHERE 1=1
		   GROUP BY ORGID, COMPANYID, SEARCHYEAR1, SEARCHYEAR2, SEARCHYEAR3
    ]]>
    </select>
    
    
    
    
    <select id="report.CostPo.customer.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
<![CDATA[
SELECT  AA.RN AS RN
       ,AA.ORGID AS ORGID
       ,AA.COMPANYID AS COMPANYID
       ,AA.CUSTOMERCODE AS CUSTOMERCODE
       ,AA.CUSTOMERNAME AS CUSTOMERNAME
       ,AA.CUSTOMERTYPE AS CUSTOMERTYPE
       ,AA.CUSTOMERTYPENAME AS CUSTOMERTYPENAME
       ,AA.MONTH01 AS MONTH01
       ,AA.MONTH02 AS MONTH02
       ,AA.MONTH03 AS MONTH03
       ,AA.MONTH04 AS MONTH04
       ,AA.MONTH05 AS MONTH05
       ,AA.MONTH06 AS MONTH06
       ,AA.MONTH07 AS MONTH07
       ,AA.MONTH08 AS MONTH08
       ,AA.MONTH09 AS MONTH09
       ,AA.MONTH10 AS MONTH10
       ,AA.MONTH11 AS MONTH11
       ,AA.MONTH12 AS MONTH12
       ,AA.TOTALMONTH AS TOTALMONTH
       ,'1. 업체별 요약(금액기준)' AS TITLE
       ,'업체명' AS CUSTOMERTEXT
       ,'합계(원)' AS TOTALTEXT
       ,'1월' AS MO1
       ,'2월' AS MO2
       ,'3월' AS MO3
       ,'4월' AS MO4
       ,'5월' AS MO5
       ,'6월' AS MO6
       ,'7월' AS MO7
       ,'8월' AS MO8
       ,'9월' AS MO9
       ,'10월' AS MO10
       ,'11월' AS MO11
       ,'12월' AS MO12
       ,'비고' AS REMARKSTEXT
       FROM(
SELECT RANK() OVER(ORDER BY SUM(TC.TOTAL) DESC) AS RN,
                       TC.ORG_ID AS ORGID,
                       TC.COMPANY_ID AS COMPANYID,
                       TC.CUSTOMER_CODE AS CUSTOMERCODE,
                       TC.CUSTOMER_NAME AS CUSTOMERNAME,
                       TC.CUSTOMER_TYPE AS CUSTOMERTYPE,
                       TC.CUSOTMER_TYPE_NAME AS CUSTOMERTYPENAME,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '01',
                              SUM(TC.TOTAL),
                              0) AS MONTH01,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '02',
                              SUM(TC.TOTAL),
                              0) AS MONTH02,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '03',
                              SUM(TC.TOTAL),
                              0) AS MONTH03,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '04',
                              SUM(TC.TOTAL),
                              0) AS MONTH04,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '05',
                              SUM(TC.TOTAL),
                              0) AS MONTH05,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '06',
                              SUM(TC.TOTAL),
                              0) AS MONTH06,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '07',
                              SUM(TC.TOTAL),
                              0) AS MONTH07,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '08',
                              SUM(TC.TOTAL),
                              0) AS MONTH08,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '09',
                              SUM(TC.TOTAL),
                              0) AS MONTH09,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '10',
                              SUM(TC.TOTAL),
                              0) AS MONTH10,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '11',
                              SUM(TC.TOTAL),
                              0) AS MONTH11,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '12',
                              SUM(TC.TOTAL),
                              0) AS MONTH12,
                       SUM(TC.TOTAL) AS TOTALMONTH
                  FROM CB_OUT_TRANS_CONFIRM_V TC
                 WHERE 1 = 1

                   AND TC.CONFIRM_YN = 'Y'
                   AND TC.ORG_ID = #ORGID#
                   AND TC.COMPANY_ID = #COMPANYID#
                   AND TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'), 'YYYY') = #SEARCHYEAR#
                 GROUP BY TC.ORG_ID,
                          TC.COMPANY_ID,
                          TC.CUSTOMER_CODE,
                          TC.CUSTOMER_NAME,
                          TC.CUSTOMER_TYPE,
                          TC.CUSOTMER_TYPE_NAME,
                          TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                  'MM')) AA
                 WHERE 1=1
                   AND AA.CUSTOMERTYPE IN ('O','T')
                   AND AA.RN BETWEEN 1 AND 17

                   UNION ALL

                  

SELECT  17 AS RN
       ,AA.ORGID AS ORGID
       ,AA.COMPANYID AS COMPANYID
       ,NULL AS CUSTOMERCODE
       ,'기 타' AS CUSTOMERNAME
       ,NULL AS CUSTOMERTYPE
       ,NULL AS CUSTOMERTYPENAME
       ,SUM(AA.MONTH01) AS MONTH01
       ,SUM(AA.MONTH02) AS MONTH02
       ,SUM(AA.MONTH03) AS MONTH03
       ,SUM(AA.MONTH04) AS MONTH04
       ,SUM(AA.MONTH05) AS MONTH05
       ,SUM(AA.MONTH06) AS MONTH06
       ,SUM(AA.MONTH07) AS MONTH07
       ,SUM(AA.MONTH08) AS MONTH08
       ,SUM(AA.MONTH09) AS MONTH09
       ,SUM(AA.MONTH10) AS MONTH10
       ,SUM(AA.MONTH11) AS MONTH11
       ,SUM(AA.MONTH12) AS MONTH12
       ,SUM(AA.TOTALMONTH) AS TOTALMONTH
       ,'1. 업체별 요약(금액기준)' AS TITLE
       ,'업체명' AS CUSTOMERTEXT
       ,'합계(원)' AS TOTALTEXT
       ,'1월' AS MO1
       ,'2월' AS MO2
       ,'3월' AS MO3
       ,'4월' AS MO4
       ,'5월' AS MO5
       ,'6월' AS MO6
       ,'7월' AS MO7
       ,'8월' AS MO8
       ,'9월' AS MO9
       ,'10월' AS MO10
       ,'11월' AS MO11
       ,'12월' AS MO12
       ,'비고' AS REMARKSTEXT
       FROM(
SELECT RANK() OVER(ORDER BY SUM(TC.TOTAL) DESC) AS RN,
                       TC.ORG_ID AS ORGID,
                       TC.COMPANY_ID AS COMPANYID,
                       NULL AS CUSTOMERCODE,
                       NULL AS CUSTOMERNAME,
                       TC.CUSTOMER_TYPE AS CUSTOMERTYPE,
                       TC.CUSOTMER_TYPE_NAME AS CUSTOMERTYPENAME,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '01',
                              SUM(TC.TOTAL),
                              0) AS MONTH01,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '02',
                              SUM(TC.TOTAL),
                              0) AS MONTH02,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '03',
                              SUM(TC.TOTAL),
                              0) AS MONTH03,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '04',
                              SUM(TC.TOTAL),
                              0) AS MONTH04,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '05',
                              SUM(TC.TOTAL),
                              0) AS MONTH05,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '06',
                              SUM(TC.TOTAL),
                              0) AS MONTH06,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '07',
                              SUM(TC.TOTAL),
                              0) AS MONTH07,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '08',
                              SUM(TC.TOTAL),
                              0) AS MONTH08,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '09',
                              SUM(TC.TOTAL),
                              0) AS MONTH09,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '10',
                              SUM(TC.TOTAL),
                              0) AS MONTH10,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '11',
                              SUM(TC.TOTAL),
                              0) AS MONTH11,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '12',
                              SUM(TC.TOTAL),
                              0) AS MONTH12,
                       SUM(TC.TOTAL) AS TOTALMONTH
                  FROM CB_OUT_TRANS_CONFIRM_V TC
                 WHERE 1 = 1
                   AND TC.CONFIRM_YN = 'Y'
                   AND TC.ORG_ID = #ORGID#
                   AND TC.COMPANY_ID = #COMPANYID#
                   AND TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'), 'YYYY') = #SEARCHYEAR#
                   AND TC.CUSTOMER_TYPE IN ('O','T')
                 GROUP BY TC.ORG_ID,
                          TC.COMPANY_ID,
                          TC.CUSTOMER_TYPE,
                          TC.CUSOTMER_TYPE_NAME,
                          TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                  'MM')) AA
                 WHERE 1=1
                   AND AA.RN > 17
                   GROUP BY AA.ORGID, AA.COMPANYID

                   UNION ALL

                  

SELECT  18 AS RN
       ,AA.ORGID AS ORGID
       ,AA.COMPANYID AS COMPANYID
       ,NULL AS CUSTOMERCODE
       ,'합계(원)' AS CUSTOMERNAME
       ,NULL AS CUSTOMERTYPE
       ,NULL AS CUSTOMERTYPENAME
       ,SUM(AA.MONTH01) AS MONTH01
       ,SUM(AA.MONTH02) AS MONTH02
       ,SUM(AA.MONTH03) AS MONTH03
       ,SUM(AA.MONTH04) AS MONTH04
       ,SUM(AA.MONTH05) AS MONTH05
       ,SUM(AA.MONTH06) AS MONTH06
       ,SUM(AA.MONTH07) AS MONTH07
       ,SUM(AA.MONTH08) AS MONTH08
       ,SUM(AA.MONTH09) AS MONTH09
       ,SUM(AA.MONTH10) AS MONTH10
       ,SUM(AA.MONTH11) AS MONTH11
       ,SUM(AA.MONTH12) AS MONTH12
       ,SUM(AA.TOTALMONTH) AS TOTALMONTH
       ,'1. 업체별 요약(금액기준)' AS TITLE
       ,'업체명' AS CUSTOMERTEXT
       ,'합계(원)' AS TOTALTEXT
       ,'1월' AS MO1
       ,'2월' AS MO2
       ,'3월' AS MO3
       ,'4월' AS MO4
       ,'5월' AS MO5
       ,'6월' AS MO6
       ,'7월' AS MO7
       ,'8월' AS MO8
       ,'9월' AS MO9
       ,'10월' AS MO10
       ,'11월' AS MO11
       ,'12월' AS MO12
       ,'비고' AS REMARKSTEXT
       FROM(
SELECT RANK() OVER(ORDER BY SUM(TC.TOTAL) DESC) AS RN,
                       TC.ORG_ID AS ORGID,
                       TC.COMPANY_ID AS COMPANYID,
                       NULL AS CUSTOMERCODE,
                       NULL AS CUSTOMERNAME,
                       TC.CUSTOMER_TYPE AS CUSTOMERTYPE,
                       TC.CUSOTMER_TYPE_NAME AS CUSTOMERTYPENAME,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '01',
                              SUM(TC.TOTAL),
                              0) AS MONTH01,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '02',
                              SUM(TC.TOTAL),
                              0) AS MONTH02,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '03',
                              SUM(TC.TOTAL),
                              0) AS MONTH03,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '04',
                              SUM(TC.TOTAL),
                              0) AS MONTH04,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '05',
                              SUM(TC.TOTAL),
                              0) AS MONTH05,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '06',
                              SUM(TC.TOTAL),
                              0) AS MONTH06,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '07',
                              SUM(TC.TOTAL),
                              0) AS MONTH07,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '08',
                              SUM(TC.TOTAL),
                              0) AS MONTH08,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '09',
                              SUM(TC.TOTAL),
                              0) AS MONTH09,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '10',
                              SUM(TC.TOTAL),
                              0) AS MONTH10,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '11',
                              SUM(TC.TOTAL),
                              0) AS MONTH11,
                       DECODE(TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                      'MM'),
                              '12',
                              SUM(TC.TOTAL),
                              0) AS MONTH12,
                       SUM(TC.TOTAL) AS TOTALMONTH
                  FROM CB_OUT_TRANS_CONFIRM_V TC
                 WHERE 1 = 1

                   AND TC.CONFIRM_YN = 'Y'
                   AND TC.ORG_ID = #ORGID#
                   AND TC.COMPANY_ID = #COMPANYID#
                   AND TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'), 'YYYY') = #SEARCHYEAR#
                   AND TC.CUSTOMER_TYPE IN('O','T')
                 GROUP BY TC.ORG_ID,
                          TC.COMPANY_ID,
                          TC.CUSTOMER_TYPE,
                          TC.CUSOTMER_TYPE_NAME,
                          TO_CHAR(TO_DATE(TC.CONFIRM_DATE, 'YYYY-MM-DD'),
                                  'MM')) AA
                 WHERE 1=1
                 GROUP BY AA.ORGID, AA.COMPANYID   
                 ]]>
    </select>
    
    <select id="report.CostStdSales.PerforList.item.main" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
         SELECT TMP.ORGID AS ORGID 
 				       ,TMP.COMPANYID AS COMPANYID 
 				       ,TMP.SEARCHYEAR AS SEARCHYEAR 
 				       ,'품목별 매출 실적 (' || TMP.SEARCHYEAR || '년)' AS TITLE 
 							  FROM ( 
 							     SELECT #ORGID# AS ORGID 
 							           ,#COMPANYID# AS COMPANYID 
 				                 ,#SEARCHYEAR# AS SEARCHYEAR 
 				  FROM DUAL) TMP 
     ]]> 
    </select>
    
    <select id="report.CostStdSales.PerforList.item.sub1" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
         SELECT SHIPPING_ITEM_GROUP AS ITEM, 
       SUM(TOTALPRODUCT) AS TOTAL 
   FROM( 
          SELECT RANK()OVER(PARTITION BY CSR.ORG_ID ,CSR.COMPANY_ID,CSR.SHIPPING_ITEM_GROUP  ORDER BY CSR.ORG_ID ,CSR.COMPANY_ID,CSR.SHIPPING_ITEM_GROUP ,CSR.CUSTOMER_NAME) AS RN 
                ,CSR.ORG_ID 
                ,CSR.COMPANY_ID 
                 ,CSR.SHIPPING_ITEM_GROUP 
                 ,CSR.CUSTOMER_NAME 
                 ,SUM(CSR.TRADE_AMOUNT) AS TOTALPRODUCT 
            FROM CB_COST_SALES_REPORT_V CSR 
          WHERE 1=1 
             AND CSR.ORG_ID = #ORGID# 
             AND CSR.COMPANY_ID = #COMPANYID# 
            AND TO_CHAR(CSR.END_DATE,'YYYY') = #SEARCHYEAR# 
        GROUP BY CSR.ORG_ID, COMPANY_ID, CSR.SHIPPING_ITEM_GROUP,CUSTOMER_CODE,CUSTOMER_NAME 

        ) 
   GROUP BY ORG_ID, COMPANY_ID, SHIPPING_ITEM_GROUP 
     ]]> 
    </select>
    
    <select id="report.CostStdSales.PerforList.item.sub2" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
    SELECT
        1 AS RN 
       ,'품목' AS ITEM 
       ,'TOTAL' AS TOTAL 
       ,MAX(DECODE(RN,1,CUSTOMER_NAME)) AS COLUMN1 
       ,MAX(DECODE(RN,2,CUSTOMER_NAME)) AS COLUMN2 
      ,MAX(DECODE(RN,3,CUSTOMER_NAME)) AS COLUMN3 
       ,MAX(DECODE(RN,4,CUSTOMER_NAME)) AS COLUMN4 
       ,MAX(DECODE(RN,5,CUSTOMER_NAME)) AS COLUMN5 
       ,MAX(DECODE(RN,6,CUSTOMER_NAME)) AS COLUMN6 
       ,MAX(DECODE(RN,7,CUSTOMER_NAME)) AS COLUMN7 
       ,MAX(DECODE(RN,8,CUSTOMER_NAME)) AS COLUMN8 
       ,MAX(DECODE(RN,9,CUSTOMER_NAME)) AS COLUMN9 
       ,MAX(DECODE(RN,10,CUSTOMER_NAME)) AS COLUMN10 
       ,MAX(DECODE(RN,11,CUSTOMER_NAME)) AS COLUMN11 
       ,MAX(DECODE(RN,12,CUSTOMER_NAME)) AS COLUMN12 
       ,MAX(DECODE(RN,13,CUSTOMER_NAME)) AS COLUMN13 
       ,MAX(DECODE(RN,14,CUSTOMER_NAME)) AS COLUMN14 
   FROM ( 
         SELECT CSR.CUSTOMER_NAME 
               ,RANK()OVER(ORDER BY CUSTOMER_NAME) AS RN 
          FROM CB_COST_SALES_REPORT_V CSR 
         WHERE 1=1 
             AND CSR.ORG_ID = #ORGID# 
             AND CSR.COMPANY_ID = #COMPANYID# 
             AND TO_CHAR(CSR.END_DATE,'YYYY') = #SEARCHYEAR# 
        GROUP BY CUSTOMER_NAME 
        ) 
  UNION ALL 

  SELECT 
        2 AS RN, 
        AA.ITEM AS ITEM 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,NULL 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS TOTAL 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN1 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN1 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN1 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN2 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN2 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN2 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN3 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN3 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN3 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN4 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN4 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN4 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN5 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN5 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN5 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN6 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN6 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN6 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN7 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN7 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN7 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN8 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN8 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN8 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN9 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN9 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN9 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN10 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN10 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN10 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN11 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN11 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN11 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN12 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN12 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN12 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN13 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN13 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN13 
       ,TO_CHAR(CB_COST_PKG.CB_COST_AMOUNT_ITEM_FIND(AA.ORGID 
                                            ,AA.COMPANY_ID 
                                            ,CASE WHEN AA.COLUMN14 IS NULL THEN 
                                             '-9999' 
                                             ELSE 
                                             AA.COLUMN14 
                                             END 
                                            ,AA.SEARCHYEAR 
                                            ,NULL)) AS COLUMN14 
   FROM ( 
         SELECT NULL AS ITEM 
               ,MAX(ORG_ID) AS ORGID 
               ,MAX(COMPANY_ID) AS COMPANY_ID 
               ,MAX(SEARCHYEAR) AS SEARCHYEAR 
               ,MAX(DECODE(RN,1,CUSTOMER_CODE)) AS COLUMN1 
               ,MAX(DECODE(RN,2,CUSTOMER_CODE)) AS COLUMN2 
               ,MAX(DECODE(RN,3,CUSTOMER_CODE)) AS COLUMN3 
               ,MAX(DECODE(RN,4,CUSTOMER_CODE)) AS COLUMN4 
               ,MAX(DECODE(RN,5,CUSTOMER_CODE)) AS COLUMN5 
               ,MAX(DECODE(RN,6,CUSTOMER_CODE)) AS COLUMN6 
               ,MAX(DECODE(RN,7,CUSTOMER_CODE)) AS COLUMN7 
               ,MAX(DECODE(RN,8,CUSTOMER_CODE)) AS COLUMN8 
               ,MAX(DECODE(RN,9,CUSTOMER_CODE)) AS COLUMN9 
               ,MAX(DECODE(RN,10,CUSTOMER_CODE)) AS COLUMN10 
               ,MAX(DECODE(RN,11,CUSTOMER_CODE)) AS COLUMN11 
               ,MAX(DECODE(RN,12,CUSTOMER_CODE)) AS COLUMN12 
               ,MAX(DECODE(RN,13,CUSTOMER_CODE)) AS COLUMN13 
               ,MAX(DECODE(RN,14,CUSTOMER_CODE)) AS COLUMN14 
           FROM ( 
                 SELECT RANK()OVER(ORDER BY CUSTOMER_CODE) AS RN 
                       ,CSR.CUSTOMER_CODE 
                       ,CSR.ORG_ID AS ORG_ID 
                       ,CSR.COMPANY_ID AS COMPANY_ID 
                       ,#SEARCHYEAR# AS SEARCHYEAR 
                  FROM CB_COST_SALES_REPORT_V CSR 
                 WHERE 1=1 
                   AND CSR.ORG_ID = #ORGID# 
                   AND CSR.COMPANY_ID = #COMPANYID# 
                   AND TO_CHAR(CSR.END_DATE,'YYYY') = #SEARCHYEAR# 
                 GROUP BY ORG_ID, COMPANY_ID, CUSTOMER_CODE 
          ) 
       )AA 

  UNION ALL 
 SELECT 3 AS RN, 
        SHIPPING_ITEM_GROUP AS ITEM, 
        TO_CHAR(SUM(TOTALPRODUCT)) AS TOTAL, 
        MAX(DECODE(RN,1,TO_CHAR(TOTALPRODUCT)))  AS COLUMN1, 
        MAX(DECODE(RN,2,TO_CHAR(TOTALPRODUCT)))  AS COLUMN2, 
        MAX(DECODE(RN,3,TO_CHAR(TOTALPRODUCT)))  AS COLUMN3, 
        MAX(DECODE(RN,4,TO_CHAR(TOTALPRODUCT)))  AS COLUMN4, 
        MAX(DECODE(RN,5,TO_CHAR(TOTALPRODUCT)))  AS COLUMN5, 
        MAX(DECODE(RN,6,TO_CHAR(TOTALPRODUCT)))  AS COLUMN6, 
        MAX(DECODE(RN,7,TO_CHAR(TOTALPRODUCT)))  AS COLUMN7, 
        MAX(DECODE(RN,8,TO_CHAR(TOTALPRODUCT)))  AS COLUMN8, 
        MAX(DECODE(RN,9,TO_CHAR(TOTALPRODUCT)))  AS COLUMN9, 
        MAX(DECODE(RN,10,TO_CHAR(TOTALPRODUCT)))  AS COLUMN10, 
        MAX(DECODE(RN,11,TO_CHAR(TOTALPRODUCT)))  AS COLUMN11, 
        MAX(DECODE(RN,12,TO_CHAR(TOTALPRODUCT)))  AS COLUMN12, 
        MAX(DECODE(RN,13,TO_CHAR(TOTALPRODUCT)))  AS COLUMN13, 
        MAX(DECODE(RN,14,TO_CHAR(TOTALPRODUCT)))  AS COLUMN14 
   FROM( 
          SELECT RANK()OVER(PARTITION BY CSR.ORG_ID ,CSR.COMPANY_ID,CSR.SHIPPING_ITEM_GROUP  ORDER BY CSR.ORG_ID ,CSR.COMPANY_ID,CSR.SHIPPING_ITEM_GROUP ,CSR.CUSTOMER_NAME) AS RN 
                 ,CSR.ORG_ID 
                 ,CSR.COMPANY_ID 
                 ,CSR.SHIPPING_ITEM_GROUP 
                 ,CSR.CUSTOMER_NAME 
                 ,SUM(CSR.TRADE_AMOUNT) AS TOTALPRODUCT 
            FROM CB_COST_SALES_REPORT_V CSR 
           WHERE 1=1 
             AND CSR.ORG_ID = #ORGID# 
             AND CSR.COMPANY_ID = #COMPANYID# 
             AND TO_CHAR(CSR.END_DATE,'YYYY') = #SEARCHYEAR# 
        GROUP BY CSR.ORG_ID, COMPANY_ID, CSR.SHIPPING_ITEM_GROUP,CUSTOMER_CODE,CUSTOMER_NAME 

        ) 
   GROUP BY ORG_ID, COMPANY_ID, SHIPPING_ITEM_GROUP 
     ]]> 
    </select>
    
    <select id="report.CostStdSales.Perfor.Detail.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
      SELECT ROW_NUMBER() OVER(PARTITION BY BB.CUSTOMERNAME, BB.SHIPPINGGROUPNAME ORDER BY BB.CUSTOMERNAME, BB.SHIPPINGGROUPNAME) AS RN
				      ,BB.CUSTOMERNAME AS CUSOTMERNAME
				      ,BB.SHIPPINGGROUPNAME
				      ,DECODE(GROUPING(BB.CARTYPENAME), 1, 'TOTAL', CARTYPENAME) AS CARTYPENAME
				      ,SUM(BB.TOTALAMOUNT) AS TOTALAMOUNT
				      ,SUM(BB.TOTALQTY) AS TOTALQTY
				      ,SUM(BB.MO1) AS MO1
				      ,SUM(BB.MOQ1) AS MOQ1
				      ,SUM(BB.MO2) AS MO2
				      ,SUM(BB.MOQ2) AS MOQ2
				      ,SUM(BB.MO3) AS MO3
				      ,SUM(BB.MOQ3) AS MOQ3
				      ,SUM(BB.MO4) AS MO4
				      ,SUM(BB.MOQ4) AS MOQ4
				      ,SUM(BB.MO5) AS MO5
				      ,SUM(BB.MOQ5) AS MOQ5
				      ,SUM(BB.MO6) AS MO6
				      ,SUM(BB.MOQ6) AS MOQ6
				      ,SUM(BB.MO7) AS MO7
				      ,SUM(BB.MOQ7) AS MOQ7
				      ,SUM(BB.MO8) AS MO8
				      ,SUM(BB.MOQ8) AS MOQ8
				      ,SUM(BB.MO9) AS MO9
				      ,SUM(BB.MOQ9) AS MOQ9
				      ,SUM(BB.MO10) AS MO10
				      ,SUM(BB.MOQ10) AS MOQ10
				      ,SUM(BB.MO11) AS MO11
				      ,SUM(BB.MOQ11) AS MOQ11
				      ,SUM(BB.MO12) AS MO12
				      ,SUM(BB.MOQ12) AS MOQ12
				      ,'업체별 매출내역' AS TITLE
				      ,BB.SEARCHYEAR || '년' || CHR(9) || '총 매출 금액' AS SUBTITLE
				      ,'업체' AS CO1
				      ,'제품' AS CO2
				      ,'기종' AS CO3
				      ,'TOTAL' AS TOTALTEXT
				      ,'1월' AS MONTH01
				      ,'2월' AS MONTH02
				      ,'3월' AS MONTH03
				      ,'4월' AS MONTH04
				      ,'5월' AS MONTH05
				      ,'6월' AS MONTH06
				      ,'7월' AS MONTH07
				      ,'8월' AS MONTH08
				      ,'9월' AS MONTH09
				      ,'10월' AS MONTH10
				      ,'11월' AS MONTH11
				      ,'12월' AS MONTH12
				      ,'금액(공급가)' AS TOTALAMOUNTTEXT
				      ,'금액' AS AMOUNTTEXT
				      ,'수량' AS QTYTEXT
		  FROM (SELECT RANK() OVER(ORDER BY AA.ORG_ID, AA.COMPANY_ID, AA.SHIPPING_GROUP_CODE, AA.CAR_TYPE_NAME) AS RN
				              ,AA.CUSTOMER_NAME AS CUSTOMERNAME
				              ,AA.CAR_TYPE AS CARTYPE
				              ,AA.SHIPPING_GROUP_NAME AS SHIPPINGGROUPNAME
				              ,AA.CAR_TYPE_NAME AS CARTYPENAME
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,NULL
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'TOTAL') AS TOTALAMOUNT
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'01'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO1
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'02'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO2
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'03'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO3
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'04'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO4
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'05'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO5
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'06'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO6
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'07'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO7
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'08'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO8
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'09'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO9
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'10'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO10
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'11'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO11
				              ,CB_COST_PKG.CB_COST_AMOUNT_CAR_TYPE(AA.ORG_ID
				                                                  ,AA.COMPANY_ID
				                                                  ,AA.CUSTOMER_CODE
				                                                  ,AA.SEARCHYEAR
				                                                  ,'12'
				                                                  ,AA.CAR_TYPE
				                                                  ,NULL
				                                                  ,'MONTH') AS MO12
				               
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,NULL
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'TOTAL') AS TOTALQTY
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'01'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ1
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'02'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ2
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'03'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ3
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'04'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ4
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'05'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ5
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'06'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ6
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'07'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ7
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'08'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ8
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'09'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ9
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'10'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ10
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'11'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ11
				              ,CB_COST_PKG.CB_COST_QTY_CAR_TYPE(AA.ORG_ID
				                                               ,AA.COMPANY_ID
				                                               ,AA.CUSTOMER_CODE
				                                               ,AA.SEARCHYEAR
				                                               ,'12'
				                                               ,AA.CAR_TYPE
				                                               ,NULL
				                                               ,'MONTH') AS MOQ12
				              ,AA.SEARCHYEAR AS SEARCHYEAR
		          FROM (SELECT RANK() OVER(ORDER BY TV.ORG_ID, TV.COMPANY_ID, TV.CUSTOMER_NAME, TV.ITEM_NAME, TV.TRADE_DATE, TV.TRADE_NO, TV.TRADE_SEQ) AS RN
					                      ,TV.ORG_ID
					                      ,TV.COMPANY_ID
					                      ,TV.CUSTOMER_CODE
					                      ,TV.CUSTOMER_NAME
					                      ,TV.ITEM_NAME
					                      ,TV.LABEL AS SHIPPING_GROUP_CODE
					                      ,CB_COMMON_STANDARD_PKG.CB_FIND_SMALL_NAME_1(TV.ORG_ID
					                                                                  ,TV.COMPANY_ID
					                                                                  ,'OM'
					                                                                  ,'SHIPPING_ITEM_GROUP'
					                                                                  ,TV.LABEL
					                                                                  ,'LABEL') AS SHIPPING_GROUP_NAME
					                      ,TV.CAR_TYPE
					                      ,TV.CAR_TYPE_NAME
					                      ,TV.TRADE_AMOUNT AS TRADE_AMOUNT
					                      ,TMP.SEARCH_YEAR AS SEARCHYEAR
			                  FROM CB_COST_SALES_D_V TV
					                      ,(SELECT #ORGID# AS ORG_ID
						                              ,#COMPANYID# AS COMPANY_ID
						                              ,#SEARCHYEAR# AS SEARCH_YEAR
					                          FROM DUAL) TMP
			                 WHERE TV.ORG_ID = TMP.ORG_ID
			                   AND TV.COMPANY_ID = TMP.COMPANY_ID) AA
		         GROUP BY AA.ORG_ID
				                 ,AA.COMPANY_ID
				                 ,AA.SEARCHYEAR
				                 ,AA.CUSTOMER_CODE
				                 ,AA.CUSTOMER_NAME
				                 ,AA.SHIPPING_GROUP_CODE
				                 ,AA.SHIPPING_GROUP_NAME
				                 ,AA.CAR_TYPE
				                 ,AA.CAR_TYPE_NAME
		         ORDER BY AA.ORG_ID
				                 ,AA.COMPANY_ID
				                 ,AA.SHIPPING_GROUP_CODE
				                 ,AA.CAR_TYPE_NAME) BB
		 GROUP BY ROLLUP(BB.CUSTOMERNAME, BB.SHIPPINGGROUPNAME, BB.CARTYPENAME), BB.SEARCHYEAR
		HAVING GROUPING(BB.CUSTOMERNAME) = 0
		 ORDER BY CUSTOMERNAME
    ]]>
    </select>
    
    
<!--     매출매입현황 종합요약 -->
  
    <select id="report.eis.synthesis.summary.main.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
    SELECT '매출 및 매입현황 종합요약' AS TITLE FROM DUAL
    ]]>
    </select>
    
    <select id="report.eis.synthesis.summary.sub1.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
	    SELECT   GUBUN1
      ,(CASE WHEN A.GUBUN1 = 1 THEN
               (CASE WHEN A.GUBUN2 = 1 THEN
                       '매출'
                     WHEN A.GUBUN2 = 2 THEN
                       '(만원)'
                     ELSE
                       NULL
                     END)
             WHEN A.GUBUN1 = 2 THEN
               (CASE WHEN A.GUBUN2 = 1 THEN
                       '매입'
                     WHEN A.GUBUN2 = 2 THEN
                       '(만원)'
                     ELSE
                       NULL
                     END)
             WHEN A.GUBUN1 = 3 THEN
               (CASE WHEN A.GUBUN2 = 1 THEN
                       '매입'
                     WHEN A.GUBUN2 = 2 THEN
                       '비율(%)'
                     ELSE
                       NULL
                     END)
             ELSE
               NULL
             END) AS GUBUN1NAME
      ,GUBUN2
      ,GUBUN2NAME
      ,ORG_ID AS ORGID
      ,COMPANY_ID AS COMPANYID
      ,SEARCH_YEAR AS SEARCHYEAR
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR-2
                                     ,NULL
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR-2
                                     ,NULL
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS PRE2AMOUNT
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR-1
                                     ,NULL
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR-1
                                     ,NULL
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS PREAMOUNT
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,NULL
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,NULL
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS TOTAL
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'01'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'01'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON01
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'02'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'02'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON02
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'03'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'03'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON03
     ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'04'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'04'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON04
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'05'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'05'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON05
     ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'06'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'06'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON06
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'07'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'07'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON07
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'08'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'08'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON08
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'09'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'09'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON09
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'10'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'10'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON10
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'11'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'11'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON11
      ,(CASE WHEN A.GUBUN1 = 3 THEN 
      CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'12'
                                     ,GUBUN1
                                     ,GUBUN2)
      ELSE CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,'12'
                                     ,GUBUN1
                                     ,GUBUN2)/10000
      END) AS MON12
  FROM (
        SELECT (CASE WHEN LEVEL BETWEEN 1 AND 2 THEN
                       1
                     WHEN LEVEL BETWEEN 3 AND 4 THEN
                       2
                     WHEN LEVEL BETWEEN 5 AND 6 THEN
                       3
                     ELSE
                       NULL
                     END) AS GUBUN1
              ,(CASE WHEN MOD(LEVEL, 2) = 0 THEN
                       2
                     ELSE
                       1
                     END) AS GUBUN2
              ,(CASE WHEN MOD(LEVEL, 2) = 0 THEN
                       '실적'
                     ELSE
                       '계획'
                     END) AS GUBUN2NAME
              ,$ORGID$ AS ORG_ID
              ,$COMPANYID$ AS COMPANY_ID
              ,$SEARCHYEAR$ AS SEARCH_YEAR
          FROM DUAL
        CONNECT BY LEVEL <= 6
        ) A
        ]]>
    </select>
    
     <select id="report.eis.synthesis.summary.sub2.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
    SELECT '매출매입 실적' AS TITLE 
      ,A.RN || '월' AS STANDARDMONTH
      ,ORG_ID AS ORGID
      ,COMPANY_ID AS COMPANYID
      ,SEARCH_YEAR AS SEARCHYEAR
      ,CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,A.RN
                                     ,1
                                     ,2) AS SALESAMOUNT
      ,CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,A.RN
                                     ,2
                                     ,2) AS PURCHASEAMOUNT
  FROM (
SELECT LPAD(LEVEL, 2, '0') AS RN
      ,$ORGID$ AS ORG_ID
      ,$COMPANYID$ AS COMPANY_ID
      ,#SEARCHYEAR# AS SEARCH_YEAR
  FROM DUAL
CONNECT BY LEVEL <= 12
) A
    ]]>
    </select>
    
     <select id="report.eis.synthesis.summary.sub3.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
    SELECT '매입비율 계획 대비 실적' AS TITLE 
      ,A.RN || '월' AS STANDARDMONTH
      ,ORG_ID AS ORGID
      ,COMPANY_ID AS COMPANYID
      ,SEARCH_YEAR AS SEARCHYEAR
      ,CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,A.RN
                                     ,3
                                     ,1) AS PLANAMOUNT
      ,CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,A.RN
                                     ,3
                                     ,2) AS RESULTAMOUNT
  FROM (
SELECT LPAD(LEVEL, 2, '0') AS RN
      ,$ORGID$ AS ORG_ID
      ,$COMPANYID$ AS COMPANY_ID
      ,$SEARCHYEAR$ AS SEARCH_YEAR
  FROM DUAL
CONNECT BY LEVEL <= 12
) A
    ]]>
    </select>
    
     <select id="report.eis.synthesis.summary.sub4.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
    SELECT '년도별 매출매입' AS TITLE 
      ,A.GUBUN AS GUBUN
      ,ORG_ID AS ORGID
      ,COMPANY_ID AS COMPANYID
      ,SEARCH_YEAR AS SEARCHYEAR
      ,CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR-2
                                     ,NULL
                                     ,A.RN
                                     ,2) AS PRE2AMOUNT
      ,CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR-1
                                     ,NULL
                                     ,A.RN
                                     ,2) AS PREAMOUNT
      ,CB_EIS_PKG.CB_EIS_SUMMARY_FIND(ORG_ID
                                     ,COMPANY_ID
                                     ,SEARCH_YEAR
                                     ,NULL
                                     ,A.RN
                                     ,2) AS AMOUNT
  FROM (
SELECT (CASE WHEN LEVEL = 1 THEN
               '매출'
             WHEN LEVEL = 2 THEN
               '매입'
             ELSE
               NULL
             END) AS GUBUN
      ,LEVEL AS RN
      ,$ORGID$ AS ORG_ID
      ,$COMPANYID$ AS COMPANY_ID
      ,$SEARCHYEAR$ AS SEARCH_YEAR
  FROM DUAL
CONNECT BY LEVEL <= 2
) A
    ]]>
    </select>
    
    
<!--     월별 년도별 매출실적 -->
<select id="report.eis.monthlyyear.sales.result.main.list" parameterClass="java.util.Map"
    resultClass="java.util.HashMap">
    <![CDATA[
    SELECT '월별 년도별 매출실적' AS TITLE
      FROM DUAL
    ]]>
    </select>
    
    <sql id="report.eis.monthlyyear.sales.result.sub1.list-select" >
    <![CDATA[
    SELECT A.RN AS RN
      ,A.ORGID
      ,A.COMPANYID
      ,A.LICENSENO
      ,A.CUSTOMERCODE
      ,A.CUSTOMERNAME
      ,A.TOTALAMOUNT
      ,A.TOTALQTY
      ,A.AMOUNT01
      ,A.QTY01
      ,A.AMOUNT02
      ,A.QTY02
      ,A.AMOUNT03
      ,A.QTY03
      ,A.AMOUNT04
      ,A.QTY04
      ,A.AMOUNT05
      ,A.QTY05
      ,A.AMOUNT06
      ,A.QTY06
      ,A.AMOUNT07
      ,A.QTY07
      ,A.AMOUNT08
      ,A.QTY08
      ,A.AMOUNT09
      ,A.QTY09
      ,A.AMOUNT10
      ,A.QTY10
      ,A.AMOUNT11
      ,A.QTY11
      ,A.AMOUNT12
      ,A.QTY12
  FROM (
        SELECT RANK() OVER(ORDER BY NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                                                       ,TMP.COMPANYID
                                                                       ,CC.CUSTOMER_CODE
                                                                       ,TMP.SEARCHYEAR
                                                                       ,NULL
                                                                       ,'TOTAL'), 0) DESC) AS RN
          ,CC.ORG_ID AS ORGID
          ,CC.COMPANY_ID AS COMPANYID
          ,CC.LICENSE_NO AS LICENSENO
          ,CC.CUSTOMER_CODE AS CUSTOMERCODE
          ,CC.CUSTOMER_NAME AS CUSTOMERNAME
          ,TMP.SEARCHYEAR AS SEARCHYEAR
          
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,NULL
                                          ,'TOTAL') AS TOTALAMOUNT
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'01'
                                          ,'MONTHLY') AS AMOUNT01
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'02'
                                          ,'MONTHLY') AS AMOUNT02
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'03'
                                          ,'MONTHLY') AS AMOUNT03
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'04'
                                          ,'MONTHLY') AS AMOUNT04
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'05'
                                          ,'MONTHLY') AS AMOUNT05
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'06'
                                          ,'MONTHLY') AS AMOUNT06
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'07'
                                          ,'MONTHLY') AS AMOUNT07
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'08'
                                          ,'MONTHLY') AS AMOUNT08
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'09'
                                          ,'MONTHLY') AS AMOUNT09
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'10'
                                          ,'MONTHLY') AS AMOUNT10
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'11'
                                          ,'MONTHLY') AS AMOUNT11
          ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'12'
                                          ,'MONTHLY') AS AMOUNT12
          
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,NULL
                                          ,'TOTAL') AS TOTALQTY
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'01'
                                          ,'MONTHLY') AS QTY01
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'02'
                                          ,'MONTHLY') AS QTY02
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'03'
                                          ,'MONTHLY') AS QTY03
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'04'
                                          ,'MONTHLY') AS QTY04
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'05'
                                          ,'MONTHLY') AS QTY05
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'06'
                                          ,'MONTHLY') AS QTY06
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'07'
                                          ,'MONTHLY') AS QTY07
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'08'
                                          ,'MONTHLY') AS QTY08
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'09'
                                          ,'MONTHLY') AS QTY09
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'10'
                                          ,'MONTHLY') AS QTY10
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'11'
                                          ,'MONTHLY') AS QTY11
          ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,CC.CUSTOMER_CODE
                                          ,TMP.SEARCHYEAR
                                          ,'12'
                                          ,'MONTHLY') AS QTY12
      FROM CB_CUSTOMER CC
          ,(SELECT $ORGID$ AS ORGID
                  ,$COMPANYID$ AS COMPANYID
                  ,$SEARCHYEAR$ AS SEARCHYEAR
              FROM DUAL) TMP
     WHERE CC.CUSTOMER_CODE <> '9999999999'
       AND CC.CUSTOMER_TYPE IN ('A', 'S')
       AND CC.USE_YN = 'Y'
       AND CC.ORG_ID = TMP.ORGID
       AND CC.COMPANY_ID = TMP.COMPANYID
       AND NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TMP.SEARCHYEAR
                                              ,NULL
                                              ,'TOTAL'), 0) > 0
     ) A
    ]]>
    </sql>
    
    <sql id="report.eis.monthlyyear.sales.result.sub1.list-where">
    <isNotEmpty property="COUNT"> 
      <![CDATA[
       WHERE RN<5
       UNION ALL 
       SELECT 5 AS RN
                ,1 AS ORGID
                ,1 AS COMPANYID
                ,NULL AS LICENSENO
                ,NULL AS CUSTOMERCODE
                ,'기타' AS CUSTOMERNAME
                ,SUM(B.TOTALAMOUNT)
                ,SUM(B.TOTALQTY)
                ,SUM(B.AMOUNT01)
                ,SUM(B.QTY01)
                ,SUM(B.AMOUNT02)
                ,SUM(B.QTY02)
                ,SUM(B.AMOUNT03)
                ,SUM(B.QTY03)
                ,SUM(B.AMOUNT04)
                ,SUM(B.QTY04)
                ,SUM(B.AMOUNT05)
                ,SUM(B.QTY05)
                ,SUM(B.AMOUNT06)
                ,SUM(B.QTY06)
                ,SUM(B.AMOUNT07)
                ,SUM(B.QTY07)
                ,SUM(B.AMOUNT08)
                ,SUM(B.QTY08)
                ,SUM(B.AMOUNT09)
                ,SUM(B.QTY09)
                ,SUM(B.AMOUNT10)
                ,SUM(B.QTY10)
                ,SUM(B.AMOUNT11)
                ,SUM(B.QTY11)
                ,SUM(B.AMOUNT12)
                ,SUM(B.QTY12)
          FROM (
          ]]>
          <include refid="report.eis.monthlyyear.sales.result.sub1.list-select" />
          ) B WHERE B.RN>4
      </isNotEmpty>
    </sql>
    
    <select id="report.eis.monthlyyear.sales.result.sub1.list" parameterClass="java.util.Map" resultClass="java.util.HashMap">
      <include refid="report.eis.monthlyyear.sales.result.sub1.list-select" />
      <include refid="report.eis.monthlyyear.sales.result.sub1.list-where" />
   </select>
   
      <select id="report.eis.monthlyyear.sales.result.sub1.count"  parameterClass="java.util.Map" resultClass="java.lang.Integer">
       SELECT COUNT(*) FROM (
      <include refid="report.eis.monthlyyear.sales.result.sub1.list-select" />
         ) TOT
   </select>
    
    
    <sql id="report.eis.monthlyyear.sales.result.sub2.list-select" >
    <![CDATA[
     SELECT A.RN AS RN
      ,A.ORGID
      ,A.COMPANYID
      ,A.LICENSENO
      ,A.CUSTOMERCODE
      ,A.CUSTOMERNAME
      ,A.TOTALYEAR
      ,A.TOTALQTY
      ,A.SEARCHYEAR
      ,A.TOTALYEAR1
      ,A.TOTALQTY1
      ,A.TOTALYEAR2
      ,A.TOTALQTY2
      ,A.TOTALYEAR3
      ,A.TOTALQTY3
      ,A.TOTALYEAR4
      ,A.TOTALQTY4
      ,A.TOTALYEAR5
      ,A.TOTALQTY5
  FROM (
        SELECT RANK() OVER(ORDER BY NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                                                       ,TMP.COMPANYID
                                                                       ,CC.CUSTOMER_CODE
                                                                       ,TMP.SEARCHYEAR
                                                                       ,NULL
                                                                       ,'TOTAL'), 0) DESC) AS RN
              ,CC.ORG_ID AS ORGID
              ,CC.COMPANY_ID AS COMPANYID
              ,CC.LICENSE_NO AS LICENSENO
              ,CC.CUSTOMER_CODE AS CUSTOMERCODE
              ,CC.CUSTOMER_NAME AS CUSTOMERNAME
              ,TMP.SEARCHYEAR
              ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-4)
                                              ,NULL
                                              ,'TOTAL') AS TOTALYEAR1
              ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-3)
                                              ,NULL
                                              ,'TOTAL') AS TOTALYEAR2
              ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-2)
                                              ,NULL
                                              ,'TOTAL') AS TOTALYEAR3
              ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-1)
                                              ,NULL
                                              ,'TOTAL') AS TOTALYEAR4
              ,CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR)
                                              ,NULL
                                              ,'TOTAL') AS TOTALYEAR5
    
              ,NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-4)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-3)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-2)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-1)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR)
                                              ,NULL
                                              ,'TOTAL'), 0) AS TOTALYEAR
              
              ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-4)
                                              ,NULL
                                              ,'TOTAL') AS TOTALQTY1
              ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-3)
                                              ,NULL
                                              ,'TOTAL') AS TOTALQTY2
              ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-2)
                                              ,NULL
                                              ,'TOTAL') AS TOTALQTY3
              ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-1)
                                              ,NULL
                                              ,'TOTAL') AS TOTALQTY4
              ,CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR)
                                              ,NULL
                                              ,'TOTAL') AS TOTALQTY5
    
              ,NVL(CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-4)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-3)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-2)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR-1)
                                              ,NULL
                                              ,'TOTAL'), 0)
              +NVL(CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                              ,TMP.COMPANYID
                                              ,CC.CUSTOMER_CODE
                                              ,TO_CHAR(TMP.SEARCHYEAR)
                                              ,NULL
                                              ,'TOTAL'), 0) AS TOTALQTY
          FROM CB_CUSTOMER CC
              ,(SELECT $ORGID$ AS ORGID
                      ,$COMPANYID$ AS COMPANYID
                      ,$SEARCHYEAR$ AS SEARCHYEAR
                  FROM DUAL) TMP
         WHERE CC.CUSTOMER_CODE <> '9999999999'
           AND CC.CUSTOMER_TYPE IN ('A', 'S')
           AND CC.USE_YN = 'Y'
           AND CC.ORG_ID = TMP.ORGID
           AND CC.COMPANY_ID = TMP.COMPANYID
           AND NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                                  ,TMP.COMPANYID
                                                  ,CC.CUSTOMER_CODE
                                                  ,TMP.SEARCHYEAR
                                                  ,NULL
                                                  ,'TOTAL'), 0) > 0
         ) A
    ]]>
    </sql>
    
    <sql id="report.eis.monthlyyear.sales.result.sub2.list-where">
    <isNotEmpty property="COUNT"> 
      <![CDATA[
       WHERE RN<5
       UNION ALL 
       SELECT 5 AS RN
                ,1 AS ORGID
                ,1 AS COMPANYID
                ,NULL AS LICENSENO
                ,NULL AS CUSTOMERCODE
                ,'기타' AS CUSTOMERNAME
                ,SUM(B.TOTALYEAR)
                ,SUM(B.TOTALQTY)
                ,$SEARCHYEAR$ AS SEARCHYEAR
                ,SUM(B.TOTALYEAR1)
                ,SUM(B.TOTALQTY1)
                ,SUM(B.TOTALYEAR2)
                ,SUM(B.TOTALQTY2)
                ,SUM(B.TOTALYEAR3)
                ,SUM(B.TOTALQTY3)
                ,SUM(B.TOTALYEAR4)
                ,SUM(B.TOTALQTY4)
                ,SUM(B.TOTALYEAR5)
                ,SUM(B.TOTALQTY5)
          FROM (
          ]]>
          <include refid="report.eis.monthlyyear.sales.result.sub2.list-select" />
          ) B WHERE B.RN>4
      </isNotEmpty>
    </sql>
    
     <select id="report.eis.monthlyyear.sales.result.sub2.list" parameterClass="java.util.Map" resultClass="java.util.HashMap">
      <include refid="report.eis.monthlyyear.sales.result.sub2.list-select" />
      <include refid="report.eis.monthlyyear.sales.result.sub2.list-where" />
   </select>
   
      <select id="report.eis.monthlyyear.sales.result.sub2.count"  parameterClass="java.util.Map" resultClass="java.lang.Integer">
       SELECT COUNT(*) FROM (
      <include refid="report.eis.monthlyyear.sales.result.sub2.list-select" />
         ) TOT
   </select>
    
   <sql id="report.eis.monthlyyear.sales.result.sub3.list-select">
   <![CDATA[
   SELECT TMP.ORGID AS ORGID
      ,TMP.COMPANYID AS COMPANYID
      ,'월별 매출 실적(' || TMP.SEARCHYEAR || '년)' AS TITLE
      ,TMP.SEARCHNUM || '월' AS SEARCHYEAR
      ,NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,NULL
                                          ,TMP.SEARCHYEAR
                                          ,TMP.SEARCHNUM
                                          ,'MONTHLY_TOTAL'), 0) AS AMOUNT
      ,NVL(CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                       ,TMP.COMPANYID
                                       ,NULL
                                       ,TMP.SEARCHYEAR
                                       ,TMP.SEARCHNUM
                                       ,'MONTHLY_TOTAL'), 0) AS QTY
  FROM (SELECT $ORGID$ AS ORGID
              ,$COMPANYID$ AS COMPANYID
              ,$SEARCHYEAR$ AS SEARCHYEAR
              ,LPAD(LEVEL, 2, '0') AS SEARCHNUM
          FROM DUAL
        CONNECT BY LEVEL <= 12) TMP
   ]]>
   </sql>
   
   <sql id="report.eis.monthlyyear.sales.result.sub3.list-where">
 WHERE NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,NULL
                                          ,TMP.SEARCHYEAR
                                          ,NULL
                                          ,'TOTAL'), 0) > 0
   </sql>
   
   <select id="report.eis.monthlyyear.sales.result.sub3.list" parameterClass="java.util.Map" resultClass="java.util.HashMap">
      <include refid="report.eis.monthlyyear.sales.result.sub3.list-select" />
      <include refid="report.eis.monthlyyear.sales.result.sub3.list-where" />
   </select>
    
   <sql id="report.eis.monthlyyear.sales.result.sub4.list-select">
   <![CDATA[
   SELECT TMP.ORGID AS ORGID
      ,TMP.COMPANYID AS COMPANYID
      ,'년도별 매출실적' AS TITLE
      ,TO_CHAR(TO_NUMBER(TMP.SEARCHYEAR,'9999') - TMP.SEARCHNUM) || '년' AS SEARCHYEAR
      ,NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,NULL
                                          ,TO_CHAR(TO_NUMBER(TMP.SEARCHYEAR, '9999') - TMP.SEARCHNUM)
                                          ,NULL
                                          ,'TOTAL'), 0) AS AMOUNT
      ,NVL(CB_COST_PKG.CB_COST_QTY_FIND(TMP.ORGID
                                       ,TMP.COMPANYID
                                       ,NULL
                                       ,TO_CHAR(TO_NUMBER(TMP.SEARCHYEAR, '9999') - TMP.SEARCHNUM)
                                       ,NULL
                                       ,'TOTAL'), 0) AS QTY
  FROM (SELECT $ORGID$ AS ORGID
              ,$COMPANYID$ AS COMPANYID
              ,$SEARCHYEAR$ AS SEARCHYEAR
              ,LEVEL - 1 AS SEARCHNUM
          FROM DUAL
        CONNECT BY LEVEL <= 3) TMP
   ]]>
   </sql>
   
   <sql id="report.eis.monthlyyear.sales.result.sub4.list-where">
 WHERE NVL(CB_COST_PKG.CB_COST_AMOUNT_FIND(TMP.ORGID
                                          ,TMP.COMPANYID
                                          ,NULL
                                          ,TMP.SEARCHYEAR
                                          ,NULL
                                          ,'TOTAL'), 0) > 0
 ORDER BY SEARCHYEAR

   </sql>
   
   <select id="report.eis.monthlyyear.sales.result.sub4.list" parameterClass="java.util.Map" resultClass="java.util.HashMap">
      <include refid="report.eis.monthlyyear.sales.result.sub4.list-select" />
      <include refid="report.eis.monthlyyear.sales.result.sub4.list-where" />
   </select>

</sqlMap>